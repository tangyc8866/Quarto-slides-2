<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-Hans" xml:lang="zh-Hans"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; 基于伽马过程的统计建模 – 随机退化过程与统计建模</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/04-IG.html" rel="next">
<link href="../chapters/02-Wiener.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-678afd9922eebfa9ca7f5014aecbca52.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-1b5c5d9af6a8c471bfa7390881d2a26e.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "没有结果",
    "search-matching-documents-text": "匹配的文档",
    "search-copy-link-title": "复制搜索链接",
    "search-hide-matches-text": "隐藏其它匹配结果",
    "search-more-match-text": "更多匹配结果",
    "search-more-matches-text": "更多匹配结果",
    "search-clear-button-title": "清除",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "取消",
    "search-submit-button-title": "提交",
    "search-label": "搜索"
  }
}</script>
<!-- This is what works with Quarto -->
<script>
  MathJax = {
      tex: {
          tags: 'ams',  // should be 'ams', 'none', or 'all'
          inlineMath: [                 // start/end delimiter pairs for in-line math
              ['$', '$'],
              ['\\(', '\\)'],
          ],
          displayMath: [                // start/end delimiter pairs for display math
              ['$$', '$$'],
              ['\\[', '\\]']
          ],
          processEscapes: true,
          macros: {
              bm: ["\\boldsymbol{#1}", 1],  
              diff: ["\\mathrm{d}"],  
          },
      }
  };
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">随机退化过程与统计建模</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="搜索"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="切换导航" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://xu-ancha.github.io/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="切换深色模式"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="切换阅读器模式">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="切换侧边栏导航" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/03-Gamma.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">基于伽马过程的统计建模</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="切换侧边栏导航" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">前言</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">引言</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-Wiener.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">基于维纳过程的统计建模</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03-Gamma.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">基于伽马过程的统计建模</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04-IG.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">基于逆高斯过程的统计建模</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05-ED.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">基于指数分散过程的统计建模</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06-Conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">总结与展望</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">参考文献</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目录</h2>
   
  <ul>
  <li><a href="#sec-Gamma" id="toc-sec-Gamma" class="nav-link active" data-scroll-target="#sec-Gamma"><span class="header-section-number">3.1</span> 伽马过程</a></li>
  <li><a href="#sec-Bayes-Gamma" id="toc-sec-Bayes-Gamma" class="nav-link" data-scroll-target="#sec-Bayes-Gamma"><span class="header-section-number">3.2</span> 伽马过程的贝叶斯分析</a>
  <ul class="collapse">
  <li><a href="#sec-ITR2025-prior" id="toc-sec-ITR2025-prior" class="nav-link" data-scroll-target="#sec-ITR2025-prior"><span class="header-section-number">3.2.1</span> 共轭先验</a></li>
  <li><a href="#sec-ITR2025-ps" id="toc-sec-ITR2025-ps" class="nav-link" data-scroll-target="#sec-ITR2025-ps"><span class="header-section-number">3.2.2</span> 后验抽样</a></li>
  <li><a href="#sec-ITR2025-sim" id="toc-sec-ITR2025-sim" class="nav-link" data-scroll-target="#sec-ITR2025-sim"><span class="header-section-number">3.2.3</span> 模拟实验</a></li>
  <li><a href="#sec-ITR2025-heter" id="toc-sec-ITR2025-heter" class="nav-link" data-scroll-target="#sec-ITR2025-heter"><span class="header-section-number">3.2.4</span> 异质性</a></li>
  <li><a href="#sec-ITR2025-rul" id="toc-sec-ITR2025-rul" class="nav-link" data-scroll-target="#sec-ITR2025-rul"><span class="header-section-number">3.2.5</span> RUL预测</a></li>
  <li><a href="#sec-ITR2025-case" id="toc-sec-ITR2025-case" class="nav-link" data-scroll-target="#sec-ITR2025-case"><span class="header-section-number">3.2.6</span> 实例分析</a></li>
  <li><a href="#sec-Append-3A" id="toc-sec-Append-3A" class="nav-link" data-scroll-target="#sec-Append-3A"><span class="header-section-number">3.2.7</span> 附录</a></li>
  </ul></li>
  <li><a href="#sec-VB-Gamma" id="toc-sec-VB-Gamma" class="nav-link" data-scroll-target="#sec-VB-Gamma"><span class="header-section-number">3.3</span> 重参化伽马过程的变分贝叶斯推断</a>
  <ul class="collapse">
  <li><a href="#sec-ITR2023-s2" id="toc-sec-ITR2023-s2" class="nav-link" data-scroll-target="#sec-ITR2023-s2"><span class="header-section-number">3.3.1</span> 重参化伽马过程</a></li>
  <li><a href="#sec-ITR2023-s3" id="toc-sec-ITR2023-s3" class="nav-link" data-scroll-target="#sec-ITR2023-s3"><span class="header-section-number">3.3.2</span> 变分贝叶斯推断</a></li>
  <li><a href="#sec-ITR2023-s4" id="toc-sec-ITR2023-s4" class="nav-link" data-scroll-target="#sec-ITR2023-s4"><span class="header-section-number">3.3.3</span> 模拟实验</a></li>
  <li><a href="#sec-ITR2023-s5" id="toc-sec-ITR2023-s5" class="nav-link" data-scroll-target="#sec-ITR2023-s5"><span class="header-section-number">3.3.4</span> 实例分析</a></li>
  <li><a href="#sec-Append-3B" id="toc-sec-Append-3B" class="nav-link" data-scroll-target="#sec-Append-3B"><span class="header-section-number">3.3.5</span> 附录</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-03-Gamma" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">基于伽马过程的统计建模</span></span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> 代码</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="sec-Gamma" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="sec-Gamma"><span class="header-section-number">3.1</span> 伽马过程</h2>
<p>如果随机过程 <span class="math inline">\(\{Y(t), t \ge 0\}\)</span> 满足以下性质:</p>
<ol type="i">
<li><p><span class="math inline">\(Y(0) = 0\)</span>;</p></li>
<li><p><span class="math inline">\(\{Y(t), t \ge 0\}\)</span> 具有平稳和独立增量;</p></li>
<li><p>对任意的两个时间<span class="math inline">\(t&gt;s &gt;0\)</span>, 增量 <span class="math inline">\(Y_{ts} = Y(t) - Y(s)\)</span> 服从伽马分布伽马分布 <span class="math inline">\(Ga(\alpha(t-s),\beta)\)</span>, 其PDF为 <span class="math display">\[
f(y  \mid  \alpha, \beta) = \frac{\beta^{\alpha(t-s)} y^{\alpha(t-s)-1}}{\Gamma(\alpha(t-s))} \exp\left\{-\beta y \right\},
\]</span> 其中<span class="math inline">\(\Gamma(\cdot)\)</span> 表示伽马函数, <span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\(\beta\)</span> 是未知参数, 且取值大于0. 称随机过程<span class="math inline">\(\{Y(t), t \ge 0\}\)</span>为齐次伽马过程, 记作 <span class="math inline">\(Y(t) \sim \mathcal{GP}(\alpha t, \beta)\)</span>.</p></li>
</ol>
<p>当产品性能退化服从伽马过程<span class="math inline">\(\mathcal{GP}(\alpha t, \beta)\)</span>且失效阈值为 <span class="math inline">\(\omega\)</span>时, 定义产品寿命为 <span class="math inline">\(T=\inf\{t \mid Y(t)\ge\omega\}\)</span>. 此时, 寿命<span class="math inline">\(T\)</span>的CDF可表示为 <span class="math display">\[\begin{equation}
  \begin{aligned}
    F_{T}(t \mid \alpha,\beta)&amp;=P(T&lt; t)=P(Y_(t)&gt;\omega)=\frac{\Psi(\beta\omega,\alpha t)}{\Gamma(\alpha t)},
  \end{aligned}
\end{equation}\]</span> 其中 <span class="math inline">\(\Psi(k,\alpha)\)</span> 是上不完全伽马函数, 定义为 <span class="math inline">\(\Psi(k,\alpha)=\int_{k}^{\infty}x^{\alpha-1}\exp(-x)\text{d}x\)</span>. 本章采用贝叶斯框架进行统计推断, 故将参数<span class="math inline">\(\alpha\)</span>和<span class="math inline">\(\beta\)</span>视为随机 变量, 并统一使用条件分布的形式. 尽管<span class="math inline">\(F_{T}(t \mid \alpha,\beta)\)</span> 可通过常见软件(如 <em>R</em> 或 <em>MATLAB</em>) 直接计算, 但产品的MTTF与寿命分位数缺乏显式解析解, 导致后验推断效率低下, 尤其在实时在线预测场景中计算负担显著. 为此, 可采用 <span class="citation" data-cites="parpad2005">Park 等 (<a href="references.html#ref-parpad2005" role="doc-biblioref">2005</a>)</span> 推荐的方法, 使用两参数 Birnbaum-Saunders (BS) 分布 <span class="math inline">\(BS(\alpha^\ast,\beta^\ast)\)</span> 来近似 <span class="math inline">\(F_{T}(t \mid \alpha,\beta)\)</span>. BS分布的CDF为 <span class="math display">\[\Phi\left(\frac{1}{\alpha^\ast}\left[\sqrt{\frac{x}{\beta^\ast}}-\sqrt{\frac{\beta^\ast}{x}}\right]\right),\]</span> 其中 <span class="math inline">\(\alpha^\ast=\sqrt{\frac{1}{\beta\omega}}\)</span>, <span class="math inline">\(\beta^\ast=\frac{\beta \omega}{\alpha}\)</span>. 此外, 产品的MTTF可近似为 <span class="math display">\[\begin{equation}
\beta^\ast\left(1+\frac{\left(\alpha^\ast\right)^2}{2}\right)=\frac{1+2\beta\omega}{2\alpha}.
\end{equation}\]</span></p>
<p>本章围绕伽马过程展开建模与统计推断. 第 <a href="#sec-Bayes-Gamma" class="quarto-xref"><span> 3.2</span></a> 节构建伽马过程的贝叶斯分析框架, 并提出多种后验采样算法以适应不同场景下的参数推断需求. 针对产品异质性带来的模型复杂度提升问题, 第 <a href="#sec-VB-Gamma" class="quarto-xref"><span> 3.3</span></a> 节提出一种重参数化伽马过程及其变分贝叶斯 (Variational Bayesian, VB) 算法. 该算法通过赋予参数明确物理意义, 显著提升推断效率, 为复杂退化模型的求解提供高效方案.</p>
</section>
<section id="sec-Bayes-Gamma" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="sec-Bayes-Gamma"><span class="header-section-number">3.2</span> 伽马过程的贝叶斯分析</h2>
<p>在线RUL预测通过退化建模与统计推断实现参数估计. 在伽马过程退化模型领域, <span class="citation" data-cites="paroissin2017">Paroissin (<a href="references.html#ref-paroissin2017" role="doc-biblioref">2017</a>)</span> 和 <span class="citation" data-cites="xushen2018">Xu 等 (<a href="references.html#ref-xushen2018" role="doc-biblioref">2018</a>)</span> 提出了递推式线性估计方法, 但其在 RUL 预测及置信区间估计中的应用仍存在局限性. 传统离线方法 (如基于贝叶斯框架和极大似然法的策略 <span class="citation" data-cites="wang2008 linngtsu2019 wang2021degradation">(<a href="references.html#ref-linngtsu2019" role="doc-biblioref">Ling 等, 2019</a>; <a href="references.html#ref-wang2008" role="doc-biblioref">Wang, 2008</a>; <a href="references.html#ref-wang2021degradation" role="doc-biblioref">Wang 等, 2021</a>)</span>) 需依赖过去全部的退化数据, 当新增观测时需重新计算, 对存储空间与计算资源需求较高. 为此, 本节介绍了一种低计算量、高效的伽马过程在线 RUL 预测框架. 内容涵盖了以下几个方面:</p>
<ol type="1">
<li><p>贝叶斯推断方法: 推导伽马过程中模型参数的共轭先验, 并以此为基础提出贝叶斯推断方法. 相较于无信息先验与混合先验形式 <span class="citation" data-cites="bouetal2015 linngtsu2019">(<a href="references.html#ref-bouetal2015" role="doc-biblioref">Bousquet 等, 2015</a>; <a href="references.html#ref-linngtsu2019" role="doc-biblioref">Ling 等, 2019</a>)</span>, 该方法通过超参数动态更新简化后验计算, 并针对异质性退化场景提供超参数设定准则.</p></li>
<li><p><strong>算法开发</strong>: 开发三种后验分布随机样本生成算法, 克服共轭先验结构复杂性与后验采样效率问题. 通过数值模拟实验验证各算法的计算性能与精度优势.</p></li>
<li><p><strong>在线</strong>RUL预测算法: 基于共轭先验的解析递推特性, 构建在线 RUL 预测算法. 其流程 ( 详见第 <a href="#sec-ITR2025-rul" class="quarto-xref"><span> 3.2.5</span></a> 节) 仅需两步:</p></li>
</ol>
<ul>
<li><strong>后验递推更新</strong>: 利用当前观测值与历史推断结果更新后验分布;</li>
<li><strong>后验样本生成</strong>: 调用预设算法输出参数后验样本. 相比传统方法, 该机制避免全量数据存储与重复计算, 显著提升在线推断效率</li>
</ul>
<p>本节结构安排如下: 第 <a href="#sec-ITR2025-prior" class="quarto-xref"><span> 3.2.1</span></a> 节介绍伽马过程的共轭先验及其性质; 第 <a href="#sec-ITR2025-ps" class="quarto-xref"><span> 3.2.2</span></a> 节介绍三种基于共轭先验的后验样本生成算法; 第 <a href="#sec-ITR2025-sim" class="quarto-xref"><span> 3.2.3</span></a> 节通过模拟评估算法的估计精度和计算效率; 第 <a href="#sec-ITR2025-heter" class="quarto-xref"><span> 3.2.4</span></a> 节讨论共轭先验在具有异质效应伽马过程中的扩展; 第 <a href="#sec-ITR2025-rul" class="quarto-xref"><span> 3.2.5</span></a> 节提出一种在线 RUL 预测算法; 第 <a href="#sec-ITR2025-case" class="quarto-xref"><span> 3.2.6</span></a> 节展示新方法在实际案例中的应用.</p>
<section id="sec-ITR2025-prior" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="sec-ITR2025-prior"><span class="header-section-number">3.2.1</span> 共轭先验</h3>
<p>假设产品性能的退化路径服从伽马过程 <span class="math inline">\(\mathcal{GP}(\alpha t,\beta)\)</span>. 从总体中随机选择 <span class="math inline">\(n\)</span> 个产品进行测试, 测量时间 为 <span class="math inline">\(T_1&lt;T_2&lt;\cdots&lt;T_m\)</span>. 记第 <span class="math inline">\(i\)</span> 个产品在时间点 <span class="math inline">\(T_j\)</span> 的退化值为 <span class="math inline">\(Y_i(T_j)\)</span>, <span class="math inline">\(i=1,\dots,n,\)</span> <span class="math inline">\(j=1,\dots,m\)</span>. 设 <span class="math inline">\(Y_{ij}=Y_i(T_j)-Y_i(T_{j-1})\)</span> 且 <span class="math inline">\(t_j=T_j-T_{j-1}\)</span>, 其中 <span class="math inline">\(Y_i(T_0)=0\)</span> 且 <span class="math inline">\(T_0=0\)</span>, <span class="math inline">\(i=1,\dots,n,\)</span> <span class="math inline">\(j=1,\dots,m\)</span>. 根据伽马过程的性质 (iii), 有 <span class="math inline">\(Y_{ij}\sim \textrm{Ga}(\alpha t_j,\beta)\)</span>. 令 <span class="math inline">\(y_{ij}\)</span> 表示 <span class="math inline">\(Y_{ij}\)</span> 的观测值, 并将观测数据表示为 <span class="math inline">\(\bm{y}=\{y_{ij}, i=1,\dots,n, j=1,\dots,m\}\)</span>. 此时, 基于数据 <span class="math inline">\(\bm{y}\)</span>, 似然函数为 <span class="math display">\[\begin{align}\label{like0}
        L( \bm{y} \mid \alpha,\beta) &amp;=\prod_{i=1}^{n}\prod_{j=1}^{m}\dfrac{\beta^{\alpha t_j}}{\Gamma(\alpha t_j)}
        y_{ij}^{\alpha t_j-1}\exp\{-\beta y_{ij}\}\nonumber\\
        &amp;\propto\dfrac{\beta^{nT_m\alpha}\left[\prod_{i=1}^{n}\prod_{j=1}^{m}y_{ij}^{t_{j}}\right]^\alpha}
        {\left[\prod_{j=1}^{m}\Gamma(\alpha t_j)\right]^n}\exp\left\{-\beta \sum_{i=1}^{n}\sum_{j=1}^{m}y_{ij}\right\}\nonumber\\
        &amp;\propto \dfrac{\beta^{nm\overline{T}_m\alpha}\exp\{-mn\bar{y}_a\beta\}}{\left[\prod_{j=1}^{m}\left(\Gamma(\alpha t_j)\right)^{1/m}\right]^{mn}}
        \left[\prod_{i=1}^{n}\prod_{j=1}^{m}y_{ij}^{\frac{t_{j}}{nm\overline{T}_m}}\right]^{nm\overline{T}_m\alpha},
\end{align}\]</span> 其中<span class="math inline">\(\overline{T}_m=\frac{T_m}{m}\)</span>, <span class="math inline">\(\bar{y}_a=\frac{1}{mn}\sum_{i=1}^{n}\sum_{j=1}^{m}y_{ij}\)</span>.</p>
<div id="thm-ITR2025-th2" class="theorem">
<p><span class="theorem-title"><strong>定理 3.1</strong></span> 基于似然函数 <span class="math inline">\(\eqref{like0}\)</span>, <span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\(\beta\)</span> 的共轭先验为 <span class="math display">\[\begin{equation}\label{con0}
    \pi(\alpha,\beta)=  C \dfrac{(\beta\omega)^{\delta \overline{T}_m\alpha}}{\left[\prod_{j=1}^{m}\left(\Gamma(\alpha t_j)\right)^{1/m}\right]^{\delta}}
        \exp\{-\delta\lambda\beta\},
\end{equation}\]</span> 其中 <span class="math inline">\(C\)</span> 是正则化常数, <span class="math inline">\(\delta\)</span>、<span class="math inline">\(\omega\)</span> 和 <span class="math inline">\(\lambda\)</span> 是非负超参数, 分别为先验分布的扩散、形状以及尺度参数.</p>
</div>
<p>定理 <a href="#thm-ITR2025-th2" class="quarto-xref"><span>3.1</span></a> 的证明见本节附录 <a href="#sec-Append-3A" class="quarto-xref"><span> 3.2.7</span></a>. 共轭先验 <span class="math inline">\(\pi(\alpha,\beta)\)</span> 与测量时间相关. 尽管其形式较为复杂, 但可以通过将<span class="math inline">\(\pi(\alpha, \beta)\)</span> 分解如下形式, 使其更为简洁和易于处理. <span class="math display">\[\begin{align}\label{deco0}
        \pi(\alpha,\beta)&amp;%=\pi(\beta \mid \alpha)\pi(\alpha)
        \propto
        \dfrac{(\delta\lambda)^{\delta \overline{T}_m\alpha+1}}{\Gamma\left(1+\delta \overline{T}_m\alpha\right)}
        \beta^{\delta \overline{T}_m\alpha}\exp\{-\delta\lambda\beta\}\nonumber\\
        &amp;\ \ \ \times
        \dfrac{\left(\dfrac{\omega}{\delta\lambda}\right)^{\delta \overline{T}_m\alpha}\Gamma\left(1+\delta \overline{T}_m\alpha\right)}{\left[\prod_{j=1}^{m}\left(\Gamma(\alpha t_j)\right)^{1/m}\right]^{\delta}}.
\end{align}\]</span> 可以发现, 在给定 <span class="math inline">\(\alpha\)</span> 时, <span class="math inline">\(\beta\)</span>的条件先验 <span class="math inline">\(\pi(\beta \mid \alpha)\)</span> 服从伽马分布 <span class="math inline">\(\textrm{Ga}(\delta \overline{T}_m\alpha+1,\delta\lambda)\)</span>. 因此, <span class="math inline">\(\pi(\beta \mid \alpha)\)</span> 的众数、方差和变异系数分别为 <span class="math inline">\(\overline{T}_m\alpha/\lambda\)</span>、 <span class="math inline">\((\delta \overline{T}_m\alpha+1)/(\delta\lambda)^2\)</span> 和 <span class="math inline">\((\delta \overline{T}_m \alpha+1)^{-1/2}\)</span>, 其中超参数 <span class="math inline">\(\lambda\)</span> 是标准的尺度参数, 而超参数 <span class="math inline">\(\delta\)</span> 则在给定 <span class="math inline">\(\alpha\)</span> 时决定了方差和变异系数. 当 <span class="math inline">\(\delta\)</span> 较大时, <span class="math inline">\(\pi(\beta \mid \alpha)\)</span> 的分布曲将集中于众数附近. 因此, 将 <span class="math inline">\(\delta\)</span> <span class="math inline">\(\delta\)</span> 定义为扩散参数. <span class="math inline">\(\alpha\)</span> 的边际先验形式正比于:<br>
<span class="math display">\[\begin{equation*}
    h(\alpha)=  \dfrac{\left(\dfrac{\omega}{\delta\lambda}\right)^{\delta \overline{T}_m\alpha}\Gamma\left(1+\delta \overline{T}_m\alpha\right)}{\left[\prod_{j=1}^{m}\left(\Gamma(\alpha t_j)\right)^{1/m}\right]^{\delta}}.
\end{equation*}\]</span> 根据 Stirling 公式, 可知: <span class="math display">\[
\lim\limits_{u\rightarrow +\infty}\frac{\sqrt{2\pi}u^{u+1/2}\exp\{-u\}}{\Gamma(u+1)}=1.
\]</span> 当 <span class="math inline">\(\alpha\rightarrow+\infty\)</span> 时, 用Stirling 公式对伽马函数做近似处理, 得到以下结果:<br>
<span class="math display">\[\begin{align}\label{appro0}
    h(\alpha)&amp;\equiv\dfrac{\left(\dfrac{\omega}{\delta\lambda}\right)^{\delta \overline{T}_m\alpha} \sqrt{2\pi}(\delta\overline{T}_m\alpha)^{\delta\overline{T}_m\alpha+1/2}\exp\{-\delta\overline{T}_m\alpha\}}{\left[\prod_{j=1}^{m}\left(\sqrt{2\pi}(\alpha t_j)^{\alpha t_j-1/2}\exp\{-\alpha t_j\}\right)^{1/m}\right]^{\delta}}\nonumber\\
    &amp;= O\left(\alpha^{\frac{\delta+1}{2}}\exp\left\{-\alpha\delta \overline{T}_m \log\left(\frac{\lambda}{\omega}\frac{\prod_{j=1}^{m}t_j^{t_j/T_m}}{\overline{T}_m}\right)\right\}\right),
\end{align}\]</span> 其中<span class="math inline">\(h(\alpha)=O(g(\alpha))\)</span> 表示 <span class="math inline">\(h(\alpha)\)</span> 和 <span class="math inline">\(g(\alpha)\)</span> 同阶. 可以证明 <span class="math inline">\(\log\left(\frac{\prod{j=1}^{m}t_j^{t_j/T_m}}{\overline{T}_m}\right)\ge 0\)</span> (详见本节附录 <a href="#sec-Append-3A" class="quarto-xref"><span> 3.2.7</span></a>). 为了保证 <span class="math inline">\(\pi(\alpha)\)</span> 是正常的PDF, 一个充分条件是 <span class="math inline">\(\omega&lt;\lambda\)</span>. 同时根据 <span class="math inline">\(\eqref{appro0}\)</span> 可知 <span class="math inline">\(\pi(\alpha)\)</span> 的右尾特性类似于伽马分布 <span class="math display">\[
\textrm{Ga}\left(\frac{\delta+3}{2},\delta \overline{T}m \left[\log\left(\frac{\lambda}{\omega}\right)+\log\left(\frac{\prod{j=1}^{m}t_j^{t_j/T_m}}{\overline{T}_m}\right)\right]\right).\]</span> 在 <span class="math inline">\(\pi(\alpha)\)</span> 中, <span class="math inline">\(\omega\)</span> 起到尺度参数的作用, 进一步影响 <span class="math inline">\(\pi(\beta \mid \alpha)\)</span> 的形状. 因此, <span class="math inline">\(\omega\)</span> 被称为形状参数. 由于 <span class="math inline">\(\pi(\beta \mid \alpha)\)</span> 的伽马条件先验和 <span class="math inline">\(\pi(\alpha)\)</span> 的右尾特性, 这种共轭先验 <span class="math inline">\(\pi(\alpha,\beta)\)</span> 被称为近似伽马-伽马 (Approximated-gamma-gamma, AGG) 分布, 记为 <span class="math inline">\(\textrm{AGG}(\delta,\omega,\lambda)\)</span>.</p>
<p>图 <a href="#fig-fig:config0" class="quarto-xref"><span>3.1</span></a> 展示了当 <span class="math inline">\(t_j=1\)</span> 且 <span class="math inline">\(j=1,\dots,m\)</span> 时, 不同 <span class="math inline">\((\delta,\omega,\lambda)\)</span> 值下 <span class="math inline">\(\pi(\alpha,\beta)\)</span> 的函数图和等高线图. 以 <span class="math inline">\(\delta=2\)</span>, <span class="math inline">\(\omega=0.5\)</span>, <span class="math inline">\(\lambda=1.5\)</span> 为基准, 从图中可以看出, 当 <span class="math inline">\(\delta\)</span> 的值增加到 5 且其他两个超参数保持不变时, 众数的位置几乎相同, 但等高线更集中于众数附近. 增大 <span class="math inline">\(\lambda\)</span> 的值同样有类似现象, 但众数的位置有所变化. <span class="math inline">\(\omega\)</span> 则会改变 <span class="math inline">\(\pi(\alpha,\beta)\)</span> 的形状, 并使其众数的位置发生偏移. 综上所述, 该图展示了 不同参数对 AGG 分布的形状和众数位置有显著影响, 为选择合理的超参数提供了依据.</p>
<p><strong>注1</strong>: 当采用等间隔测量(即<span class="math inline">\(t_j=l\)</span>)时, <span class="math inline">\(\pi(\alpha,\beta)\)</span> 的形式简化为 <span class="math display">\[\begin{equation}\label{con1} \pi(\alpha,\beta)=C \dfrac{(\beta\omega)^{\delta l\alpha}}{\left[\Gamma(l\alpha)\right]^{\delta}} \exp{(-\delta\lambda\beta)}.
\end{equation}\]</span> 当 <span class="math inline">\(l=1\)</span> 时, <span class="math inline">\(\pi(\alpha,\beta)\)</span> 简化为伽马分布 <span class="math inline">\(Ga(\alpha,\beta)\)</span> 的共轭先验<span class="citation" data-cites="dams1975">(<a href="references.html#ref-dams1975" role="doc-biblioref">Damsleth, 1975</a>)</span>.</p>
<p><strong>注2</strong>: 超参数的取值可以基于先验信息量的强弱来选择. 如图 <a href="#fig-fig:config0" class="quarto-xref"><span>3.1</span></a> 所示, 不同的超参数组合会显著影响 <span class="math inline">\((\alpha,\beta)\)</span>的分布特性: 较大的 <span class="math inline">\(\delta\)</span>、较小的 <span class="math inline">\(\omega\)</span> 或较大的 <span class="math inline">\(\lambda\)</span> 会导致 <span class="math inline">\((\alpha, \beta)\)</span> 的方差较小, 表示强的先验信息. 在先验知识较少的情况下, 可以选择较小的 <span class="math inline">\(\delta\)</span>、较大的 <span class="math inline">\(\omega\)</span> 或较小的 <span class="math inline">\(\lambda\)</span>. 在实际应用中, 可以通过调整 <span class="math inline">\(\delta\)</span> 控制先验信息的强度. 例如, 根据式 <span class="math inline">\(\eqref{post0}\)</span>, <span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\(\beta\)</span> 的后验分布为 <span class="math inline">\(\textrm{AGG}(\delta_p,\omega_p,\lambda_p)\)</span>. 特别地, 对于 <span class="math inline">\(\omega\)</span> 和 <span class="math inline">\(\lambda\)</span>, 可以使用以下基于观测数据的选择方案:<br>
<span class="math display">\[\begin{equation}\label{hyper}
    \omega=\prod_{i=1}^{n}\prod_{j=1}^{m}y_{ij}^{\frac{t_{j}}{nm\overline{T}_m}},
    ~\lambda=\bar{y}_a.
\end{equation}\]</span> 这种超参数选择方法属于数据驱动先验的范畴, 其合理性已在贝叶斯统计中得到广泛验证. 例如: 回归系数的先验 <span class="citation" data-cites="zellner1986">(<a href="references.html#ref-zellner1986" role="doc-biblioref">Zellner, 1986</a>)</span>, 阈值参数的有效先验 <span class="citation" data-cites="halwan2005">(<a href="references.html#ref-halwan2005" role="doc-biblioref">Hall 等, 2005</a>)</span>, 线性退化路径模型的参考先验 <span class="citation" data-cites="xutang2012">(<a href="references.html#ref-xutang2012" role="doc-biblioref">Xu 等, 2012</a>)</span>等. 式 <span class="math inline">\(\eqref{hyper}\)</span> 所建议的超参数设置具有以下优点: 1. 共轭性保证: 当观测增量中至少有两个值不相等时, 自动满足共轭先验的条件 <span class="math inline">\(\omega &lt; \lambda\)</span>. 2. 众数合理性: <span class="math inline">\(\omega\)</span> 和 <span class="math inline">\(\lambda\)</span> 决定了先验分布 <span class="math inline">\(\pi(\alpha, \beta)\)</span> 的众数位置, 通过数据驱动方式可确保众数值的合理性. 3. 信息量可解释性: 超参数 <span class="math inline">\(\delta\)</span> 类似于测量次数, 其大小可解释为等效的先验信息量:<br>
<span class="math inline">\(\delta = 1\)</span>: 等效于单个产品的单次测量信息; <span class="math inline">\(\delta = 0\)</span>: 非信息性先验, 表示完全不依赖先验信息; <span class="math inline">\(\delta = mn\)</span>: 与所有观测数据的信息量等效, 表示非常强的先验信息. 基于上述优点, 本章在模拟研究与数据分析中采用自动化策略 <span class="math inline">\(\eqref{hyper}\)</span> 指定超参数值, 从而简化共轭先验的设定过程.</p>
<!--这些先验\index{先验}方法在实际应用中已被广泛验证, 具有很高的实用性. 对于式 \eqref{hyper} 所建议的超参数设置, 其优点包括以下几点:   (1) 当观测增量中至少有两个值不相等时, 自动满足共轭先验的条件 $\omega<\lambda$. (2) $\omega$ 和 $\lambda$ 决定了先验分布 $\pi(\alpha,\beta)$ 的众数位置, 通过数据驱动的方式可以建议出合理的众数值.  (3) 在这种设置下, 超参数 $\delta$ 类似于测量次数. $\delta$ 的大小可以看作与测量次数等效的先验信息量.  例如, $\delta=1$:  等效于单个产品的单次测量信息; $\delta=0$:  非信息性先验, 表示完全不依赖先验信息; $\delta=mn$:  与所有观测数据的信息量等效, 表示非常强的先验信息.  基于这些优点, 本章将在模拟研究和数据分析中采用自动化策略 \eqref{hyper} 来指定超参数值, 这可以简化共轭先验的设定. -->
<p><strong>注3</strong>: 在实际工程应用中, 可能已经掌握了一些关于参数 <span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\(\beta\)</span> 的先验信息 (如众数、均值、分位数和方差等). 然而, 由于联合先验分布 <span class="math inline">\(\pi(\alpha,\beta)\)</span> 的形式复杂, 缺乏解析表达式, 直接确定其超参数 <span class="math inline">\((\delta,\lambda,\omega)\)</span> 可能较为困难. 以下是一种将这些先验信息合理融入到超参数设定中的方法, 分为以下三个步骤:<br>
(1) 设定 <span class="math inline">\(\delta\)</span> 的值: 如注释 2 所述, 可以通过等效测量信息量, 主观地设定 <span class="math inline">\(\delta\)</span>; (2) 确定 <span class="math inline">\(\lambda\)</span> 的值: 利用 <span class="math inline">\(\alpha\)</span> 的信息, 结合 <span class="math inline">\(\beta\)</span> 的信息以及条件先验分布 <span class="math inline">\(\pi(\beta \mid \alpha)\)</span> 来确定 <span class="math inline">\(\lambda\)</span>; (3) 确定 <span class="math inline">\(\omega\)</span> 的值: 根据 <span class="math inline">\(\alpha\)</span> 的近似分布 <span class="math display">\[
Ga\left(\frac{\delta+3}{2},\delta \overline{T}_{m} \left[\log\left(\frac{\lambda}{\omega}\right)+\log\left(\frac{\prod{j=1}^{m}t_j^{t_j/T_m}}{\overline{T}_m}\right)\right]\right),\]</span> 结合 <span class="math inline">\(\alpha\)</span> 的信息设定 <span class="math inline">\(\omega\)</span>. 例如, 对于 <span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\(\beta\)</span> 的众数 <span class="math inline">\(\alpha_M\)</span> 和 <span class="math inline">\(\beta_M\)</span>, 若工程师对其置信度较低, 则可以选择一个相对较小的 <span class="math inline">\(\delta\)</span> 值. 给定 <span class="math inline">\(\alpha=\alpha_M\)</span> 时, 可知 <span class="math inline">\(\pi(\beta \mid \alpha)\)</span> 的众数为 <span class="math inline">\(\overline{T}_m\alpha_M/\lambda\)</span>. 之后可通过求解 <span class="math inline">\(\beta_M=\overline{T}_m\alpha_M/\lambda\)</span> 得到 <span class="math inline">\(\lambda=\overline{T}_m\alpha_M/\beta_M\)</span>. 由于 <span class="math inline">\(\alpha\)</span> 的边际先验的近似具有众数为如下形式:<br>
<span class="math display">\[\frac{\delta+1}{2\delta \overline{T}_m
\left[\log\left(\frac{\lambda}{\omega}\right)+\log\left(\frac{\prod_{j=1}^{m}t_j^{t_j/T_m}}{\overline{T}_m}\right)\right]}.
\]</span> 给定众数 <span class="math inline">\(\alpha_M\)</span>, 可以得到 <span class="math display">\[\omega=\frac{\prod_{j=1}^{m}t_j^{t_j/T_m}}{\overline{T}_m}\exp\left\{\log\lambda-\frac{\delta+1}{2\delta \overline{T}_m\alpha_M}\right\}.\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig:config0" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig:config0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="figures/Gamma/ITR2025/config.pdf" class="img-fluid quarto-figure quarto-figure-center" style="width:95.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig:config0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.1: 共轭先验的PDF特性概览. 左图为 PDF 的完整形态, 右图为其对应的等高线表示.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-ITR2025-ps" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="sec-ITR2025-ps"><span class="header-section-number">3.2.2</span> 后验抽样</h3>
<p>由于后验分布 <span class="math inline">\(\pi(\alpha,\beta \mid \bm{y})\)</span> 无法得到解析形式, 直接计算 <span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\(\beta\)</span> 的贝叶斯估计变得不可行. 蒙特卡罗方法为处理这种难以解析的后验分布提供了一种可行的替代推断手段. 该方法的核心思想是从参数的联合后验分布中抽取随机样本, 并利用这些样本对参数或其函数进行点估计和区间估计. 本节将介绍三种用于产生AGG分布随机数的算法.</p>
<section id="gibbs-采样" class="level4" data-number="3.2.2.1">
<h4 data-number="3.2.2.1" class="anchored" data-anchor-id="gibbs-采样"><span class="header-section-number">3.2.2.1</span> Gibbs 采样</h4>
<p>Gibbs采样是一种特殊的马尔可夫链蒙特卡罗 (Monte Carlo Markov chain, MCMC) 方法, 其通过从完全条件后验密度 <span class="math inline">\(\pi(\beta \mid \alpha,\bm{y})\)</span> 和 <span class="math inline">\(\pi(\alpha \mid \beta,\bm{y})\)</span>迭代抽样来实现. 根据式 <span class="math inline">\(\eqref{deco0}\)</span>, 完全条件后验密度 <span class="math inline">\(\pi(\beta \mid \alpha,\bm{y})\)</span> 是一个伽马分布 <span class="math inline">\(Ga(\delta_p\bar{T}_m\alpha,\delta_p\lambda_p)\)</span> ; 而 <span class="math inline">\(\pi(\alpha \mid \beta,\bm{y})\)</span> 的完全条件后验密度与下式成比例 <span class="math display">\[\dfrac{(\beta\omega_p)^{\delta_p \overline{T}_m\alpha}}{\left[\prod_{j=1}^{m}\left(\Gamma(\alpha t_j)\right)^{1/m}\right]^{\delta_p}}.
\]</span> 可以证明 <span class="math inline">\(\pi(\alpha \mid \beta,\bm{y})\)</span> 具有对数凹的性质. 因此, 可以利用自适应拒绝采样 (Adaptive synthetic sampling, ARS) 算法生成 <span class="math inline">\(\pi(\alpha \mid \beta,\bm{y})\)</span> 的随机样本<span class="citation" data-cites="gilwil1992">(<a href="references.html#ref-gilwil1992" role="doc-biblioref">Gilks 等, 1992</a>)</span>. 在获得 <span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\(\beta\)</span> 的后验样本后, 可构造任何参数的函数 <span class="math inline">\(\eta=p(\alpha,\beta)\)</span> (例如: 产品的可靠度、MTTF) 的贝叶斯估计. Gibbs 采样的后验推断过程详见算法 <span class="math inline">\(\ref{ITR2025-algo1}\)</span>.</p>
</section>
<section id="离散网格采样" class="level4" data-number="3.2.2.2">
<h4 data-number="3.2.2.2" class="anchored" data-anchor-id="离散网格采样"><span class="header-section-number">3.2.2.2</span> 离散网格采样</h4>
<p>后验分布 <span class="math inline">\(\pi(\alpha,\beta \mid \bm{y})\)</span> 可表示为条件分布 <span class="math inline">\(\pi(\beta \mid \alpha,\bm{y})\)</span> 与边缘分布 <span class="math inline">\(\pi(\alpha \mid \bm{y})\)</span> 的乘积, 即 <span class="math inline">\(\pi(\alpha, \beta \mid \bm{y}) = \pi(\beta \mid \alpha, \bm{y}) \pi(\alpha \mid \bm{y})\)</span>, 其中 <span class="math inline">\(\pi(\beta \mid \alpha,\bm{y})\)</span> 为 <span class="math inline">\(Ga(\delta_p\bar{T}_m\alpha, \delta_p\lambda_p)\)</span>, <span class="math inline">\(\pi(\alpha \mid \bm{y})\)</span> 与以下函数成比例: <span class="math display">\[\begin{equation}\label{pmargi}
    h_p(\alpha)=\dfrac{\left(\dfrac{\omega_p}{\delta_p\lambda_p}\right)^{\delta_p \overline{T}_m\alpha}\Gamma\left(1+\delta_p \overline{T}_m\alpha\right)}{\left[\prod_{j=1}^{m}\left(\Gamma(\alpha t_j)\right)^{1/m}\right]^{\delta_p}}.
\end{equation}\]</span> 根据上述分解, 当给定从 <span class="math inline">\(\pi(\alpha \mid \bm{y})\)</span> 生成的随机样本 <span class="math inline">\(\alpha_0\)</span>时, 可直接从 <span class="math inline">\(Ga(\delta_p\bar{T}_m\alpha_0,\delta_p\lambda_p)\)</span> 中生成<span class="math inline">\(\beta\)</span> 的随机样本. 因此, 目前主要挑战在于生成 <span class="math inline">\(\alpha\)</span> 的随机样本. 由于 <span class="math inline">\(\pi(\alpha \mid \bm{y})\)</span> 具有复杂性, 本节提出一种简便的离散网格采样法(Discrete grid sampling, DGS): 通过在一系列网格点上构建离散分布来近似 <span class="math inline">\(\alpha\)</span> 的边缘后验分布, 从而实现 <span class="math inline">\(\alpha\)</span> 的统计推断. 具体方法如下: 首先, 选取一个区间 <span class="math inline">\([A_1, A_2]\)</span>, 使<span class="math inline">\(\alpha\)</span>落入该区间的概率接近1, 即, 计算定积分 <span class="math inline">\(\int_{A_1}^{A_2}\pi(\alpha \mid \bm{y})\text{d}\alpha\)</span>的值是否接近1. 区间 <span class="math inline">\([A_1, A_2]\)</span>可利用六西格玛法来确定, 具体步骤如下:</p>
<ol type="a">
<li><p>确定 <span class="math inline">\(\tilde{\alpha}=\mathop{\arg\max}\limits_{\alpha} \log h_p(\alpha)\)</span>, 以及 <span class="math display">\[I\left(\tilde{\alpha}\right)=-\dfrac{\partial^2\log h_p(\alpha)}{\partial \alpha^2}\biggl|_{\alpha=\tilde{\alpha}}.
\]</span></p></li>
<li><p>根据 <span class="citation" data-cites="berger2013">(<a href="references.html#ref-berger2013" role="doc-biblioref">Berger, 2013</a>)</span> 的研究, <span class="math inline">\(\pi(\alpha \mid \bm{y})\)</span> 可以用正态分布 <span class="math inline">\(N\left(\tilde{\alpha},\tilde{\sigma}^2\right)\)</span> 近似, 其中 <span class="math inline">\(\tilde{\sigma}=\sqrt{1/I\left(\tilde{\alpha}\right)}\)</span>.</p></li>
<li><p>构建区间 <span class="math inline">\(A_1=\max{0,\tilde{\alpha}-6\tilde{\sigma}}\)</span> 和 <span class="math inline">\(A_2=\tilde{\alpha}+6\tilde{\sigma}\)</span>. 根据正态分布的性质, 可知 <span class="math inline">\(\alpha\)</span> 落在区间 <span class="math inline">\([A_1,A_2]\)</span> 内的概率几乎为 1.</p></li>
</ol>
<p>在区间 <span class="math inline">\([A_1, A_2]\)</span> 内选择 <span class="math inline">\(M\)</span> 个等间距网格点 <span class="math inline">\(\left\{A_1=\alpha^{(1)},\alpha^{(2)},\dots,A_2=\alpha^{(M)}\right\}\)</span>, 并使用未标准化的后验密度 <span class="math inline">\(h_p(\alpha)\)</span> 计算每个网格点的概率 <span class="math display">\[\begin{equation}\label{disalp}
    P(\alpha=\alpha^{(s)})=\dfrac{h_p\left(\alpha^{(s)}\right)}{\sum_{i=1}^{M}h_p\left(\alpha^{(i)}\right)}, \quad s=1,\dots,M.
\end{equation}\]</span> 通过选择足够大的 <span class="math inline">\(M\)</span>, 可以确保离散分布的近似精度. 通过离散分布采样显著简化了从 <span class="math inline">\(\pi(\alpha \mid \bm{y})\)</span> 中抽样的难度. 例如, 在 R 语言中, 可以直接使用 函数来模拟随机样本. 上述方法的核心是将复杂的连续分布转换为易操作的离散分布, 显著降低了抽样的计算复杂度. 基于该方法的后验推断过程可见算法 <span class="math inline">\(\ref{ITR2025-algo2}\)</span>.</p>
</section>
<section id="重要性重采样" class="level4" data-number="3.2.2.3">
<h4 data-number="3.2.2.3" class="anchored" data-anchor-id="重要性重采样"><span class="header-section-number">3.2.2.3</span> 重要性重采样</h4>
<p>第三种算法与第二种算法的主要区别在于生成 <span class="math inline">\(\pi(\alpha \mid \bm{y})\)</span> 后验样本的方法, 该算法采用了重要性重采样 (Sampling Importance Resampling, SIR) 方法. 在 SIR 中, 采样步骤首先从辅助分布 <span class="math inline">\(g(\alpha)\)</span> 中生成一组随机数, 然后通过重新计算权重, 将其近似为来自 <span class="math inline">\(\pi(\alpha \mid \bm{y})\)</span> 的样本. 辅助分布 <span class="math inline">\(g(\alpha)\)</span> 的选择较为灵活, 可以从一组易于抽样的分布中选取. 然而, SIR 方法的效率取决于 <span class="math inline">\(g(\alpha)\)</span> 和 <span class="math inline">\(\pi(\alpha \mid \bm{y})\)</span> 的相似程度, 尤其是分布尾部的相似性会影响近似的精度. 从式 <span class="math inline">\(\eqref{appro0}\)</span> 可知, <span class="math inline">\(\pi(\alpha \mid \bm{y})\)</span> 的尾部形式 (当 <span class="math inline">\(\alpha \rightarrow \infty\)</span> 时) 与形状参数 <span class="math inline">\((\delta_p+3)/2\)</span> 和尺度参数 <span class="math display">\[
\nu=\delta_p\overline{T}m \left[\log\left(\frac{\lambda_p}{\omega_p}\right)+\log\left(\frac{\prod{j=1}^{m}t_j^{t_j/T_m}}{\overline{T}_m}\right)\right]
\]</span> 的伽马分布尾部同阶. 因此, 伽马分布 <span class="math inline">\(Ga(a, b)\)</span> 是一个合适的辅助分布, 其参数 <span class="math inline">\(a\)</span> 和 <span class="math inline">\(b\)</span> 可以通过以下步骤来确定:</p>
<ol type="a">
<li><p>令 <span class="math inline">\(\tilde{\alpha}=\mathop{\arg\max}\limits_{\alpha} \log h_p(\alpha)\)</span>, 并计算 <span class="math display">\[
I\left(\tilde{\alpha}\right)=-\dfrac{\partial^2\log h_p(\alpha)}{\partial \alpha^2}\biggl|_{\alpha=\tilde{\alpha}}.
\]</span></p></li>
<li><p>初始化 <span class="math inline">\(b\)</span> 为 <span class="math inline">\(b_0=\nu\)</span>, 并初始化 <span class="math inline">\(a\)</span> 为 <span class="math inline">\(a_0=\tilde{\alpha}b_0\)</span>. 确保辅助分布 <span class="math inline">\(Ga(a_0,b_0)\)</span> 的均值为 <span class="math inline">\(\tilde{\alpha}\)</span>.</p></li>
<li><p>计算精度比 <span class="math inline">\(R=\frac{b_0^2/a_0}{I\left(\tilde{\alpha}\right)}\)</span>, 然后更新参数 <span class="math inline">\(a=a_0/R\)</span> 和 <span class="math inline">\(b=b_0/R\)</span>. 该步骤不会改变辅助分布的均值, 但可以使 <span class="math inline">\(Ga(a, b)\)</span> 的方差与 <span class="math inline">\(\pi(\alpha \mid \bm{y})\)</span> 的渐近方差一致.</p></li>
</ol>
<p>通过以上步骤确定了辅助分布 <span class="math inline">\(Ga(a, b)\)</span>, 并从中产生 <span class="math inline">\(M\)</span> 个随机样本 <span class="math inline">\(\left\{\alpha^{(1)},\alpha^{(2)},\dots,\alpha^{(M)}\right\}\)</span>. 计算权重 <span class="math inline">\(w_i=h_p\left(\alpha^{(i)}\right)/f_{Ga}\left(\alpha^{(i)} \mid a,b\right)\)</span>, <span class="math inline">\(i=1,\dots,M\)</span>, 其中 <span class="math inline">\(f_{Ga}\left(\alpha^{(i)} \mid a,b\right)\)</span> 表示 <span class="math inline">\(Ga(a,b)\)</span> 在 <span class="math inline">\(\alpha^{(i)}\)</span> 处的PDF值. 对权重进行归一化, 得到 <span class="math inline">\(\tilde{w}_i=w_i/\sum_{j=1}^{M}w_j\)</span>. 最后, 从离散分布中生成 <span class="math inline">\(\alpha\)</span> 的随机样本, 其分布律为 <span class="math display">\[\begin{equation}\label{dis2}
    P\left(\alpha=\alpha^{(i)}\right)=\tilde{w}_i,~i=1,2,\dots,M.
\end{equation}\]</span> SIR 算法的后验推断过程可见算法 <span class="math inline">\(\ref{ITR2025-algo3}\)</span>.</p>
</section>
</section>
<section id="sec-ITR2025-sim" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="sec-ITR2025-sim"><span class="header-section-number">3.2.3</span> 模拟实验</h3>
<p>在开展模拟研究之前, 首先利用所提方法分析激光退化数据, 其退化路径如图 <a href="01-intro.html#fig-fig:laser2" class="quarto-xref"><span>1.2</span></a> 所示, 其中 <span class="math inline">\(n=15\)</span>, <span class="math inline">\(m=16\)</span>, <span class="math inline">\(\omega=10\)</span>. <!-- 从图中可以看到有三个器件在测试终止时间之前, 退化值已经超过了阈值.  --> 在应用伽马过程拟合数据之前, 首先, 通过Kolmogorov-Smirnov检验来验证数据是否符合伽马过程的 假设<span class="citation" data-cites="wangetal03">(<a href="references.html#ref-wangetal03" role="doc-biblioref">Marsaglia 等, 2003</a>)</span>. 由于该数据集中所有 <span class="math inline">\(t_j\)</span> 的值均为 250 小时, 因此 <span class="math inline">\(y_{ij} \sim Ga(250\alpha, \beta)\)</span>. 使用 <em>R</em> 软件中的 <em>ks.test()</em> 函数进行检验, 得到 p 值为 0.13, 大于显著性水平 0.05. 这表明伽马过程能够用来拟合该数据. 因此, 假设激光器件的退化路径服从伽马过程 <span class="math inline">\(\mathcal{GP}(\alpha t,\beta)\)</span>. 接着, 基于共轭先验 <span class="math inline">\(\eqref{con0}\)</span> 进行贝叶斯推断, 其中设定 <span class="math inline">\(\delta=1\)</span> 且 <span class="math inline">\(\lambda=\bar{y}_a\)</span>. 由于数据是等间隔测量的, 因此 <span class="math inline">\(\omega=\bar{y}_g=\prod_{i=1}^{n}\prod_{1}^{m}y_{ij}^{1/(mn)}\)</span>, 即 <span class="math inline">\(\{y_{ij}, i=1,\dots,15,j=1,\dots,16\}\)</span> 的几何平均值. 在第 <a href="#sec-ITR2025-prior" class="quarto-xref"><span> 3.2.1</span></a> 节中曾讨论过, <span class="math inline">\(\delta=1\)</span> 表示先验信息仅相当于一次测量的信息量, 与总计 <span class="math inline">\(mn\)</span> 次测量数据相比, 先验信息较弱. 因此, <span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\(\beta\)</span> 的后验分布为 <span class="math inline">\(\textrm{AGG}\left(mn+1,\prod_{i=1}^{n}\prod_{1}^{m}y_{ij}^{1/(mn)},\bar{y}_a\right)\)</span>. 利用上述三种算法分别得到 <span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\(\beta\)</span> 的点估计及其 95% 区间估计, 同时估计 4500 ( 小时) 时设备的可靠度 <span class="math inline">\(R(4500)\)</span>. 估计结果列在表 <span class="math inline">\(\ref{tbl-tab:dat1}\)</span>中 (其中”GS” 表示基于 Gibbs 采样的算法). 在 Gibbs 采样中, 设定迭代次数 <span class="math inline">\(K_1\)</span> 为 3000, 其中前 1000 次迭代作为预烧样本舍弃, 并设定稀释(thinning)间隔为2, 最终保留 1000 个有效样本用于后验推断. 在 DGS 中, 离散化区间为 <span class="math inline">\([0,10]\)</span>, 网格点数量设为 10000, 后验推断的样本量同样为 1000. 在 SIR 中, 设定 <span class="math inline">\(M=10,000\)</span>, 并从中重采样 <span class="math inline">\(K_3=1,000\)</span>个样本. 正如表 <span class="math inline">\(\ref{tbl-tab:dat1}\)</span> 所示, 三种算法下 <span class="math inline">\(\alpha\)</span>、<span class="math inline">\(\beta\)</span> 和 <span class="math inline">\(R(4500)\)</span> 的贝叶斯点估计及 95%区间估计上均表现出高度一致性.</p>
<p>为了更全面地比较这三种算法, 本节在具有不同信息量的共轭先验下进行了模拟研究. 数据通过伽马过程 <span class="math inline">\(\mathcal{GP}(\alpha t,\beta)\)</span>生成, 参数设定为 <span class="math inline">\(\alpha=0.031\)</span> 和 <span class="math inline">\(\beta=15.35\)</span> (接近表 <span class="math inline">\(\ref{tbl-tab:dat1}\)</span> 中的估计值). 实验中, 共对 <span class="math inline">\(n=15\)</span> 个样本进行了测试, 每个样本以 250 小时的间隔进行测量, 总计进行了 <span class="math inline">\(m=16\)</span> 次测量, 并将失效阈值设定为 10. 采用共轭先验分布 <span class="math inline">\(\textrm{AGG}(\delta,\bar{y}_g, \bar{y}_a)\)</span>, 通过设定<span class="math inline">\(\delta=0,1,m/4,m/2\)</span> 来评估先验信息量对结果的影响.</p>
<p>随机生成了 <span class="math inline">\(N=10000\)</span> 个数据集, 并应用所提出的算法进行分析, 得到 <span class="math inline">\(\alpha\)</span>、<span class="math inline">\(\beta\)</span>、<span class="math inline">\(R(4500)\)</span> 和 MTTF 的贝叶斯点估计及其 95% 区间估计. 基于这些估计结果, 计算了相对偏差 (Relative bias, RB) 和 RMSE, 结果分别列于表 <span class="math inline">\(\ref{tbl-tab:arb}\)</span> 和表 <span class="math inline">\(\ref{tbl-tab:rmse}\)</span>. 在所有情况下, 参数估计均表现出令人满意的效果: <span class="math inline">\(\alpha\)</span>、<span class="math inline">\(\beta\)</span> 和 <span class="math inline">\(R(4500)\)</span> 的贝叶斯估计的 RB 约为 2%, 而 MTTF 的贝叶斯估计的 RB 约为 0.1%. 三种算法在 RB 和 RMSE 上的表现几乎一致, 且先验信息量 <span class="math inline">\(\delta\)</span> 的变化对估计结果的影响不显著.</p>
<p>在评估参数的区间估计时, 计算了 95% 可信区间的平均长度和CP. 结果分别列在表 <span class="math inline">\(\ref{tbl-tab:length}\)</span> 和表 <span class="math inline">\(\ref{tbl-tab:cp}\)</span>. 分析发现, 随着先验信息量的增加, 95% 置信区间的长度逐渐减小, 且三种算法在这一趋势上表现相似, 差异不显著. 然而, 在覆盖概率方面, 不同算法表现出一定差异. 对于模型参数 <span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\(\beta\)</span>, 无论先验信息量 <span class="math inline">\(\delta\)</span> 的变化如何, 基于DGS和SIR算法的覆盖概率更接近理想的95%水平, 而基于GS算法的覆盖概率则相对较低. 对于 <span class="math inline">\(R(4500)\)</span> 和 MTTF的估计, 三种算法的覆盖概率均接近名义水平(即, 95%), 表明所提出的后验采样算法在这些指标估计中具有较高的准确性.</p>
<p>在计算效率方面, 三种算法(Gibbs采样、DGS以及SIR)在每个数据集上的平均运行时间分别为0.602 秒、0.00341 秒以及0.00499 秒. 测试环境为运行 Windows 11 操作系统的台式机, 配备 Intel(R) Core(TM) i7-10700 CPU(2.9 GHz) 和 16 GB RAM. 该结果显示, DGS和 SIR 算法的计算效率相近, 并且都显著快于Gibbs算法, 速度提升了超过一百倍. 在实时推断的应用场景中, 计算效率是一个关键因素. 随着新观测数据的不断收集, 需要实时更新后验分布, 同时在保持估计精度的情况下, 尽可能快速完成推断过程. 正如表 <span class="math inline">\(\ref{tbl-tab:arb}\)</span> 至表 <span class="math inline">\(\ref{tbl-tab:cp}\)</span> 所示, DGS和 SIR 算法不仅在计算效率上具有明显优势, 而且在估计精度方面表现优异, 充分满足在线推断的需求. 基于上述结果, 在后续章节中, 将主要采用DGS和 SIR 算法用于在线RUL的预测研究.</p>
</section>
<section id="sec-ITR2025-heter" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="sec-ITR2025-heter"><span class="header-section-number">3.2.4</span> 异质性</h3>
<p>产品间的异质性通常源于内在因素和外在因素的差异. 内在因素包括原材料和生产工艺的变化, 而外在因素则涉及操作环境和使用习惯的不同. 这种异质性导致每个产品的性能退化轨迹各不相同. 尽管如此, 由于这些产品源自同一总体, 它们的失效机制通常是一致的. 基于此, 假设第 <span class="math inline">\(i\)</span> 个产品的性能退化服从伽马过程 <span class="math inline">\(\mathcal{GP}(\alpha t, \beta_i)\)</span>. 这里形状参数<span class="math inline">\(\alpha\)</span>相同是由于产品失效机制一致, 而不同的尺度参数 <span class="math inline">\(\beta_i\)</span> 则刻画产品间的异质性. 为简化符号, 假设采用等间隔测量, 即相邻测量时间点的间隔为 <span class="math inline">\(l\)</span>. 试验中测试了 <span class="math inline">\(n\)</span> 个产品, 在时间点 <span class="math inline">\(T_m = ml\)</span> 时, 每个产品进行了 <span class="math inline">\(m\)</span> 次测量. 令 <span class="math inline">\(Y_{ij}\)</span> 表示第 <span class="math inline">\(i\)</span> 个产品在时间点 <span class="math inline">\(T_j = jl\)</span> 的退化值, 其中 <span class="math inline">\(i=1, \dots, n\)</span>, <span class="math inline">\(j=1, \dots, m\)</span>. 定义退化增量为 <span class="math inline">\(y_{ij} = Y_{ij} - Y_{ij-1}\)</span>, 并设 <span class="math inline">\(Y_{i0} = 0\)</span>. 在时间点 <span class="math inline">\(T_m\)</span>处, 记观测数据为 <span class="math inline">\(\bm{y_{(m)}} = \{y_{ij}, i=1,\dots,n,~j=1,\dots,m\}\)</span>. 由于 <span class="math inline">\(Y_i(t) \sim \mathcal{GP}(\alpha t, \beta_i)\)</span>, 可得 <span class="math inline">\(y_{ij} \sim Ga(\alpha l, \beta_i)\)</span>. 基于观测数据 <span class="math inline">\(\bm{y_{(m)}}\)</span>, 对应的似然函数为 <span class="math display">\[\begin{align}\label{like2}
        L\left( \bm{y_{(m)}} \mid \alpha,\beta_1,\dots,\beta_n\right)&amp;=\prod_{i=1}^{n}\prod_{j=1}^{m}\dfrac{\beta_i^{\alpha l}}{\Gamma(\alpha l)}
        y_{ij}^{\alpha l-1}\exp\{-\beta_i y_{ij}\}\nonumber\\
        &amp;\propto \dfrac{\bar{\beta}_g^{mnl\alpha}}{\left[\Gamma(\alpha l)\right]^{mn}}
        \bar{y}_{g(m)}^{mnl\alpha}\exp\left\{-\sum_{i=1}^{n}m\bar{y}_{i(m)}\beta\right\},
\end{align}\]</span> 其中 <span class="math display">\[\begin{align*}
\bar{\beta}_{g}&amp;=\left[\prod_{i=1}^{n}\beta_{i}\right]^{1/n},
\bar{y}_{g(m)}=\left[\prod_{i=1}^{n}\prod_{j=1}^{m}y_{ij}\right]^{\frac{1}{mn}},\\
\bar{y}_{i(m)}&amp;=\frac{1}{m}\sum_{j=1}^{m}y_{ij}, i=1, \dots, n.
\end{align*}\]</span></p>
<div id="thm-ITR2025-th3" class="theorem">
<p><span class="theorem-title"><strong>定理 3.2</strong></span> 基于似然函数, <span class="math inline">\((\alpha,\beta_1,\dots,\beta_n)^{'}\)</span> 的共轭先验为 <span class="math display">\[\begin{equation}\label{con2}
  \begin{aligned}
      \pi(\alpha,\beta_1,\dots,\beta_n)&amp;=
        C \dfrac{\left(\bar{\beta}_g\omega\right)^{\delta_1 l\alpha}}{\left[\Gamma(l\alpha)\right]^{\delta_1}}
      \exp\left\{-\sum_{i=1}^{n}\delta_2\lambda_i\beta_i\right\},
  \end{aligned}
\end{equation}\]</span> 其中<span class="math inline">\(C\)</span> 是正则化常数, <span class="math inline">\(\delta_1\)</span>、<span class="math inline">\(\delta_2\)</span>、<span class="math inline">\(\omega\)</span> 和 <span class="math inline">\(\lambda_i\)</span> 是非负超参数.</p>
</div>
<p>定理 <a href="#thm-ITR2025-th3" class="quarto-xref"><span>3.2</span></a> 的证明见本节附录 <a href="#sec-Append-3A" class="quarto-xref"><span> 3.2.7</span></a>. 当 <span class="math inline">\(\beta_1=\dots=\beta_n=\beta\)</span>, <span class="math inline">\(\delta_1=n\delta_2=\delta\)</span> 且 <span class="math inline">\(\lambda_1=\dots=\lambda_n=\lambda\)</span> 时, 共轭先验 <span class="math inline">\(\eqref{con2}\)</span> 简化为 <span class="math inline">\(\eqref{con1}\)</span>. 为了更好地理解共轭先验 <span class="math inline">\(\eqref{con2}\)</span>, 可将 <span class="math inline">\(\pi(\alpha,\beta_1,\dots,\beta_n)\)</span> 分解为 <span class="math display">\[\begin{equation*}
\begin{aligned}
        \pi(\alpha,\beta_1,\dots,\beta_n)&amp;=\prod_{i=1}^{n}\pi(\beta_i \mid \alpha)\pi(\alpha)\\
        &amp;\propto\prod_{i=1}^{n}\dfrac{(\delta_2\lambda_i)^{1+\delta_1l\alpha/n}\beta_i^{\delta_1 l\alpha/n}}{\Gamma(1+\delta_1 l\alpha/n)}\exp\{-\delta_2\lambda_i\beta_i\}\\
        &amp;\ \ \ \ \times \dfrac{\left[\Gamma(1+\delta_1 l\alpha/n)\right]^n}{\left[\Gamma(l\alpha)\right]^{\delta_1}}\exp\left\{-\alpha\delta_1 l\left[\log\left(\frac{\delta_2}{\omega}\right)+\frac{1}{n}\sum_{i=1}^{n}\log\lambda_i\right]\right\}.  
\end{aligned}
\end{equation*}\]</span> 因此, 给定 <span class="math inline">\(\alpha\)</span> 时, <span class="math inline">\(\beta_i\)</span> 的条件分布为 <span class="math inline">\(Ga(1+\delta_1 l\alpha/n,\delta_2\lambda_i)\)</span>, 而 <span class="math inline">\(\alpha\)</span> 的边缘PDF与下式成比例 <span class="math display">\[\begin{align}\label{margi2}
    g(\alpha)&amp;=\dfrac{\left[\Gamma(1+\delta_1 l\alpha/n)\right]^n}{\left[\Gamma(l\alpha)\right]^{\delta_1}}\nonumber\\
    &amp;\quad\times \exp\left\{-\alpha\delta_1 l\left[\log\left(\frac{\delta_2}{\omega}\right)+
    \frac{1}{n}\sum_{i=1}^{n}\log\lambda_i\right]\right\}.
\end{align}\]</span> 利用Stirling公式, 当 <span class="math inline">\(\alpha\rightarrow\infty\)</span> 时, 有 <span class="math display">\[
g(\alpha)\equiv O\left(\alpha^{\frac{\delta_1+n}{2}}
\exp\left\{-A\alpha\right\}\right),
\]</span> 其中 <span class="math display">\[
A=\delta_1 l\left[\log\left(\frac{n\delta_2}{\delta_1}\right)+\frac{1}{n}\sum_{i=1}^{n}\log\left(\frac{\lambda_i}{\omega}\right)\right].
\]</span> 因此, 当 <span class="math inline">\(\alpha\rightarrow\infty\)</span>时, <span class="math inline">\(\pi(\alpha)\)</span>趋于0的速度与伽马分布<span class="math inline">\(\textrm{Ga}\left(\frac{\delta_1+n+2}{2},K\right)\)</span>同阶. 因此, 称<span class="math inline">\(\pi(\alpha,\beta_1,\dots,\beta_n)\)</span> 为近似伽马-多元伽马(Approximated-gamma-multivariate gamma, AGMG) 分布, 维度为 <span class="math inline">\(n\)</span>, 记作 <span class="math inline">\(\textrm{AGMG}_n(\bm\gamma,\omega,\bm\xi)\)</span>, 其中 <span class="math inline">\(\bm\gamma=(\delta_1,\delta_2)^{'}\)</span>, <span class="math inline">\(\bm\xi=(\lambda_1,\dots,\lambda_n)^{'}\)</span>.</p>
<p>由式 <span class="math inline">\(\eqref{post2}\)</span> 可知, 参数 <span class="math inline">\((\alpha,\beta_1,\dots,\beta_n)^{'}\)</span> 的后验分布服从 <span class="math inline">\(\textrm{AGMG}_n\left(\bm\gamma_{p(m)}, \omega_{p(m)}, \bm\xi_{p(m)}\right)\)</span>, 其中 <span class="math inline">\(\bm\gamma_{p(m)}=(\delta_{1p(m)},\delta_{2p(m)})^{'}\)</span> 和 <span class="math inline">\(\bm\xi_{p(m)}=(\lambda_{1p(m)},\dots,\lambda_{np(m)})^{'}\)</span>. 超参数 <span class="math inline">\(\omega\)</span> 和 <span class="math inline">\(\bm\xi\)</span> 的具体选择分别为 <span class="math inline">\(\bar{y}{g(m)}\)</span> 和 <span class="math inline">\(\bm{\bar{y}}{(m)}=\left(\bar{y}{1(m)},\dots,\bar{y}{n(m)}\right)^{'}\)</span>. 由于后验分布的形式为 <span class="math inline">\(\textrm{AGMG}_n(\bm\gamma_{p(m)},\bar{y}{g(m)},\bm{\bar{y}}{(m)})\)</span>. 在该设置下, 超参数 <span class="math inline">\(\delta_1\)</span> 和 <span class="math inline">\(\delta_2\)</span> 与测量次数有类似的解释. 由等式 <span class="math inline">\(\eqref{con1}\)</span>可知, <span class="math inline">\(\delta_1\)</span> 和 <span class="math inline">\(\delta_2\)</span> 主要决定 AGMG 分布的峰度, 从而控制先验信息的权重. 生成AGMG 分布的随机样本可以通过适当修改算法 <span class="math inline">\(\ref{ITR2025-algo2}\)</span> 和 <span class="math inline">\(\ref{ITR2025-algo3}\)</span> 来实现. 主要区别在于目标分布变更为 <span class="math inline">\(\textrm{AGMG}_n\left(\bm\gamma_{p(m)},\omega_{p(m)},\bm\xi_{p(m)}\right)\)</span> 中 <span class="math inline">\(\alpha\)</span> 的后验边缘分布, 而在给定 <span class="math inline">\(\alpha\)</span>时, <span class="math inline">\(\beta_i\)</span>则从伽马分布 <span class="math inline">\(\textrm{Ga}\left(1+\delta_{1p(m)} l\alpha/n,\delta_{2p(m)}\lambda_{ip(m)}\right)\)</span>中产生随机数, 其中 <span class="math inline">\(i=1,\dots,n\)</span>. 这两种算法 (DGS 和 SIR) 的计算时间与维度 <span class="math inline">\(n\)</span> 成正比. 为了说明这一点, 本小节在相同的参数设置下, 对 <span class="math inline">\(n\)</span> 从 2 到 50 的 AGMG 分布应用了这两种算法, 并记录了计算时间, 结果如图 <a href="#fig-fig:ctime" class="quarto-xref"><span>3.2</span></a> 所示. 从图中可以看出, 计算时间随着 <span class="math inline">\(n\)</span> 的增加而线性增长. 例如, 当 <span class="math inline">\(n\)</span> 从 2 增加到 50 时, DGS 的计算时间从 0.00328 秒增加到 0.00895 秒, 而 SIR 的计算时间从 0.00448 秒增加到 0.0101 秒. 这表明即使在较大的 <span class="math inline">\(n\)</span> 值下, 这两种算法仍然保持着较高的计算效率.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig:ctime" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig:ctime-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="figures/Gamma/ITR2025/ctime.pdf" class="img-fluid quarto-figure quarto-figure-center" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig:ctime-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.2: 不同维度下对 AGMG 分布进行采样的两种算法的计算时间.
</figcaption>
</figure>
</div>
</div>
</div>
<p>RUL预测是产品故障诊断与健康管理的核心基础. 在实际应用中, 当产品处于正常工作状态时 ( 即退化量尚未达到失效阈值) , 需要基于实时监测数据动态评估其剩余使用寿命. 具体而言, 假设在时间 <span class="math inline">\(t_m\)</span> 监测到第 <span class="math inline">\(i\)</span> 个产品的退化轨迹 <span class="math inline">\(\{Y_{i1},\dots,Y_{im}\}\)</span> 均满足 <span class="math inline">\(Y_{ij} &lt; \omega\)</span> ( 其中 <span class="math inline">\(\omega\)</span> 为失效阈值) , 则其在时间 <span class="math inline">\(t_m\)</span> 的 RUL 定义为 <span class="math display">\[Z_{it_m}=\inf\{z:Y_i(z+t_m)&gt;\omega|Y_{ij}&lt;\omega,j=1,\dots,m\},\]</span> 其分布函数为 <span class="math display">\[\begin{align}
    F_{Z_{it_m}}(z \mid \alpha,\beta_i)&amp;=P(Y_i(z+t_m)&gt;\omega)=P(Y_i(z)&gt;\omega-Y_{im})\nonumber\\
    &amp;=\frac{\Psi(\beta(\omega-Y_{im}),\alpha z)}{\Gamma(\alpha z)}.
\end{align}\]</span> 由伽马过程的齐次性可知, 最后两个等式成立. 由于<span class="math inline">\(F_{Z_{it_m}}(z \mid \alpha,\beta_i)\)</span>较为复杂, 可用两参数BS分布<span class="math inline">\(BS(\alpha_{im}^\ast,\beta_{im}^\ast)\)</span>近似<span class="citation" data-cites="parpad2005">(<a href="references.html#ref-parpad2005" role="doc-biblioref">Park 等, 2005</a>)</span>, 其中 <span class="math display">\[\alpha_{im}^\ast=\sqrt{\frac{1}{\beta_i(\omega-Y_{im})}},\quad
\beta_{im}^\ast=\frac{\beta_i(\omega-Y_{im})}{\alpha}.
\]</span> 因此, 在时间点<span class="math inline">\(t_m\)</span>, 第<span class="math inline">\(i\)</span>个产品RUL的均值可近似为 <span class="math display">\[\mu_{im}(\alpha,\beta_i)=\beta_{im}^\ast\left(1+\left(\alpha_{im}^\ast\right)^2/2\right)=
\dfrac{1+2\beta_i(\omega-Y_{im})}{2\alpha}.\]</span> 此外, <span class="math inline">\(Z_{i t_m}\)</span> 的分布 <span class="math inline">\(\rho\)</span> 分位数可近似为 <span class="math display">\[\mu^{\rho}_{im}(\alpha,\beta_i)=\frac{\beta_{im}^\ast}{4}\left[u_\rho\alpha_{im}^\ast +\sqrt{\left(u_\rho\alpha_{im}^\ast\right)^{2}+4}\right]^{2},\]</span> 其中 <span class="math inline">\(u_\rho\)</span> 是标准正态分布的 <span class="math inline">\(\rho\)</span> 分位数. 在时间<span class="math inline">\(t_m\)</span>, 第 <span class="math inline">\(i\)</span> 个产品RUL 的贝叶斯点预测为 <span class="math display">\[\begin{equation}\label{point}
    \tilde{\mu}_{im}=\int_0^{\infty}\int_0^{\infty}\mu_{im}(\alpha,\beta_i)\pi(\alpha,\beta_i \mid  \bm{y_{(m)}})\text{d}\alpha\text{d}\beta_i.
\end{equation}\]</span> 在时间<span class="math inline">\(t_m\)</span>时, 第 <span class="math inline">\(i\)</span> 个产品 RUL 的 <span class="math inline">\(1-\rho\)</span> 可信水平的贝叶斯区间预测为 <span class="math display">\[\begin{equation}\label{inter}
    \left(\tilde{\mu}_{im}^{\rho/2},\tilde{\mu}_{im}^{1-\rho/2}\right),
\end{equation}\]</span> 其中 <span class="math display">\[
\tilde{\mu}_{im}^{\rho}=\int_0^{\infty}\int_0^{\infty}\mu^{\rho}_{im}(\alpha,\beta_i)\pi(\alpha,\beta_i \mid \bm{y_{(m)}})\text{d}\alpha\text{d}\beta_i.
\]</span> 给定后验样本 <span class="math inline">\({(\alpha^{(k)},\beta_i^{(k)}), k=1,\dots,K}\)</span>, 式 <span class="math inline">\(\eqref{point}\)</span> 和 <span class="math inline">\(\eqref{inter}\)</span> 可通过蒙特卡罗方法近似: <span class="math display">\[\begin{equation}\label{mcest}
    \tilde{\mu}_{im}\approx\frac{1}{K}\sum_{k=1}^{K}\mu_{im}(\alpha^{(k)},\beta_i^{(k)}),~~
    \tilde{\mu}_{im}^{\rho}\approx\frac{1}{K}\sum_{k=1}^{K}\mu^{\rho}_{im}(\alpha^{(k)},\beta_i^{(k)}).
\end{equation}\]</span></p>
<p><strong>注4</strong>: DGS 和 SIR 算法主要用于产生模型参数 <span class="math inline">\((\alpha,\beta_1,\dots,\beta_n)^{'}\)</span> 的后验样本. 基于这些后验样本, 可通过式 <span class="math inline">\(\eqref{mcest}\)</span> 对 <span class="math inline">\(n\)</span> 个产品进行 RUL 预测. 算法具备高度灵活性, 既适用于单个产品的预测, 也适用于多个产品的协同预测. 当 <span class="math inline">\(n=1\)</span> 时, 算法仅利用单个产品的信息, 退化为第 <a href="#sec-ITR2025-ps" class="quarto-xref"><span> 3.2.2</span></a> 节中的内容. 当 <span class="math inline">\(n\ge 2\)</span> 时, 算法通过共享多个产品的信息来共同估计参数 <span class="math inline">\(\alpha\)</span>, 并利用其他产品的信息提高参数 <span class="math inline">\(\beta_i\)</span> 的估计精度.</p>
</section>
<section id="sec-ITR2025-rul" class="level3" data-number="3.2.5">
<h3 data-number="3.2.5" class="anchored" data-anchor-id="sec-ITR2025-rul"><span class="header-section-number">3.2.5</span> RUL预测</h3>
<!-- 随着先进传感技术的兴起和普及, 产品的性能退化信息可以实时监测, 并且在收集到新的观测数据后, RUL 预测将进行更新. 在本节中, 我们将提出一种基于伽马过程的在线 RUL 预测算法. 该算法在在线更新方面具有多项优势, 例如高计算效率、低数据存储空间需求、同时对多个产品进行 RUL 预测等.  -->
<p>假设在时间点<span class="math inline">\(t_{m+1}=(m+1)l\)</span>收集到了 <span class="math inline">\(n\)</span> 个产品的新退化增量 <span class="math inline">\(\bm{y}_{(m+1)}=(y_{1m+1},\dots,y_{nm+1})^{'}\)</span>. 在获取新的观测数据后, <span class="math inline">\((\alpha,\beta_1,\dots,\beta_n)^{'}\)</span> 的后验分布需要更新. 对于具有共轭先验的贝叶斯推断, 可使用递推公式来实现更新. 由式 <span class="math inline">\(\eqref{post2}\)</span> 可知, 在时间 <span class="math inline">\(t_{m+1}=(m+1)l\)</span> 时, <span class="math inline">\((\alpha,\beta_1,\dots,\beta_n)^{'}\)</span> 的后验分布为 <span class="math inline">\(\textrm{AGMG}_n\left(\bm\gamma_{p(m+1)},\omega_{p(m+1)},\bm\xi_{p(m+1)}\right)\)</span>, 其中参数 <span class="math inline">\(\bm\gamma_{p(m+1)}\)</span>、<span class="math inline">\(\omega_{p(m+1)}\)</span> 和 <span class="math inline">\(\bm\xi_{p(m+1)}\)</span> 可实现递推更新. 即 <span class="math display">\[\begin{equation}\label{post3}
  \begin{aligned}
    \bm\gamma_{p(m+1)}&amp;=\bm\gamma_{p(m)}+(n,1)^{'}, \\
    \omega_{(m+1)}&amp;=\omega_{(m)}^{\frac{mn+\delta_1}{(m+1)n+\delta_1}}\left[\prod_{i=1}^{m}y_{im+1}\right]^{\frac{1}{(m+1)n+\delta_1}},\\
    \bm\lambda_{(m+1)}&amp;=\frac{m+\delta_2}{m+1+\delta_2}\bm\lambda_{(m)}+\frac{1}{m+1+\delta_2}\bm{y}_{(m+1)}.  
  \end{aligned}
\end{equation}\]</span> 由式 <span class="math inline">\(\eqref{post3}\)</span>可知, 后验分布的更新仅依赖<span class="math inline">\(t_m\)</span>时刻后验分布中的参数值和新增观测数据, 可显著提升计算和数据存储效率. 本章提出的高效 DGS 和 SIR 算法, 可快速生成 AGMG 分布样本, 并用于多个产品的在线 RUL 预测. 具体过程如下:</p>
</section>
<section id="sec-ITR2025-case" class="level3" data-number="3.2.6">
<h3 data-number="3.2.6" class="anchored" data-anchor-id="sec-ITR2025-case"><span class="header-section-number">3.2.6</span> 实例分析</h3>
<section id="激光退化数据" class="level4" data-number="3.2.6.1">
<h4 data-number="3.2.6.1" class="anchored" data-anchor-id="激光退化数据"><span class="header-section-number">3.2.6.1</span> 激光退化数据</h4>
<p>基于第 <span class="math inline">\(\ref{sec-ITR2025-sim}\)</span> 节的激光退化数据集 ( 见图 <a href="01-intro.html#fig-fig:laser2" class="quarto-xref"><span>1.2</span></a>) , 我们重点分析第 1、6 和 10 个激光设备. 观测数据显示, 这三个设备在运行4000小时后均因性能退化量超过阈值 <span class="math inline">\(\omega=10\)</span>而发生失效. 由于监测间隔为 250小时, 其失效时间区间可精确锁定为相邻监测时间点之间. 例如, 第一个设备的退化值在 3750 至 4000 小时之间超过了阈值. 因此, 可采用线性插值法来估计其失效时间. 第一个设备在 3750 小时时记录的退化值为 9.87, 而在 4000 小时时为 10.94. 通过线性插值法, 其失效时间估计为 <span class="math display">\[3750+\dfrac{10-9.87}{10.94-9.87}\times (4000-3750)=3785.75~~ \text{小时}.\]</span> 同理, 第 6 和第 10 个设备的失效时间分别估计为 3506.75 小时和 3351.25 小时.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig:pvas1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig:pvas1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="figures/Gamma/ITR2025/pvalue1.pdf" class="img-fluid quarto-figure quarto-figure-center" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig:pvas1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.3: 每个激光设备的 Kolmogorov-Smirnov 检验 <span class="math inline">\(p\)</span> 值.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig:paresti" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig:paresti-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="figures/Gamma/ITR2025/paresti.pdf" class="img-fluid quarto-figure quarto-figure-center" style="width:95.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig:paresti-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.4: 激光退化数据中 <span class="math inline">\(\alpha\)</span>、<span class="math inline">\(\beta_1\)</span>、<span class="math inline">\(\beta_6\)</span> 和 <span class="math inline">\(\beta_{10}\)</span> 的在线估计值.
</figcaption>
</figure>
</div>
</div>
</div>
<p>通过 Kolmogorov-Smirnov 检验验证各设备退化数据与伽马过程 <span class="math inline">\(\mathcal{GP}(\alpha t, \beta_i)\)</span> 的拟合优度. 如图 <a href="#fig-fig:pvas1" class="quarto-xref"><span>3.3</span></a> 所示, 所有设备的检验 p 值均大于 0.05 的显著性水平, 统计上无法拒绝原假设, 表明伽马过程模型能够有效描述退化轨迹的随机特性.</p>
<p>基于上述模型验证结果, 应用第 <span class="math inline">\(\ref{sec-ITR2025-rul}\)</span> 节提出的在线预测算法进行实时 RUL 预测. 具体实施过程如下: 从 <span class="math inline">\(t=500\)</span> 小时开始, 仅基于前两次监测数据初始化预测模型; 随着监测数据累积, 通过算法 <span class="math inline">\(\ref{algo4}\)</span> 递归更新参数后验分布; 计算出每个时间点三台设备的 RUL 点预测值及其 95% 预测区间. 图 <a href="#fig-fig:paresti" class="quarto-xref"><span>3.4</span></a> 展示了随时间变化的 <span class="math inline">\(\alpha\)</span>、<span class="math inline">\(\beta_1\)</span>、<span class="math inline">\(\beta_6\)</span> 和 <span class="math inline">\(\beta_{10}\)</span> 的估计值. 从图中可发现, <span class="math inline">\(\beta_1\)</span>、<span class="math inline">\(\beta_6\)</span> 和 <span class="math inline">\(\beta_{10}\)</span> 的估计值呈上升趋势, 且它们之间差异显著, 表面设备间具有较强的异质性. 图 <a href="#fig-fig:rulpred" class="quarto-xref"><span>3.5</span></a> 展示了在各个时间点上三台设备RUL的点预测值 及其 95% 预测区间, 并与每个时间点的实际 RUL 进行了对比. 如图所示, 几乎所有实际 RUL 均被 95% 预测区间覆盖, 且点预测值与实际 RUL 非常接近, 显示了预测的高准确性.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig:rulpred" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig:rulpred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="figures/Gamma/ITR2025/rulpred.pdf" class="img-fluid quarto-figure quarto-figure-center" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig:rulpred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.5: 第 1、6 和 10 个设备的 RUL 点预测值及其 95% 预测区间.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="列车车轮数据" class="level4" data-number="3.2.6.2">
<h4 data-number="3.2.6.2" class="anchored" data-anchor-id="列车车轮数据"><span class="header-section-number">3.2.6.2</span> 列车车轮数据</h4>
<!-- 列车车轮数据来源于 [@peng2020student]. 随着行驶距离的增加, 车轮会逐渐磨损. 当车轮直径的磨损达到 60 毫米时, 认为车轮失效. 原始数据集包含 14 个样本, 测量点从 50 到 600 之间均匀分布, 间隔为 50, 其中距离单位为 1000 公里(kkm) .  -->
<p>本节将使用所提出的模型和方法对列车车轮数据 (见图 <a href="01-intro.html#fig-fig:wheeldata" class="quarto-xref"><span>1.5</span></a>) 进行分析, 并预测每个测量点上车轮的RUL. 从图 <a href="01-intro.html#fig-fig:wheeldata" class="quarto-xref"><span>1.5</span></a> 可以看出, 退化路径呈线性并且单调递增. 有三个车轮在 600 千公里前已经失效. 通过线性插值法计算第5、第9和第11个车轮的失效时间, 结果分别为 523.537、558.861 和 421.508 千公里.</p>
<!-- ```{r} -->
<!-- #| label: fig-fig:wheeldata -->
<!-- #| fig.align: 'center' -->
<!-- #| echo: FALSE -->
<!-- #| out.width: '60%' -->
<!-- #| fig.cap: '列车车轮数据. ' -->
<!-- knitr::include_graphics("figures/Gamma/ITR2025/wheel.pdf") -->
<!-- ``` -->
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig:pvas2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig:pvas2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="figures/Gamma/ITR2025/pvalue2.pdf" class="img-fluid quarto-figure quarto-figure-center" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig:pvas2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.6: 每个列车车轮的 Kolmogorov-Smirnov 检验 <span class="math inline">\(p\)</span> 值.
</figcaption>
</figure>
</div>
</div>
</div>
<!--对每个列车车轮的退化数据进行了Kolmogorov-Smirnov检验, 结果如图 @fig-fig:pvas2 所示, 所有车轮的p值均显著高于显著性水平 0.05. 这表明伽马过程\index{伽马过程}模型可以很好地拟合这些数据. 基于此, 采用考虑异质效应的伽马过程\index{伽马过程}对数据进行拟合, 并从第二次测量开始对上述三个车轮的 RUL 进行在线预测. 图 @fig-fig:wheelrul 展示了三个车轮的真实RUL、点预测值及其95\%预测区间. 如图所示, RUL的预测值与实际RUL高度吻合, 并且在所有测量点, 真实RUL均被95\%置信区间\index{置信区间}所覆盖. 这一结果表明, 所提出的算法在不确定性量化方面表现优异, 能够为列车车轮的健康管理提供支撑. -->
<p>基于 Kolmogorov-Smirnov 检验结果 ( 图 <a href="#fig-fig:pvas2" class="quarto-xref"><span>3.6</span></a> 显示所有车轮退化数据的检验 p 值均大于 0.05) , 验证了伽马过程模型对列车车轮退化数据的适用性. 采用考虑异质性效应的伽马过程模型进行建模, 并从第二次监测时点开始在线 RUL 预测. 如图 <a href="#fig-fig:wheelrul" class="quarto-xref"><span>3.7</span></a> 所示, 三个车轮的 RUL 点预测值与实际退化轨迹高度吻合, 且所有时间节点的真实 RUL 均被 95% 预测区间完整覆盖, 表明所提算法在不确定性量化与工程实用性方面具有显著优势, 可为轨道交通关键部件的预防性维护决策提供可靠依据.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig:wheelrul" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig:wheelrul-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="figures/Gamma/ITR2025/wheelrul.pdf" class="img-fluid quarto-figure quarto-figure-center" style="width:95.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig:wheelrul-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.7: 第 5、9 和 11 个车轮的 RUL 点预测值及其 95% 预测区间.
</figcaption>
</figure>
</div>
</div>
</div>
<!-- ### 总结 {#sec-ITR2025-conc} -->
<!-- 本文提出了一种专门针对齐次伽马过程\index{伽马过程}的共轭先验, 并深入研究了其特性. 利用这些特性, 我们提出了三种高级算法(Gibbs 采样、DGS 和 SIR) , 用于从后验分布中模拟随机样本. 生成的样本能够实现精确的后验推断, 模拟研究展示了 DGS 和 SIR 的高计算效率与精度. 扩展了该方法的适用范围, 共轭先验框架进一步包含具有异质效应的伽马过程\index{伽马过程}, 从而能够设计类似的算法生成后验参数样本. 这种共轭参数结构的主要优势在于其可以轻松递推更新后验分布, 显著减少存储空间并提升计算效率. 利用后验分布的递推更新能力, 我们开发了一种创新的在线算法, 可同时对多个产品进行 RUL 预测. 通过两个实际案例验证了所提出的在线算法, 结果表明其能够合理地提供 RUL 的点预测和 95% 置信区间\index{置信区间}.  -->
<!-- 尽管所提出的在线算法能够高效分析大规模数据集, 但也存在一定的局限性. 一个显著的局限性是, 在线更新过程仅适用于测量时间点均匀分布的情况. 这一限制源于共轭先验的特性, 该先验在简化贝叶斯\index{贝叶斯}更新过程时依赖于时间点的均匀性. 当测量时间不均匀时, 共轭性被打破, 后验计算变得复杂, 算法效率降低. 然而, 第 @sec-ITR2025-conc 节和第 @sec-ITR2025-ps 节中开发的共轭先验及后验采样算法具有更广泛的应用. 例如, 利用共轭先验的混合仍然是共轭先验的性质, 该方法可以扩展到处理包含多个子群体的总体问题[@yuanji15; @xuhuwang20]. 此外, 当退化路径为非线性时, 可以引入额外的参数 $\phi$. 在这种情况下, 完全共轭先验的构建变得不可能. 一种折中方案是为 $(\alpha,\beta,\phi)$ 构建半共轭先验. 具体而言, 给定 $\phi$, 对 $(\alpha,\beta)$ 保持共轭结构, 然后对 $\phi$ 赋予一个先验分布. 此方法在处理各种复杂场景时提供了更大的灵活性和适应性, 从而增强了其在实际应用中的实用性.  -->
</section>
</section>
<section id="sec-Append-3A" class="level3" data-number="3.2.7">
<h3 data-number="3.2.7" class="anchored" data-anchor-id="sec-Append-3A"><span class="header-section-number">3.2.7</span> 附录</h3>
<!-- {.unnumbered} -->
<section id="定理-thm-itr2025-th2-的证明" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="定理-thm-itr2025-th2-的证明">定理 <a href="#thm-ITR2025-th2" class="quarto-xref"><span>3.1</span></a> 的证明</h4>
<p>基于似然函数 <span class="math inline">\(\eqref{like0}\)</span> 和先验 <span class="math inline">\(\eqref{con0}\)</span>, <span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\(\beta\)</span> 的联合后验密度为 <span class="math display">\[\begin{align}\label{post0}
      \pi(\alpha,\beta|\bm{y})&amp;\propto    L(\bm{y} \mid \alpha,\beta)\pi(\alpha,\beta)\nonumber\\
      &amp;\propto \dfrac{(\beta\omega_p)^{\delta_p\overline{T}_m\alpha}}{\left[\prod_{j=1}^{m}\left(\Gamma(\alpha t_j)\right)^{1/m}\right]^{\delta_p}}
      \exp\{-\delta_p\lambda_p\beta\},
\end{align}\]</span> 其中 <span class="math display">\[\begin{align*}
\delta_p&amp;=mn+\delta,\\
\omega_p&amp;=\omega^{\frac{\delta}{mn+\delta}}\left[\prod_{i=1}^{n}\prod_{j=1}^{m}y_{ij}^{\frac{t_{j}}{nm\overline{T}_m}}\right]^{\frac{mn}{mn+\delta}},\\
\lambda_p&amp;=\frac{mn}{mn+\delta}\bar{y}_a+\frac{\delta}{mn+\delta}\lambda.
\end{align*}\]</span> 因此, <span class="math inline">\(\pi(\alpha,\beta)\)</span> 和 <span class="math inline">\(\pi(\alpha,\beta \mid \bm{y})\)</span> 均属于同一分布族.</p>
</section>
<section id="不等式证明" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="不等式证明">不等式证明</h4>
<!-- {.unnumbered} -->
<!-- $\log\left(\frac{\prod_{j=1}^{m}t_j^{t_j/T_m}}{\overline{T}_m}\right)\ge 0$ -->
<p>由 <span class="math inline">\(T_m=\sum_{j=1}^{m}t_j\)</span>, 得到 <span class="math display">\[\begin{equation*}
  \begin{aligned}
    \log\left(\frac{\prod_{j=1}^{m}t_j^{t_j/T_m}}{\overline{T}_m}\right)&amp;=
    \sum_{j=1}^{m}\frac{t_j}{T_m}\log(t_j)-\log\left(\overline{T}_m\right)  \\
    &amp;=\frac{\sum_{j=1}^{m}t_j\log(t_j)}{\sum_{j=1}^{m}t_j}-\log\left(\frac{1}{m}\sum_{j=1}^{m}t_j\right)    
\end{aligned}
\end{equation*}\]</span> 令 <span class="math inline">\(q(x)=x\log(x)\)</span>, 则 <span class="math inline">\(q(x)\)</span> 是凸函数. 利用 Jensen 不等式得 <span class="math display">\[\begin{equation*}
\begin{aligned}
    \sum_{j=1}^{m}t_j\log(t_j)&amp;\ge m\cdot \frac{1}{m}\sum_{j=1}^{m}t_j\cdot \log\left(\frac{1}{m}\sum_{j=1}^{m}t_j\right)\\
&amp;=\left(\sum_{j=1}^{m}t_j\right)\cdot \log\left(\frac{1}{m}\sum_{j=1}^{m}t_j\right).
\end{aligned}
\end{equation*}\]</span> 因此, 可以得出: <span class="math inline">\(\log\left(\frac{\prod_{j=1}^{m}t_j^{t_j/T_m}}{\overline{T}_m}\right)\ge 0\)</span>.</p>
</section>
<section id="三种后验抽样方法" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="三种后验抽样方法">三种后验抽样方法</h4>

</section>
<section id="定理-thm-itr2025-th3-的证明" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="定理-thm-itr2025-th3-的证明">定理 <a href="#thm-ITR2025-th3" class="quarto-xref"><span>3.2</span></a> 的证明</h4>
<p>基于似然函数 <span class="math inline">\(\eqref{like2}\)</span> 和先验 <span class="math inline">\(\eqref{con2}\)</span>, <span class="math inline">\((\alpha,\beta_1,\dots,\beta_n)^{'}\)</span> 的联合后验密度为 <span class="math display">\[\begin{align}\label{post2}
    \pi(\alpha,\beta_1,\dots,\beta_n \mid \bm{y})&amp;\propto    L( \bm{y} \mid \alpha,\beta_1,\dots,\beta_n)\pi(\alpha,\beta_1,\dots,\beta_n)\nonumber\\
    &amp; \propto \dfrac{\bar{\beta}_{g}^{(mn+\delta_1)l\alpha}\bar{y}_{g(m)}^{mnl\alpha}\omega^{\delta_1 l\alpha}}{\left[\Gamma(l\alpha)\right]^{mn+\delta_1}}\exp\left\{-\sum_{i=1}^{n}\left(m\bar{y}_{i(m)}+\delta_2\lambda_i\right)\beta_i\right\}\nonumber\\
   &amp;\propto \dfrac{\left(\bar{\beta}_{g}\omega_{p(m)}\right)^{\delta_{1p(m)}l\alpha}}{\left[\Gamma(l\alpha)\right]^{\delta_{1p(m)}}}
   \exp\left\{-\sum_{i=1}^{n}\delta_{2p(m)}\lambda_{ip(m)}\beta_i\right\},
\end{align}\]</span> 其中 <span class="math display">\[\begin{align*}
\delta_{1p(m)}&amp;=mn+\delta_1,
\delta_{2p(m)}=m+\delta_2,
\omega_{p(m)}=\omega^{\frac{\delta_1}{\delta_{1p(m)}}}\bar{y}_{g(m)}^{\frac{mn}{\delta_{1p(m)}}},\\
\lambda_{ip(m)}&amp;=\frac{m}{\delta_{2p(m)}}\bar{y}_{i(m)}+\frac{\delta_2}{\delta_{2p(m)}}\lambda_i,
i=1,\dots,n.
\end{align*}\]</span> 因此, <span class="math inline">\(\pi(\alpha,\beta_1,\dots,\beta_n)\)</span> 和 <span class="math inline">\(\pi(\alpha,\beta_1,\dots,\beta_n \mid \bm{y})\)</span> 属于同一分布族.</p>
</section>
</section>
</section>
<section id="sec-VB-Gamma" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="sec-VB-Gamma"><span class="header-section-number">3.3</span> 重参化伽马过程的变分贝叶斯推断</h2>
<!-- 作者: 周世荣, 徐安察, 汤银才, 沈丽娟 -->
<!-- ## 摘要{.unnumbered} -->
<!-- 在可靠性\index{可靠性}工程领域, 伽马过程在建模退化过程方面起着重要作用. 然而, 从产品退化观测中提取寿命信息一直面临着无效的建模技术和低效的统计推断方法的问题. 为了解决这些挑战, 我们在本文中提出了一种带有随机效应的重参数化伽马过程. 与经典伽马过程相比, 所提出的模型具有更直观的物理解释. 此外, 该模型的统计推断可以通过变分贝叶斯\index{贝叶斯}算法方便地实现. 结合高斯-赫尔米特求积法和拉普拉斯近似, 该算法为所提出的模型提供了封闭形式的变分后验分布. 通过模拟结果, 本文展示了该方法在计算效率和估计精度方面相较于另外两种推断方法(期望最大化和蒙特卡罗马尔可夫链) 的优越性.  -->
<!-- 关键词: 变分贝叶斯\index{变分贝叶斯}方法、伽马过程、退化分析、拉普拉斯近似、高斯-赫尔米特求积.  -->
<!-- ### 简介{#sec-ITR2023-s1} -->
<!-- #### 背景 {#sec-ITR2023-s1-1} -->
<p>随着传感器技术的快速发展, 退化数据采集能力的提升与模型复杂度的增加对统计推断方法提出了双重挑战:<br>
一方面需处理高维异构数据, 另一方面需满足实时性计算需求. 传统MCMC方法虽为复杂退化模型提供了严格的贝叶斯推断框架, 但其存在三方面本质性局限<span class="citation" data-cites="zaidan2016gas">(<a href="references.html#ref-zaidan2016gas" role="doc-biblioref">Zaidan 等, 2016</a>)</span>:</p>
<ul>
<li>计算效率的维度诅咒: 即使采用高性能计算集群, 在处理中等规模数据集 ( 如<span class="math inline">\(n&gt;50\)</span>的异质退化轨迹) 时, 马尔可夫链的混合速度随参数维度呈指数级下降. 以双随机效应伽马模型为例, 单次迭代耗时可达<span class="math inline">\(O(nm^2)\)</span>量级, 导致实际工程场景中难以获得实时推断结果.</li>
<li>收敛诊断的主观依赖性: 预烧样本长度与抽样间隔的设定高度依赖经验性准则(如Gelman-Rubin统计量或自相关分析). 在退化建模中, 由于参数空间存在强相关性(如形状参数<span class="math inline">\(\alpha\)</span>与速率参数<span class="math inline">\(\beta\)</span>), 往往需要超过<span class="math inline">\(10^4\)</span>次迭代才能达到平稳分布, 显著增加计算资源消耗.</li>
<li>在线更新的结构性障碍: MCMC的批处理特性导致其无法利用增量数据实现递归更新. 当新增监测数据时, 需重新初始化并执行全链采样, 这种”推倒重来”的计算模式严重制约其在PHM系统中的应用.</li>
</ul>
<p>变分贝叶斯 (Variational Bayesian, VB) 方法通过将贝叶斯推断转化为优化问题, 利用易处理的代理分布近似真实的后验分布, 并以Kullback-Leibler (KL) 散度最小化为目标函数 <span class="citation" data-cites="jaakkola2000bayesian blei2017variational">(<a href="references.html#ref-blei2017variational" role="doc-biblioref">Blei 等, 2017</a>; <a href="references.html#ref-jaakkola2000bayesian" role="doc-biblioref">Jaakkola 等, 2000</a>)</span>. 相较于MCMC, VB方法在保持精度的同时显著提升计算效率(例如在双随机效应维纳模型中效率提升达87% <span class="citation" data-cites="zhou2020variational">(<a href="references.html#ref-zhou2020variational" role="doc-biblioref">Zhou 等, 2020</a>)</span>). 尽管VB方法在复杂模型中展现优势, 但在经典随机效应伽马退化模型中仍面临双重挑战:</p>
<ul>
<li>参数可解释性缺失: 传统模型通过尺度参数<span class="math inline">\(\beta\)</span>引入异质性效应, 但<span class="math inline">\(\beta\)</span>的统计意义(影响退化增量均值<span class="math inline">\(E[Y(t)]=\alpha t/\beta\)</span>)与工程认知(如退化速率、环境应力加速效应)缺乏直接对应, 导致先验分布设定与后验解释存在障碍.</li>
<li>数值稳定性缺陷: 由于伽马分布的共轭结构限制, 传统变分后验需通过数值积分处理随机效应, 这容易出现浮点溢出或精度丢失问题.</li>
</ul>
<p>针对上述问题, 本节提出重参数化伽马过程 (Reparametrized gamma process, RGa) 及相应的VB算法:</p>
<ul>
<li>提出了一种RGa模型, 它为模型参数赋予了明确的物理意义, 使得随机效应能够直接且清晰地融入模型, 同时影响退化过程的均值和波动性.</li>
<li>结合高斯-赫尔米特 (Gauss-Hermite, GH) 求积法<span class="citation" data-cites="liu1994note">(<a href="references.html#ref-liu1994note" role="doc-biblioref">Liu 等, 1994</a>)</span>和拉普拉斯近似<span class="citation" data-cites="azevedo1994laplace">(<a href="references.html#ref-azevedo1994laplace" role="doc-biblioref">Geisser 等, 1990</a>)</span>, 介绍了一种具有解析形式的VB推断方法. 同时还基于GH求积法计算的观测信息矩阵, 提出了一种构建区间估计的高效策略, 补充了VB在区间估计方面的局限性.</li>
</ul>
<p>本节结构如下: 第 <a href="#sec-ITR2023-s2" class="quarto-xref"><span> 3.3.1</span></a> 节将介绍重参数化伽马过程及产品寿命分布的推导. 第 <a href="#sec-ITR2023-s3" class="quarto-xref"><span> 3.3.2</span></a> 节将提出基于GH求积法和拉普拉斯近似的VB方法, 并详细介绍区间估计方法. 第 <a href="#sec-ITR2023-s4" class="quarto-xref"><span> 3.3.3</span></a> 节和第 <a href="#sec-ITR2023-s5" class="quarto-xref"><span> 3.3.4</span></a> 节将分别进行数值实验和案例研究, 以验证所提方法的有效性.</p>
<section id="sec-ITR2023-s2" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="sec-ITR2023-s2"><span class="header-section-number">3.3.1</span> 重参化伽马过程</h3>
<p>令 <span class="math inline">\(\{Y(t), t \geq 0\}\)</span> 表示系统性能的退化过程. 称<span class="math inline">\(\{Y(t), t \geq 0\}\)</span> 服从RGa过程, 若其满足以下性质: (i) <span class="math inline">\(Y(0)=0\)</span>; (ii) 对于任意的 <span class="math inline">\(0 \leq t_{i}\)</span>, <span class="math inline">\(i=1,\dots,4\)</span>, <span class="math inline">\(Y(t_{1}) - Y(t_{2})\)</span> 与 <span class="math inline">\(Y(t_{3}) - Y(t_{4})\)</span> 相互独立; (iii) 每个增量 <span class="math inline">\(\Delta Y(t) = Y(t)-Y(t+\Delta t)\)</span> 服从具有形状参数 <span class="math inline">\(\alpha \Delta t\)</span> 和尺度参数 <span class="math inline">\(\eta/\alpha\)</span> 的伽马分布, 记为 <span class="math inline">\(\textrm{Ga}(\alpha \Delta t, \eta/\alpha)\)</span>, 其中 <span class="math inline">\(\alpha&gt;0, \eta&gt;0\)</span>. 根据伽马分布的可加性, 可以推导出 <span class="math inline">\(Y(t)\sim \textrm{Ga}(\alpha t, \eta/\alpha)\)</span>, 其PDF为 <span class="math display">\[\begin{equation}\label{gammpdfx}
    p_{Y(t)}(y \mid \eta,\alpha) = \frac{1}{\Gamma(\alpha t)}\left(\frac{\eta}{\alpha}\right)^{-\alpha t} y^{\alpha t -1} e^{-\frac{\alpha y}{\eta}}.
\end{equation}\]</span> 可算出<span class="math inline">\(Y(t)\)</span>的均值、方差以及变异系数分别为<span class="math inline">\(\eta t\)</span>, <span class="math inline">\(\eta^2 t/\alpha\)</span>, 和<span class="math inline">\(1/\sqrt{\alpha t}\)</span>. 因此, 参数 <span class="math inline">\(\eta\)</span> 表示平均退化速率 (或斜率), 而参数 <span class="math inline">\(\alpha\)</span> 则量化总体样本退化过程的波动程度. 经典伽马过程的一个重要特性是其对退化均值和波动性的依赖性<span class="citation" data-cites="tsai2012optimal">(<a href="references.html#ref-tsai2012optimal" role="doc-biblioref">Tsai 等, 2012</a>)</span>. 正如 <span class="citation" data-cites="Ye2015">Ye 等 (<a href="references.html#ref-Ye2015" role="doc-biblioref">2015</a>)</span> 所讨论的, 这种依赖关系在建模时有助于提高拟合精度. 从均值和方差可知, 所提出的RGa过程保持了这一特性, 但参数的解释性更加清晰. <!--此外, 概率密度函数\eqref{gammpdfx}与广泛用于回归分析的伽马 分布具有相似的结构. 它们的主要区别在于, 前者的形状参数会随检测时间动态变化, 而后者的形状参数是固定的.--></p>
<p>在退化试验中, 由于材料内在差异性和操作环境的多样性, 同批次产品的性能退化路径可能存在差异. 为体现这种差异性, RGa 模型引入随机效应, 假设退化速率参数 <span class="math inline">\(\eta\)</span> 在不同单元间服从对数正态分布, 其PDF为 <span class="math display">\[\begin{equation}
\begin{aligned}
    p(\eta \mid \mu,\sigma^2) =&amp; \frac{1}{\eta \sigma \sqrt{2\pi}} e^{-\frac{(\ln (\eta) -\mu)^2}{2\sigma^2}},
\end{aligned} \label{lognorpdfx}
\end{equation}\]</span> 其中位置参数为 <span class="math inline">\(\mu \in (-\infty, \infty)\)</span>, 尺度参数为 <span class="math inline">\(\sigma &gt; 0\)</span>. 参数 <span class="math inline">\(\eta\)</span> 的均值和方差分别为 <span class="math inline">\(e^{\mu+\sigma^2/2}\)</span> 和 <span class="math inline">\(\left(e^{\sigma^2}-1\right)e^{2\mu+\sigma^2}\)</span>. 当有关于参数<span class="math inline">\(\eta\)</span>的先验信息时, 超参数<span class="math inline">\(\mu\)</span> 和 <span class="math inline">\(\sigma^2\)</span> 可以通过以下方式确定: <span class="math inline">\(\mu = \mathbb{E}_{\eta}[\ln(\eta)]\)</span>, <span class="math inline">\(\sigma^2 = \mathbb{E}_{\eta}[(\ln (\eta) - \mu)^2]\)</span> <span class="citation" data-cites="krishnamoorthy2016handbook">(<a href="references.html#ref-krishnamoorthy2016handbook" role="doc-biblioref">Krishnamoorthy, 2016</a>)</span>. 随机效应采用对数正态分布有如下理由:</p>
<ul>
<li>对数正态分布的定义域为正实数, 适用于单调递增且为正的退化量. 单调递减的退化过程可通过简单的数学变换处理为单调递增的形式.</li>
<li>对数正态分布属于一类偏态分布, 具有较高的灵活性. 在实例分析中, 该分布对两组真实数据中随机效应变量 <span class="math inline">\(\eta\)</span> 的经验估计具有良好的拟合效果.</li>
<li>在变分推断框架下, 假设 <span class="math inline">\(\eta\)</span> 服从对数正态分布时, 参数 <span class="math inline">\((\mu, \sigma^2)\)</span> 的联合变分后验分布很容易构造. 这一特性放宽了VB推断中参数完全独立的假设, 允许考虑 <span class="math inline">\((\mu, \sigma^2)\)</span> 之间的相关性. 若 <span class="math inline">\(\eta\)</span> 服从其他正实数域分布, 则参数 <span class="math inline">\((\mu, \sigma^2)\)</span> 的联合后验通常难以解析, 增加了推断复杂性.</li>
<li>相比经典伽马过程中通过尺度参数引入个体异质性的方式, RGa 模型中的随机效应设置针对退化速率, 更具物理意义.</li>
<li>所提模型的退化均值仅依赖于 <span class="math inline">\(\eta\)</span>, 而不受形状参数 <span class="math inline">\(\alpha\)</span> 的影响. 在VB推断中, 假设 <span class="math inline">\(\alpha\)</span> VB与 <span class="math inline">\((\mu, \sigma^2)\)</span> 独立有一定的合理性, 间接减少了由近似带来的信息损失.</li>
<li>在固定检测频率 <span class="math inline">\(\Delta t\)</span> 下, 包含对数正态随机效应的 RGa 模型结构与伽马对数正态模型<span class="citation" data-cites="turlapaty2020variational">(<a href="references.html#ref-turlapaty2020variational" role="doc-biblioref">Turlapaty, 2020</a>)</span>相似, 其在无线通信系统的建模中有广泛应用.</li>
</ul>
<p>基于带随机效应的RGa模型, 可得到<span class="math inline">\(Y(t)\)</span> 的边际PDF (见定理 <a href="#thm-ITR2023-th1" class="quarto-xref"><span>3.3</span></a>), 详细数学推导请参见本节附录 <a href="#sec-Append-3B" class="quarto-xref"><span> 3.3.5</span></a>.</p>
<div id="thm-ITR2023-th1" class="theorem">
<p><span class="theorem-title"><strong>定理 3.3</strong></span> <span class="math inline">\(Y(t)\)</span> 的边际PDF为 <span class="math display">\[\begin{equation}\label{ungamlnorpdfx2}
    p_{Y(t)}(y_{t} \mid \boldsymbol{\Theta}) =
        \frac{\alpha^{\alpha t} y_{t}^{\alpha t -1}}{\Gamma(\alpha t) \sqrt{\pi}} \int_{-\infty}^{+\infty} q(z,y_{t} \mid \boldsymbol{\Theta}) \exp(-z^2) \diff z,  
\end{equation}\]</span> 其中 <span class="math inline">\(q(z,y_{t} \mid \boldsymbol{\Theta}) = \exp\left \lbrace {-\alpha t(\mu + z\sqrt{2\sigma^2}) -\alpha y_{t} \exp{[-(\mu +z\sqrt{2\sigma^2})]}}\right \rbrace\)</span>.</p>
</div>
<p>在式 <span class="math inline">\(\eqref{ungamlnorpdfx2}\)</span> 中, 积分项难以直接解析计算, 因此需要采用数值方法进行近似. 不同与蒙特卡洛积分通过生成大量随机点来估计积分值, GH求积方法提供了一种高效的近似手段, 其通过选择最优的节点和权重, 能够精确计算特定阶数的多项式积分. 在计算效率和精度方面, GH求积法都远高于蒙特卡洛积分<span class="citation" data-cites="seo2017data">(<a href="references.html#ref-seo2017data" role="doc-biblioref">Seo 等, 2017</a>)</span>. 利用GH求积法, 式 <span class="math inline">\(\eqref{ungamlnorpdfx2}\)</span> 可数值近似为 <span class="math display">\[\begin{equation}\label{galnorGH}
    \int_{-\infty}^{+\infty} q(z,y_{t} \mid \boldsymbol{\Theta}) \exp(-z^2) \diff z \approx \sum_{l=1}^{L} w(z_{l}) q(z_{l},y_{t} \mid \boldsymbol{\Theta}),
\end{equation}\]</span> 其中<span class="math inline">\(z_{l}, l=1,\dots, L\)</span> 是 <span class="math inline">\(L\)</span> 阶Hermite多项式 <span class="math inline">\(H_{L}(z_{l})\)</span> 的根 <span class="citation" data-cites="davis2007methods">(<a href="references.html#ref-davis2007methods" role="doc-biblioref">Davis 等, 2007</a>)</span>, 其表达式为 <span class="math display">\[H_{L}(z_{l}) = L!\sum_{k=1}^{\lfloor\frac{L}{2}\rfloor}\frac{(-1)^{k}(2z_{l})^{L-2k}}{k!(L-2k)!},
\]</span> 而权重函数 <span class="math inline">\(w(z_{l})\)</span> (称为 GH 因子) 定义为 <span class="math inline">\(w(z_{l}) = (2^{n-1}n!\sqrt{\pi})(n^2(H_{L-1}(z_{l})))\)</span>. 图 <a href="#fig-fig:pdfyt" class="quarto-xref"><span>3.8</span></a> 展示了基于 GH近似的PDF <span class="math inline">\(\eqref{galnorGH}\)</span> 与四种不同情况下的经验PDF. 结果表明, GH 方法近似的PDF 在所有情况下均表现良好.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig:pdfyt" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig:pdfyt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="figures/Gamma/ITR2023/pdfyt.pdf" class="img-fluid quarto-figure quarto-figure-center" style="width:95.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig:pdfyt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.8: 不同设置下的 <span class="math inline">\(y_{t}\)</span> 的PDF.
</figcaption>
</figure>
</div>
</div>
</div>
<p>接下来对产品寿命分布进行分析. 设退化阈值为 <span class="math inline">\(\omega\)</span>, 产品寿命 <span class="math inline">\(T\)</span> 的CDF表示为 <span class="math display">\[\begin{align}\label{cdfgamlonr}
    F_{T}(t) = 1 - Pr(Y(t) \leq \omega)= \int_{\omega}^{\infty} p_{Y(t)}(y_{t} \mid \boldsymbol{\Theta}) \diff y_{t}.
\end{align}\]</span> 利用 <span class="math inline">\(p_{Y(t)}(y_{t} \mid \boldsymbol{\Theta})\)</span> 的精确近似, 式 <span class="math inline">\(\eqref{cdfgamlonr}\)</span> 可通过梯形积分法计算. 在每个检测点<span class="math inline">\(\tilde{t}\)</span>处, 定义 <span class="math inline">\(G(y \mid \tilde{t},\boldsymbol{\Theta})=\tilde{p}_{Y(\tilde{t})}(y_{\tilde{t}} \mid \boldsymbol{\Theta})\)</span>, 其中 <span class="math inline">\(\tilde{p}_{Y(\tilde{t})}(y_{\tilde{t}} \mid \boldsymbol{\Theta})\)</span> 是 <span class="math inline">\(p_{Y(t)}(y_{t} \mid \boldsymbol{\Theta})\)</span> 的GH积分近似. 随后, 使用 R 软件 <em>pracma</em> <span class="citation" data-cites="pracma2021">(<a href="references.html#ref-pracma2021" role="doc-biblioref">Borchers, 2019</a>)</span>包中的 <em>trapz()</em> 函数计算积分 <span class="math inline">\(\int_{\omega}^{\infty} G(y \mid \tilde{t},\boldsymbol{\Theta}) \diff y\)</span>, 该方法与梯形规则积分一致. 为验证积分效果, 图 <a href="#fig-fig:cdft" class="quarto-xref"><span>3.9</span></a> 比较了基于 GH 的积分框架与不同参数 <span class="math inline">\(\boldsymbol{\Theta}\)</span> 和退化阈值 <span class="math inline">\(\omega\)</span> 下寿命 <span class="math inline">\(T\)</span> 的 BS 分布近似. 结果显示, 两种方法几乎无差异.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig:cdft" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig:cdft-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="figures/Gamma/ITR2023/cdfT.pdf" class="img-fluid quarto-figure quarto-figure-center" style="width:95.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig:cdft-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.9: 不同设置下寿命 <span class="math inline">\(T\)</span> 的CDF.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-ITR2023-s3" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="sec-ITR2023-s3"><span class="header-section-number">3.3.2</span> 变分贝叶斯推断</h3>
<p>在退化试验中, 假设产品的性能特征具有递增的退化路径. 设 <span class="math inline">\(\mathbf{y}_{n}\)</span> 为第 <span class="math inline">\(n\)</span> 个样本的观测退化数据, 该样本在检测时间点 <span class="math inline">\(t_{n,m}\)</span> 处的观测值 <span class="math inline">\(y_{n,m}\)</span>, 其中 <span class="math inline">\(n=1,\dots,N\)</span>, <span class="math inline">\(m=1,\dots,M_{n}\)</span>, <span class="math inline">\(N\)</span> 表示样本量, <span class="math inline">\(M_{n}\)</span>为第 <span class="math inline">\(n\)</span> 个样本的测量次数. 为简化表示, 定义 <span class="math inline">\(\mathbf{y} = \{\mathbf{y}_{n}\}_{n=1}^{N}\)</span>, 其中 <span class="math inline">\(\mathbf{y}_{n}=\{y_{n,m}\}_{m=1}^{M_{n}}\)</span>. 假设 <span class="math inline">\(\mathbf{y}\)</span> 是来自RGa 过程 <span class="math inline">\(\{Y(t), t \geq 0\}\)</span> 的一组观测值. 定义增量 <span class="math inline">\(x_{n,m} = \Delta y_{n,m}=y_{n,m}-y_{n,m-1}\)</span>, 时间间隔 <span class="math inline">\(h_{nm} = \Delta t_{n,m}=t_{n,m}-t{n,m-1}\)</span>, 其中<span class="math inline">\(y_{n,0}=t_{n,0}=0\)</span>. 记<span class="math inline">\(\mathbf{x}_{n} = \{x_{n,m}\}_{m=1}^{M_{n}}\)</span>, <span class="math inline">\(\mathbf{x} = \{\mathbf{x}_{n}\}_{n=1}^{N}\)</span>. 为符号方便, 假设<span class="math inline">\(M_{n} = M\)</span>, <span class="math inline">\(h_{n,m}=h_{c}\)</span>, 即, 试验采用等间隔测量, 且所有样本的测量次数相同. 根据RGa过程的性质 (iii), 增量<span class="math inline">\(\mathbf{x}\)</span>相互独立, 且服从伽马分布. 在给定随机效应 <span class="math inline">\(\boldsymbol{\eta} = \{\eta_{n}\}_{n=1}^{N}\)</span> 时, 增量 <span class="math inline">\(x_{n,m}\)</span> 的条件PDF为 <span class="math display">\[\begin{equation}
\begin{aligned}
    p_{x \mid \eta_{n}}(x_{n,m} \mid \alpha h_{c}, \eta_{n}) = \frac{x_{n,m}^{\alpha h_{c}-1}}{\Gamma (\alpha h_{c})} \left(\frac{\eta_{n}}{\alpha}\right)^{-\alpha h_{c}}%\\\nonumber
    e^{-\frac{ \alpha x_{n,m}}{\eta_{n}}}.
\end{aligned}\label{gammpdf}
\end{equation}\]</span> 随机效应 <span class="math inline">\(\boldsymbol{\eta}\)</span>为独立同分布的对数正态分布, 其PDF为 <span class="math display">\[\begin{equation}\label{lognorpdf}
   p(\boldsymbol{\eta} \mid \mu,\sigma^2)=\prod_{n=1}^{N}  p(\eta_{n} \mid \mu,\sigma^2) = \prod_{n=1}^{N}\frac{1}{\eta_{n} \sigma \sqrt{2\pi}} e^{-\frac{(\ln(\eta_{n}) -\mu)^2}{2\sigma^2}}.
\end{equation}\]</span> 令 <span class="math inline">\(\boldsymbol{\Theta}=(\alpha, \mu, \sigma^2)\)</span>, 则 <span class="math inline">\((\boldsymbol{\eta}, \boldsymbol{\Theta})\)</span> 的联合后验分布为 <span class="math display">\[\begin{equation} \label{gamjointpdf}
  p(\boldsymbol{\eta}, \boldsymbol{\Theta} \mid \mathbf{x}) \propto \prod_{n=1}^{N}\left[p(\eta_{n} \mid \mu,\sigma^2)\prod_{m=1}^{M}p_{x \mid \eta}(x_{n,m} \mid \alpha h_{c}, \eta_{n})\right] p(\alpha)p(\mu,\sigma^2),
\end{equation}\]</span> 其中 <span class="math inline">\(p(\alpha)\)</span> 和 <span class="math inline">\(p(\mu,\sigma^2)\)</span> 分别是参数 <span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\((\mu,\sigma^2)\)</span> 的先验分布. 式 <span class="math inline">\(\eqref{gamjointpdf}\)</span> 中的先验设置隐含了以下假设: (i) 允许参数 <span class="math inline">\(\mu\)</span> 和 <span class="math inline">\(\sigma^2\)</span> 存在一定的相关性, 可选用二元分布作为其先验; (ii) 假设 <span class="math inline">\(\alpha\)</span> 与 <span class="math inline">\((\mu, \sigma^2)\)</span> 相互独立. 这一假设基于上一节中关于随机效应设置的讨论, 认为 <span class="math inline">\(\alpha\)</span> 主要描述形状参数的变化, 与刻画单元间异质性的参数 <span class="math inline">\((\mu, \sigma^2)\)</span> 无关.</p>
<section id="变分贝叶斯估计" class="level4" data-number="3.3.2.1">
<h4 data-number="3.3.2.1" class="anchored" data-anchor-id="变分贝叶斯估计"><span class="header-section-number">3.3.2.1</span> 变分贝叶斯估计</h4>
<p>由于式 <span class="math inline">\(\eqref{gamjointpdf}\)</span> 中参数的后验分布非常复杂, 直接进行统计推断较为困难, VB方法通过引入一组可处理的变分后验密度 (Variational posterior density, VPD) <span class="math inline">\(q(\boldsymbol{\Theta},\boldsymbol{\eta})\)</span> 来近似真实的后验密度 <span class="math inline">\(p(\boldsymbol{\eta}, \boldsymbol{\Theta} \mid \mathbf{x})\)</span>, 即 <span class="math inline">\(p(\boldsymbol{\eta}, \boldsymbol{\Theta} \mid \mathbf{x}) \approx q(\boldsymbol{\eta}, \boldsymbol{\Theta})\)</span>, 该近似可通过求解以下约束优化问题确定. <span class="math display">\[\begin{equation}\label{optim}
    q^{*}(\boldsymbol{\Theta},\boldsymbol{\eta}) = \mathop{\textrm{arg max}}\limits_{q(\boldsymbol{\Theta},\boldsymbol{\eta}) \in \mathcal{Q}} -F(q(\boldsymbol{\Theta},\boldsymbol{\eta})), s.t. \int q(\boldsymbol{\Theta},\boldsymbol{\eta}) d\boldsymbol{\Theta} d\boldsymbol{\eta} =1,
\end{equation}\]</span> 其中 <span class="math inline">\(F(q(\boldsymbol{\eta}, \boldsymbol{\Theta}))= E_{\boldsymbol{\Theta},\boldsymbol{\eta}}\log\left( \frac{q(\boldsymbol{\eta}, \boldsymbol{\Theta})}{p(\boldsymbol{\eta}, \boldsymbol{\Theta} \mid \mathbf{x})} \right)\)</span>, 即, <span class="math inline">\(q(\boldsymbol{\eta}, \boldsymbol{\Theta})\)</span>和 <span class="math inline">\(p(\boldsymbol{\eta}, \boldsymbol{\Theta} \mid \mathbf{x})\)</span>的Kullback-Liebler(KL) 散度. <span class="math inline">\(\mathcal{Q}\)</span> 表示所有潜在VPD的集合. 通常而言, 集合 <span class="math inline">\(\mathcal{Q}\)</span> 的选择直接决定了 VPD 的复杂性, 从而影响优化问题 <span class="math inline">\(\eqref{optim}\)</span> 的求解难度, 并进一步影响 VB 推断的计算效率. 因此, 合理选择 <span class="math inline">\(\mathcal{Q}\)</span> 至关重要, 它应足够简单, 以确保优化问题 <span class="math inline">\(\eqref{optim}\)</span> 可行, 同时又要具备足够的灵活性, 以准确逼近真实的后验分布. 一种常用的选择是均值场变分族 (Mean-field variational family, MFVF), 该方法假设模型参数之间相互独立, 或者在一定条件下表现出独立性. 在 MFVF下, 可以进一步假设:<br>
<span class="math display">\[\begin{equation}\label{gamfvf}
    q(\boldsymbol{\Theta},\boldsymbol{\eta}) = \prod_{n=1}^{N} q(\eta_{n}) q(\alpha) q(\mu,\sigma^2).
\end{equation}\]</span> 其中 <span class="math inline">\(q(\eta_{n})\)</span>、<span class="math inline">\(q(\alpha)\)</span> 和 <span class="math inline">\(q(\mu,\sigma^2)\)</span> 分别是 <span class="math inline">\(\eta_{n}\)</span>、<span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\((\mu,\sigma^2)\)</span> 的VPD. 该分解形式在降低计算复杂度的同时, 仍能有效逼近真实的后验分布. 将 MFVF <span class="math inline">\(\eqref{gamfvf}\)</span> 代入优化目标 <span class="math inline">\(\eqref{optim}\)</span> 中, 然后使用拉格朗日乘数法求解式<span class="math inline">\(\eqref{optim}\)</span>, 得到 <span class="math display">\[\begin{equation}\label{new_lg}
    F_{1}(q(\boldsymbol{\Theta},\boldsymbol{\eta}))=F(q(\boldsymbol{\Theta},\boldsymbol{\eta}))+\boldsymbol{\lambda}^{T} \left(\int (q(\boldsymbol{\Theta},\boldsymbol{\eta})-1) d\boldsymbol{\Theta} d\boldsymbol{\eta}\right),
\end{equation}\]</span> 其中向量 <span class="math inline">\(\boldsymbol{\lambda}=(\left\{\lambda_{\eta_{n}}\right\}_{n=1}^{N},\lambda_{\alpha},\lambda_{\mu},\lambda_{\sigma^2})\)</span> 是拉格朗日乘数, 表示 <span class="math inline">\(q(\boldsymbol{\Theta},\boldsymbol{\eta})\)</span> 对目标函数的边际效应.</p>
<p>VB算法可视为传统EM方法和贝叶斯推断在计算时间和计算效率上的一种折中, 通过使用易处理的代理分布来近似复杂的贝叶斯后验. 它利用KL散度将贝叶斯推断转化为数值优化问题, 从随机模拟转向确定性优化. 如 <span class="citation" data-cites="blei2017variational">Blei 等 (<a href="references.html#ref-blei2017variational" role="doc-biblioref">2017</a>)</span> 所述, VB的优化分为两个迭代步骤: 针对潜在变量的VB后验更新 (变分贝叶斯期望 (VB-E) 步骤) 和针对目标参数的VB后验更新 (变分贝叶斯最大化 (VB-M) 步骤) , 与EM算法的迭代过程相似.</p>
<section id="vb-e-最优潜变量" class="level5" data-number="3.3.2.1.1">
<h5 data-number="3.3.2.1.1" class="anchored" data-anchor-id="vb-e-最优潜变量"><span class="header-section-number">3.3.2.1.1</span> VB-E: 最优潜变量</h5>
<p>对式 <span class="math inline">\(\eqref{new_lg}\)</span> 中关于 <span class="math inline">\(q(\boldsymbol{\eta})\)</span> 求导, 可以得到 <span class="math inline">\(\boldsymbol{\eta}\)</span> 的VPD的对数形式 <span class="math display">\[\begin{equation*}
\begin{aligned}
    \ln(q(\boldsymbol{\eta})) =&amp; \sum_{n=1}^{N}\mathbb{E}_{\mu,\sigma^2}\left[\ln(p_{\eta}(\eta_{n} \mid \mu,\sigma^2))\right] + \sum_{n=1}^{N}\sum_{m=1}^{M}\mathbb{E}_{\alpha}\left[p_{x \mid \eta}(x_{n,m} \mid \alpha h_{c}, \eta_{n})\right] + C,
\end{aligned}
\end{equation*}\]</span> 其中<span class="math inline">\(C\)</span>表示常数. 为简便符号, 本节后续内容涉及到常数都用<span class="math inline">\(C\)</span>来表示, 这不影响 各参数的VPD形式. 由独立性假设, <span class="math inline">\(\eta_{n}\)</span> 的VPD的对数形式为 <span class="math display">\[\begin{equation*}
\begin{aligned}
    \ln(q(\eta_{n})) =&amp; \mathbb{E}_{\mu,\sigma^2}\left[\ln(p_{\eta}(\eta_{n} \mid \mu,\sigma^2))\right] + \sum_{m=1}^{M}\mathbb{E}_{q(\alpha)}\left[p_{x \mid \eta}(x_{n,m} \mid \alpha h_{c}, \eta_{n})\right] + C.
\end{aligned}
\end{equation*}\]</span> 利用式 <span class="math inline">\(\eqref{gammpdf}\)</span> 和 <span class="math inline">\(\eqref{lognorpdf}\)</span>, 可以得到 <span class="math display">\[\begin{equation}
\begin{aligned}
    \ln(q(\eta_{n})) = &amp;(w_{1}w_{2} - w_{0}Mh_{c}-1) \ln(\eta_{n}) - \frac{y_{n,M}w_{0}}{\eta_{n}} - w_{2}(\ln(\eta_{n}))^2/2 +C,
\end{aligned}\label{vpdeta3}
\end{equation}\]</span> 其中<span class="math inline">\(y_{n,M} = \sum_{m=1}^{M} x_{n,m}\)</span>, <span class="math inline">\(w_{0} = \mathbb{E}_{\alpha}\left[\alpha\right]\)</span>, <span class="math inline">\(w_{1}=\mathbb{E}_{\mu,\sigma^2}\left[\mu\right]\)</span>, 以及 <span class="math inline">\(w_{2}=\mathbb{E}_{\mu,\sigma^2}\left[\sigma^{-2}\right]\)</span>. 则<span class="math inline">\(\eta_{n}\)</span> 的VPD可表示为 <span class="math inline">\(q(\eta_{n}) = g_{0}(\eta_{n})/A_{\eta_{n}}\)</span>, 其中 <span class="math display">\[
g_{0}(\eta_{n}) = \eta_{n}^{w_{1}w_{2} - w_{0}Mh_{c}-1} e^{- \frac{y_{n,M}w_{0}}{\eta_{n}}- \frac{w_{2}(\ln(\eta_{n}))^2}{2}},
\]</span> <span class="math inline">\(A_{\eta_{n}} = \int_{0}^{+\infty} g_{0}(\eta_{n}) \diff\eta_{n}\)</span>为正则化常数. 令 <span class="math inline">\(s = \ln(\eta_{n})\sqrt{w_{2}/2}\)</span>. 将 <span class="math inline">\(s\)</span> 代入 <span class="math inline">\(g_{0}(\eta_{n})\)</span> 得到 <span class="math display">\[\begin{equation}\label{g0etan}
    g_{0}(\eta_{n}) = q(s,y_{n,M} \mid w_{0},w_{1},w_{2})e^{-s^2},
\end{equation}\]</span> 其中 <span class="math display">\[\begin{equation*}
\begin{aligned}
    q(s,y_{n,M}&amp; \mid w_{0},w_{1},w_{2}) =\sqrt{2/w_{2}}e^{s\sqrt{2/w_{2}}(w_{1}w_{2}-w_{0}Mh_{c}) -e^{-y_{n,M}w_{0}s\sqrt{2/w_{2}}}}.
\end{aligned}
\end{equation*}\]</span> 注意到 <span class="math inline">\(g_{0}(\eta_{n})\)</span> 与式 <span class="math inline">\(\eqref{galnorGH}\)</span> 中的被积函数具有相同的结构. 因此, <span class="math inline">\(A_{\eta_{n}}\)</span> 也可以通过第 <a href="#sec-ITR2023-s2" class="quarto-xref"><span> 3.3.1</span></a> 节中介绍的GH求积方法来计算. 基于式 <span class="math inline">\(\eqref{vpdeta3}\)</span> 和 <span class="math inline">\(\eqref{g0etan}\)</span>, 任何连续函数 <span class="math inline">\(f(\eta_{n})\)</span> 的期望可以表示为 <span class="math display">\[\begin{align}
    \mathbb{E}_{\eta_{n}}(f(\eta_{n})) = &amp; \int_{0}^{+\infty} f(\eta_{n}) q(\eta_{n}) \diff \eta_{n}\nonumber\\ =&amp;\frac{1}{A_{\eta_{n}}}\int_{-\infty}^{+\infty} f(\exp(s\sqrt{2/w_{2}}))e^{-s^2} q(s,y_{n,M} \mid w_{0},w_{1},w_{2})\diff s,\label{meta}
\end{align}\]</span> 这一积分也可通过GH求积法进行数值计算.</p>
</section>
<section id="vb-m-最优模型参数" class="level5" data-number="3.3.2.1.2">
<h5 data-number="3.3.2.1.2" class="anchored" data-anchor-id="vb-m-最优模型参数"><span class="header-section-number">3.3.2.1.2</span> VB-M: 最优模型参数</h5>
<p>对式 <span class="math inline">\(\eqref{new_lg}\)</span> 中关于 <span class="math inline">\(q(\boldsymbol{\Theta})\)</span> 求导, 可以得到 <span class="math inline">\(\boldsymbol{\Theta}\)</span> 的VPD的对数形式为 <span class="math display">\[\begin{equation}\label{vpdotr}
    \begin{split}
        \ln(q(\alpha,\mu,\sigma^2)) =&amp; \sum_{n=1}^{N}\left[E_{\eta_{n}}\left[\ln(p(\eta_{n} \mid \mu,\sigma^2))\right]\right] \nonumber\\
        &amp;+
        \sum_{n=1}^{N}\sum_{m=1}^{M}\left[E_{q(\eta_{n})}\left[\ln(p(x_{n,m} \mid \eta_{n},\alpha))\right]\right] \nonumber\\
        &amp;+ \ln(p(\alpha)) + \ln(p(\mu,\sigma^2)) +C.
    \end{split}
\end{equation}\]</span> 可发现 <span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\((\mu,\sigma^2)\)</span>是相互独立的. 因此, 给定 <span class="math inline">\(q(\eta_{n}), n=1,2,\dots, N\)</span>后, 可以依次推导出 <span class="math inline">\(q(\alpha)\)</span> 和 <span class="math inline">\(q(\mu,\sigma^2)\)</span> 的VPD表达式.</p>
<ol type="i">
<li><p><span class="math inline">\(\alpha\)</span> 的VPD: <span class="math inline">\(\alpha\)</span> 的VPD的对数形式为 <span class="math display">\[\begin{equation}
  \begin{aligned}
  \ln(q(\alpha)) =&amp; \sum_{n=1}^{N}\sum_{m=1}^{M}\left[E_{q(\eta_{n})}\left[\ln(p(x_{n,m} \mid \eta_{n},\alpha))\right]\right] + \ln(p(\alpha)) + C.
  \end{aligned}\label{vpdalp0}
\end{equation}\]</span> 再将 <span class="math inline">\(\eqref{gammpdf}\)</span> 和 <span class="math inline">\(\eqref{lognorpdf}\)</span> 代入 <span class="math inline">\(\eqref{vpdalp0}\)</span>, 得到 <span class="math display">\[\begin{equation}
  \begin{aligned}
  \ln(q(\alpha)) = &amp;  - (h_{c}(Mw_{3}-w_{5}) + w_{4}) \alpha + \alpha h_{c} NM \ln(\alpha)\nonumber\\
    &amp;- NM \ln(\Gamma(\alpha h_{c})) + \ln(p(\alpha)) + C,
  \end{aligned}\label{vpdalp1}
\end{equation}\]</span> 其中 <span class="math display">\[
w_{3}=\sum_{n=1}^{N} E_{\eta_{n}}\left[\ln(\eta_{n})\right],
w_{4}= \sum_{n=1}^{N}y_{nM}E_{\eta_{n}}\left[\eta_{n}^{-1}\right],
w_{5}=\sum_{n=1}^{N}\sum_{m=1}^{M}\log(x_{nm}),
\]</span> 并且 <span class="math inline">\(E_{\eta_{n}}\left[\ln(\eta_{n})\right]\)</span> 和 <span class="math inline">\(E_{\eta_{n}}\left[\eta_{n}^{-1}\right]\)</span> 可以通过式 <span class="math inline">\(\eqref{meta}\)</span>更新. 对<span class="math inline">\(\eqref{vpdalp1}\)</span> 两边取指数变换, 可得到 <span class="math display">\[\begin{equation}\label{vpdalp2}
q(\alpha) \propto p(\alpha) \frac{\alpha^{a\alpha}}{\Gamma(\alpha h_{c})^b}\exp\left(-c\alpha\right),
\end{equation}\]</span> 其中 <span class="math inline">\(a = h_{c}NM\)</span>, <span class="math inline">\(b=NM\)</span>, <span class="math inline">\(c=h_{c}(Mw_{3}-w_{5})+w_{4}\)</span>. 为方便数学推导, 使用共轭先验可简化计算<span class="citation" data-cites="gelman2014bayesian">(<a href="references.html#ref-gelman2014bayesian" role="doc-biblioref">Gelman 等, 2014</a>)</span>. 可验证: 当先验<span class="math inline">\(p(\alpha)\)</span>取以下形式时, 其与 <span class="math inline">\(q(\alpha)\)</span>属于相同的分布族:<br>
<span class="math display">\[\begin{equation}\label{vpdalppri}
  p(\alpha) \propto \frac{\alpha^{a_{0}}}{\Gamma(\alpha h_{c})^{b_{0}}}\exp(-c_{0}\alpha),
\end{equation}\]</span> 其中 <span class="math inline">\(a_{0}\)</span>、<span class="math inline">\(b_{0}\)</span> 和 <span class="math inline">\(c_{0}\)</span> 是先验 <span class="math inline">\(p(\alpha)\)</span> 的超参数. 将 <span class="math inline">\(\eqref{vpdalppri}\)</span> 代入 <span class="math inline">\(\eqref{vpdalp2}\)</span> 并计算正则化常数, 可得 <span class="math display">\[\begin{equation}\label{vpdalppos}
q(\alpha) = g_{\alpha}(\alpha)/A_{\alpha}
\end{equation}\]</span> 其中 <span class="math display">\[
g_{\alpha}(\alpha) = \frac{\alpha^{a_{1}\alpha}}{\Gamma(\alpha h_{c})^{b_{1}}}\exp(-c_{1}\alpha),~~A_{\alpha} = \int_{\Omega_{\alpha}} g_{\alpha}(\alpha) \diff \alpha,
\]</span> <span class="math inline">\(a_{1}=a_{0}+a\)</span>, <span class="math inline">\(b_{1}=b_{0}+b\)</span>, <span class="math inline">\(c_{1}=c_{0}+c\)</span>. 然而, 由于 <span class="math inline">\(g_{\alpha}(\alpha)\)</span> 的积分可能在数值上不稳定, 通过 <span class="math inline">\(\eqref{vpdalppos}\)</span> 计算 <span class="math inline">\(\alpha\)</span> 的VPD的均值和方差比较困难. 作为替代方案, 可对 <span class="math inline">\(\eqref{vpdalppos}\)</span> 进行拉普拉斯近似. 此时, <span class="math inline">\(\alpha\)</span> 的VPD的均值和方差可近似为 <span class="math display">\[\begin{equation*}
  \begin{aligned}
m(\alpha) &amp;\approx \arg \min_{\alpha} \left\{a_{1}\log(\alpha)-b_{1} h_{c} \psi(\alpha h_{c}) + a_{1}-c_{1}\right\},\nonumber\\
v(\alpha) &amp;\approx \frac{1}{bh_{c}^{2}\psi'(m(\alpha) h_{c})- \frac{a_{1}}{m(\alpha)}}.
  \end{aligned}
\end{equation*}\]</span></p></li>
<li><p>参数 <span class="math inline">\((\mu,\sigma^2)\)</span>的联合VPD: 基于 <span class="math inline">\(\eqref{vpdotr}\)</span>, <span class="math inline">\((\mu, \sigma^2)\)</span> 的联合VPD的对数形式为 <span class="math display">\[\begin{equation}
  \begin{aligned}\label{vpdmu0}
\ln(q(\mu,\sigma^2)) =&amp; \sum_{n=1}^{N}\left[E_{q(\eta_{n})}\left[\ln(p(\eta_{n}|\mu,\sigma^2))\right]\right] + \ln(p(\mu,\sigma^2)) +C.
  \end{aligned}
\end{equation}\]</span> 将 <span class="math inline">\(\eqref{gammpdf}\)</span> 和<span class="math inline">\(\eqref{lognorpdf}\)</span>代入 <span class="math inline">\(\eqref{vpdmu0}\)</span> 并对结果取指数, 可得 <span class="math display">\[\begin{equation}
  \begin{aligned}
q(\mu,\sigma^2) \propto p(\mu,\sigma^2)(\sigma^{2})^{-N/2}%\nonumber\\
e^{- \frac{w_{6}-w_{3}^{2}/N}{2\sigma^2} - \frac{N(\mu-w_{3}/N)^2}{2\sigma^2}},
\end{aligned}\label{vpdmu1}
\end{equation}\]</span> 其中 <span class="math display">\[w_{6} = \sum_{n=1}^{N} E_{q(\eta_{n})}\left[(\ln(\eta_{n}))^2\right],
E_{\eta_{n}}\left[(\ln(\eta_{n}))^2\right]
\]</span> 可以通过式 <span class="math inline">\(\eqref{meta}\)</span> 计算. 若 <span class="math inline">\(p(\mu,\sigma^2)\)</span> 服从正态逆伽马 (Normal inverse gamma, NIGa) 分布, 式 <span class="math inline">\(\eqref{vpdmu1}\)</span> 恰好是NIGa密度函数的核 <span class="citation" data-cites="bolstad2016introduction">(<a href="references.html#ref-bolstad2016introduction" role="doc-biblioref">Bolstad 等, 2016</a>)</span>. 通常, 随机变量 <span class="math inline">\((X,Y)\)</span> 服从 <span class="math inline">\(\textrm{NIGa}((x,y); \rho, \varsigma, \nu, \xi)\)</span>, 其PDF为 : <span class="math display">\[\begin{equation}\label{niga}
  p(x,y) = \frac{\sqrt{\varsigma}}{\sqrt{y}\sqrt{2\pi}}\frac{\xi^{\nu}}{\Gamma(\nu)}y^{-\nu-1}e^{-\frac{2\xi + \varsigma (x-\rho)^2}{2y}},
\end{equation}\]</span> 其中 <span class="math inline">\(x \in (-\infty, +\infty)\)</span>, <span class="math inline">\(y \in (0, +\infty)\)</span>, <span class="math inline">\(\nu&gt;0\)</span>, <span class="math inline">\(\xi&gt;0\)</span>, <span class="math inline">\(\varsigma&gt;0\)</span>, 以及 <span class="math inline">\(\rho\in(-\infty, +\infty)\)</span> 是参数. 根据NIGa分布的定义 <span class="citation" data-cites="denison2002bayesian">(<a href="references.html#ref-denison2002bayesian" role="doc-biblioref">Denison 等, 2002</a>)</span>, <span class="math inline">\(\eqref{niga}\)</span> 可分解为在给定 <span class="math inline">\(\sigma^2\)</span> 条件下, <span class="math inline">\(\mu\)</span> 的均值为 <span class="math inline">\(\rho\)</span>、方差为 <span class="math inline">\(\sigma^2/\varsigma\)</span> 的条件正态分布和形状参数为 <span class="math inline">\(\nu\)</span>、尺度参数为 <span class="math inline">\(\xi\)</span> 的 <span class="math inline">\(\sigma^2\)</span> 的逆伽马分布. 因此, 可假设参数 <span class="math inline">\((\mu,\sigma^2)\)</span> 的联合先验为 <span class="math display">\[\begin{equation}\label{vpdmupri}
  p(\mu,\sigma^2) = \textrm{NIGa}((\mu,\sigma^2); \rho_{0}, \varsigma_{0}, \nu_{0}, \xi_{0}).
\end{equation}\]</span> 将式 <span class="math inline">\(\eqref{vpdmupri}\)</span> 代入 <span class="math inline">\(\eqref{vpdmu1}\)</span> 后, 可得到 <span class="math inline">\((\mu,\sigma^2)\)</span> 的联合VPD为 <span class="math display">\[\begin{equation}\label{vpdmupos}
  q(\mu,\sigma^2) = \textrm{NIGa}((\mu,\sigma^2);  \rho_{1}, \varsigma_{1}, \nu_{1}, \xi_{1}),
\end{equation}\]</span> 其中 <span class="math display">\[
\begin{aligned}
\rho_{1}&amp;=\frac{1}{\varsigma_{1}}\left[\varsigma_{0}\rho_{0}+w_{3}\right],
\varsigma_{1} = \varsigma_{0} + N,
\nu_{1} = \nu_{0} + \frac{N}{2},\\
\xi_{1} &amp;= \xi_{0} + \frac{1}{2}\left[\varsigma_{0}\rho_{0}^2+w_{6}-\varsigma_{1}\rho_{1}^2\right].
\end{aligned}
\]</span> 根据NIGa分布的性质 <span class="citation" data-cites="bolstad2016introduction">(<a href="references.html#ref-bolstad2016introduction" role="doc-biblioref">Bolstad 等, 2016</a>)</span>, <span class="math inline">\(\mu\)</span> 和 <span class="math inline">\(\sigma^2\)</span> 的VPD均值和方差为 <span class="math display">\[\begin{equation*}
  \begin{aligned}
m(\mu) =&amp;\rho_{1},~~~~v(\mu) = \frac{\xi_{1}}{\varsigma_{1}(\nu_{1}-1)},\nonumber\\
m(\sigma^2) =&amp; \frac{\xi_{1}}{\nu_{1}-1},~~~~
v(\sigma^2) = \frac{\xi_{1}^2}{(\nu_{1}-1)^2(\nu_{1}-2)},
  \end{aligned}
\end{equation*}\]</span> 并且 <span class="math inline">\(\sigma^{2}\)</span> 的一阶逆矩等于 <span class="math inline">\(\frac{\nu_{1}}{\xi_{1}}\)</span>.</p></li>
</ol>
<p>通过当前模型的VB-E和VB-M步的更新方程, 可对这两步进行迭代, 直到估计方差不再显著改善, 即 <span class="math display">\[\begin{equation}\label{differror}
  \varepsilon(\boldsymbol{\Theta^{(s)}})= ||v(\boldsymbol{\Theta}^{(s)})-v(\boldsymbol{\Theta}^{(s-1)})||_{1}\leq \varepsilon_{0},
\end{equation}\]</span> 其中 <span class="math inline">\(||\cdot||_{1}\)</span> 为绝对值范数, <span class="math inline">\(\varepsilon_{0}\)</span> 是确定所需精度的预设值.</p>
<p><strong>注5</strong>: VB算法是否成功与高效, 关键在于均值场变分族的假设和模型参数的共轭特性. 均值场变分族假设使得能够基于KL散度和拉格朗日优化算法求得近似贝叶斯后验分布. 共轭参数特性则提供了解析形式的近似贝叶斯后验. 对于非共轭模型参数, 也可以基于自然共轭先验通过拉普拉斯近似得到相应的变分后验. 这不仅减少了数值优化需求, 提高了计算效率, 而且在VB和贝叶斯后验中保持了结构的相似性, 从而提升了精度. 然而, 当模型参数如 <span class="math inline">\(\eta\)</span> 服从非共轭偏态分布时, 非共轭参数的增加则会降低模型的计算效率和精度.</p>
</section>
</section>
<section id="初始值确定" class="level4" data-number="3.3.2.2">
<h4 data-number="3.3.2.2" class="anchored" data-anchor-id="初始值确定"><span class="header-section-number">3.3.2.2</span> 初始值确定</h4>
<p>在VB算法中, 参数初始值的选择会影响算法的收敛时间及其局部最优解. 在本节中, 参数 <span class="math inline">\(\bm{\Theta}\)</span> 的初始值将通过以下步骤确定:</p>
<ol type="1">
<li><p>对于第<span class="math inline">\(n\)</span>个样品, 分别计算增量 <span class="math inline">\(\bm{X}_{n}\)</span> 的均值和方差为 <span class="math inline">\(\bar{x}_{n}=\frac{1}{M} \sum_{m=1}^{M} x_{n,m}\)</span> 和 <span class="math inline">\(V_{n} = \frac{1}{M-1} \sum_{m=1}^{M} (x_{n,m}-\bar{x}_{n})^2\)</span>.</p></li>
<li><p>由于增量 <span class="math inline">\(\bm{X}_{n}\)</span> 服从 <span class="math inline">\(Ga(\alpha h_{c}, \eta_{n}/\alpha)\)</span>, 其均值为 <span class="math inline">\(\eta_{n} h_{c}\)</span>, 方差为 <span class="math inline">\(\eta_{n}^2 h_{c}/\alpha\)</span>, 因此可估计 <span class="math inline">\(\eta_{n}\)</span> 和 <span class="math inline">\(\alpha\)</span> 为 <span class="math inline">\(\bar{x}_{n}/h_{c}\)</span> 和 <span class="math inline">\(\bar{x}_{n}^2/(V_{n} h_{c})\)</span>.</p></li>
<li><p>由 <span class="math inline">\(\{\eta_{n}\}_{n=1}^{N}\)</span>, 参数 <span class="math inline">\(\mu\)</span> 和 <span class="math inline">\(\sigma^2\)</span> 的初始值可以通过以下公式确定: <span class="math inline">\(\bar{\eta}_{n}=\frac{1}{N}\sum_{n=1}^{N} \ln(\eta_{n})\)</span> 和 <span class="math inline">\(V_{\ln(\eta_{n})} = \frac{1}{N-1}\sum_{n=1}^{N}(\ln(\eta_{n}) - \bar{\eta}_{n})^2\)</span>.</p></li>
</ol>
</section>
<section id="置信区间" class="level4" data-number="3.3.2.3">
<h4 data-number="3.3.2.3" class="anchored" data-anchor-id="置信区间"><span class="header-section-number">3.3.2.3</span> 置信区间</h4>
<p>通过上述VB推断方法, 可得到每个 <span class="math inline">\(\theta_{i}\in\boldsymbol{\Theta}\)</span> 的VPD均值 <span class="math inline">\(m(\theta_{i})\)</span> 和方差 <span class="math inline">\(v(\theta_{i})\)</span>. 然后构造 <span class="math inline">\(\theta_{i}\)</span> 的<span class="math inline">\(100(1-\gamma)%\)</span> 近似区间估计为 <span class="math display">\[\begin{equation}\label{ci1}
    m(\theta_{i}) \pm Z_{1-\gamma/2} \sqrt{v(\theta_{i})},
\end{equation}\]</span> 其中 <span class="math inline">\(Z_{\gamma}\)</span> 为标准正态分布的<span class="math inline">\(\gamma\)</span>分位数. 然而, 式 <span class="math inline">\(\eqref{ci1}\)</span> 存在不足, 因为VB方法通常会低估后验分布的散度, 从而导致方差估计值比真实值小 <span class="citation" data-cites="blei2017variational">(<a href="references.html#ref-blei2017variational" role="doc-biblioref">Blei 等, 2017</a>)</span>. 为了解决这个问题, <span class="citation" data-cites="wang2005inadequacy">Wang 等 (<a href="references.html#ref-wang2005inadequacy" role="doc-biblioref">2005</a>)</span> 对VB推断方法下的区间估计进行改进, 其中VPD的方差可通过原始似然函数下的Fisher信息矩阵计算. 当Fisher信息矩阵计算困难时, 则可进一步用观测Fisher信息矩阵替代 <span class="citation" data-cites="Meeker1998">(<a href="references.html#ref-Meeker1998" role="doc-biblioref">Meeker 等, 1998</a>)</span>. 基于此思想, 当前模型的观测Fisher信息矩阵为 <span class="math display">\[\begin{equation}\label{ci2}
    \hat{I}_{\boldsymbol{\Theta}} = -\frac{\partial^2 \log\left(\ell(\boldsymbol{\Theta})\right)}{\partial \boldsymbol{\Theta}^{T} \partial\boldsymbol{\Theta}},
\end{equation}\]</span> 其中 <span class="math display">\[\begin{equation*}
\begin{aligned}
    \ell(\boldsymbol{\Theta}) =&amp; - NM \log(\Gamma(\alpha h_{c})) -  NM \alpha h_{c} \log(\alpha) \nonumber\\
    &amp; + \sum_{n=1}^{N}\sum_{m=1}^{M} (\alpha h_{c}-1)\log(x_{n,m})-\frac{N}{2}\log(\pi)\nonumber\\
    &amp; + \sum_{n=1}^{N}\log\left[\int_{-\infty}^{\infty} q(z,y_{n,M},\boldsymbol{\Theta})\exp(-z^2)\diff z\right],
\end{aligned}
\end{equation*}\]</span> 其中 <span class="math inline">\(z=\frac{\log(\eta_{n}-\mu)}{\sqrt{2\sigma^2}}\)</span>, <span class="math display">\[\begin{align}\label{ci4}
  q(z,y_{n,M},\boldsymbol{\Theta}) = e^{-\alpha h_{c} M\left(\sqrt{2\sigma^2}z+\mu\right) -\alpha y_{n,M} e^{-\sqrt{2\sigma^2}z-\mu}},
\end{align}\]</span> 详细导数可见本节附录 <a href="#sec-Append-3B" class="quarto-xref"><span> 3.3.5</span></a>. 本节附录 <a href="#sec-Append-3B" class="quarto-xref"><span> 3.3.5</span></a> 还给出其他两种基准估计方法, 分别为EM算法和贝叶斯方法. 后续会在数值模拟和案例研究中与所提VB推断方法进行比较.</p>
</section>
</section>
<section id="sec-ITR2023-s4" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="sec-ITR2023-s4"><span class="header-section-number">3.3.3</span> 模拟实验</h3>
<p>模拟实验将验证 VB 算法的计算精度, 同时比较VB、EM 和 MCMC 三种算法的计算效率. 三种方法的基本设置如下:</p>
<ol type="1">
<li><em>VB 算法</em>: 先验分布 <span class="math inline">\(p(\alpha)\)</span> 和 <span class="math inline">\(p(\mu, \sigma^2)\)</span> 的超参数使用弱信息先验设定, 具体为 <span class="math inline">\(a_0 = b_0 = c_0 = 1\)</span>, <span class="math inline">\(\xi_0 = \varsigma_0 = \rho_0 = 1\)</span>, <span class="math inline">\(\nu_0 = 0\)</span>, 以便与 EM 算法进行公平比较.</li>
<li><em>EM 算法</em>: 采用最近两次迭代估计值的绝对值范数作为收敛停止准则.</li>
<li>MCMC 算法: 使用与 VB 相同的超参数设定, 后验采样中包含 3 条马尔科夫链, 每条链迭代 20,000 次, 前半部分作为燃烧期.</li>
<li><em>通用设置</em>: VB 和 EM 算法的目标精度为 <span class="math inline">\(10^{-6}\)</span>. 所有算法均通过 R 软件实现, 运行于 Windows 10 桌面电脑 (3.5 GHz Intel Xeon E3-1241 v3 处理器, 16 GB 内存) .</li>
</ol>
<p>样本量 <span class="math inline">\(N\)</span> 选为15、30和60, 对于每个<span class="math inline">\(N\)</span>, 测量次数 <span class="math inline">\(M=\)</span> 10和20. 对于每种 <span class="math inline">\((N, M)\)</span> 组合, 从参数 <span class="math inline">\(\boldsymbol{\Theta}=(\alpha, \mu, \sigma^2)=(10, -1, 0.01)\)</span> 的RGa过程中随机生成2,000个退化样本 <span class="math inline">\(\boldsymbol{y}\)</span>. 对每个样本 <span class="math inline">\(\boldsymbol{y}\)</span>, 通过VB、EM和MCMC算法获得 <span class="math inline">\(\boldsymbol{\Theta}\)</span> 的估计值. 因此, 每种算法均得到2,000个估计值. 基于这些估计值, 计算平均值和MSE. 结果列在表 <span class="math inline">\(\ref{tbl-tab:ns1}\)</span> 中. 同时还计算了每种算法的平均CPU运行时间(秒, <span class="math inline">\(\bar{t}\)</span>), 结果如图 <a href="#fig-fig:tims" class="quarto-xref"><span>3.10</span></a> 所示. 此外, 还计算了95%可信区间的覆盖率和区间长度 (Interval length, IL), 见表 <span class="math inline">\(\ref{tbl-tab:ns2}\)</span>. 从这两个表格和三种算法的平均CPU运行时间图中, 可以得出以下结果: (1) 所有情况下, 估计值的平均值接近真实值, 且样本量增加时, 平均值与真实值的差异逐渐缩小. (2) 随着样本量增加, 各模拟设置下的 MSE 总体呈下降趋势. VB 和 EM 的 MSE 小于贝叶斯方法, 且样本量增加时, 三者差距逐渐减小. (3) 所有算法的IL随样本量增加而缩小, 同时 基于VB 与贝叶斯方法的 IL 差异也逐渐减小. (4) 在覆盖率方面, VB 略优于 EM, 表现出更接近 0.95 的名义水平, 而贝叶斯方法在小样本 (如 <span class="math inline">\(N = 15, M = 10, 20\)</span>) 时表现最佳. (5) 在计算效率上, VB 显著优于 EM 和贝叶斯方法, 部分情况下运行时间仅为贝叶斯方法的百分之一或千分之一. 总体而言, 贝叶斯方法提供最高的估计精度, 但计算效率低; 三种算法的估计精度随样本量增加而提高; EM 提高了效率, 但牺牲了部分精度; VB 在精度与效率之间实现了良好平衡, 是贝叶斯与 EM 方法的折中方案.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig:tims" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig:tims-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="figures/Gamma/ITR2023/tims.pdf" class="img-fluid quarto-figure quarto-figure-center" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig:tims-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.10: 在不同算法和样本量下的平均CPU运行时间.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-ITR2023-s5" class="level3" data-number="3.3.4">
<h3 data-number="3.3.4" class="anchored" data-anchor-id="sec-ITR2023-s5"><span class="header-section-number">3.3.4</span> 实例分析</h3>
<section id="sec-ITR2023-s5-1" class="level4" data-number="3.3.4.1">
<h4 data-number="3.3.4.1" class="anchored" data-anchor-id="sec-ITR2023-s5-1"><span class="header-section-number">3.3.4.1</span> 激光退化数据</h4>
<!-- 砷化镓(GaAs) 激光数据 [@Meeker1998] 被用来说明所提出的RGa退化模型, 并验证所开发的VB算法. 激光器的工作电流被用作退化特征, 其在激光器的寿命过程中呈现出上升趋势, 以维持恒定的光输出. 当激光器的工作电流超过某一临界水平时, 认为激光器发生了伪故障\index{故障}. 图 @fig-fig:laser1 显示了15个GaAs激光器样本的退化路径, 测量频率为每250小时一次, 直至在 $80^{\circ}$C 条件下达到4000小时.  -->
<p>以激光退化数据为例 (见图 <a href="01-intro.html#fig-fig:laser2" class="quarto-xref"><span>1.2</span></a> ) 进行分析. 拟合前需验证两个目标: 一是检查退化率的单元间变异性是否符合对数正态分布, 二是研究激光数据中 RGa 过程的形状参数与尺度参数的相关性. 为验证第一个目标, 计算经验估计量 <span class="math inline">\(\hat{\boldsymbol{\eta}} = \{{\hat{\eta}_n = y_{nM} / t_{nM}}\}_{n=1}^{15}\)</span>, 并利用式 <span class="math inline">\(\eqref{lognorpdfx}\)</span> 估计对数正态分布的参数, 得到 <span class="math inline">\(\hat{\boldsymbol{\eta}} \sim LN(-0.697, 0.045)\)</span>. 图 <a href="#fig-cs1-1" class="quarto-xref"><span>3.11 (a)</span></a> 展示了带 95% CI 的经验分布函数 和估计的对数正态分布, 表明退化率 <span class="math inline">\(\hat{\boldsymbol{\eta}}\)</span> 符合对数正态分布的特征. 此外, 通过Anderson-Darling 检验得到的P值为0.633, 进一步说明使用对数正态分布的合理性. 在研究RGa过程形状参数与尺度参数的相关性时, 定义经验估计量为 <span class="math display">\[
\hat{\boldsymbol{\alpha}},\hat{\boldsymbol{\beta}}=\left\{\hat{\alpha}_{n}=\frac{\hat{\eta}_{n}^2}{v(\boldsymbol{x}_{n}/\sqrt{h_{c}})}, \hat{\beta}_{n}=\frac{\hat{\eta}_{n}}{\hat{\alpha}_{n}} \right\}_{n=1}^{15}.
\]</span> 图 <a href="#fig-cs1-2" class="quarto-xref"><span>3.11 (b)</span></a> 展示了 <span class="math inline">\(\hat{\boldsymbol{\alpha}}^{-1}\)</span> 和 <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> 的散点分布情况以及 回归曲线, 相关系数 <span class="math inline">\(\rho=0.958\)</span> 表明两者之间存在显著正相关性.</p>
<div id="fig-fig:cs1" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig:cs1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fig:cs1" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-cs1-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-cs1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="figures/Gamma/ITR2023/cs1.pdf" class="img-fluid" data-ref-parent="fig-fig:cs1">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-cs1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) 估计CDF
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fig:cs1" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-cs1-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-cs1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="figures/Gamma/ITR2023/cs2.pdf" class="img-fluid" data-ref-parent="fig-fig:cs1">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-cs1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) 形状参数与尺度参数的关系
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig:cs1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.11: 模型验证相关结果.
</figcaption>
</figure>
</div>
<p>接下来, 采用 VB 算法对 RGa 退化模型进行拟合, 并将其应用于激光数据集, 同时并与 EM 和贝叶斯方法进行比较, 以衡量计算效率和拟合精度. 表 <span class="math inline">\(\ref{tbl-tab:addlabel}\)</span> 展示了各算法的参数估计值、95% 区间估计以及运行时间. 结果显示, 不同算法的参数估计值相近, 但 VB 算法在 CPU 运行时间上显著优于 EM 算法, 且远低于贝叶斯算法. 图 <a href="#fig-fig:pdf" class="quarto-xref"><span>3.12 (a)</span></a> 显示了样本平均值、估计的平均退化路径 (<span class="math inline">\(\hat{\eta} t\)</span>) 以及各算法的 95% 区间估计, 表明所有算法均能有效地拟合样本平均值.</p>
<p>本文提出的模型还与五个基准模型进行了比较,包括伽马过程、逆高斯过程、维纳过程、具有随机效应的同质伽马过程和 <span class="citation" data-cites="tsai2012optimal">Tsai 等 (<a href="references.html#ref-tsai2012optimal" role="doc-biblioref">2012</a>)</span> 所提的RGa过程. 为简化表述, 将本文提出的随机效应伽马过程模型记为 RGaLn, <span class="citation" data-cites="tsai2012optimal">Tsai 等 (<a href="references.html#ref-tsai2012optimal" role="doc-biblioref">2012</a>)</span> 的模型记为 GaGa. 鉴于 EM 和 VB 算法在估计结果上无显著差异, 模型选择基于 EM 算法的结果. 同时 VB 算法作为一种确定性近似方法, 不适用于计算涉及有效样本数量的 BIC, 因此使用 AIC 准则进行评估. 表 <span class="math inline">\(\ref{tbl-tab:addlabe2}\)</span> 列出了各模型的 AIC 值, 显示随机效应模型 (GaGa 和 RGaLn) 的 AIC 值低于其他模型, 表明在激光退化数据中考虑随机效应是合理的. 然而, RGaLn 和 GaGa 的 AIC 值差异不显著. 图 <a href="#fig-fig:cdfkm" class="quarto-xref"><span>3.12 (b)</span></a> 展示了经验 分布函数, 以及阈值 <span class="math inline">\(\omega=6\)</span> 下 基于GaGa 和 RGaLn 模型的产品寿命分布. 经验分布函数通过中位数秩估计对伪失效时间进行非参数估计<span class="citation" data-cites="Meeker1998">(<a href="references.html#ref-Meeker1998" role="doc-biblioref">Meeker 等, 1998</a>)</span>. 可以看出, GaGa 和 RGaLn 模型均能很好地拟合经验分布函数.</p>
<div id="fig-fig:gamma-ft-com" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig:gamma-ft-com-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fig:gamma-ft-com" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-fig:pdf" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fig:pdf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="figures/Gamma/ITR2023/path.pdf" class="img-fluid" data-ref-parent="fig-fig:gamma-ft-com">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fig:pdf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) 平均退化路径估计
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fig:gamma-ft-com" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-fig:cdfkm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fig:cdfkm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="figures/Gamma/ITR2023/cdfkm.pdf" class="img-fluid" data-ref-parent="fig-fig:gamma-ft-com">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fig:cdfkm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) 寿命估计CDF
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig:gamma-ft-com-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.12: 激光数据下寿命分布相关结果.
</figcaption>
</figure>
</div>
</section>
<section id="sec-ITR2023-s5-2" class="level4" data-number="3.3.4.2">
<h4 data-number="3.3.4.2" class="anchored" data-anchor-id="sec-ITR2023-s5-2"><span class="header-section-number">3.3.4.2</span> 设备-B数据</h4>
<p>这里以 7 个设备-B 的退化数据为例 (见图 <a href="01-intro.html#fig-fig:deviceB" class="quarto-xref"><span>1.6</span></a> 中<span class="math inline">\(150^{\circ}\)</span>C条件下的7个设备-B样本) 进行分析. 图 <a href="#fig-devicebcs1-1" class="quarto-xref"><span>3.13 (a)</span></a> 显示了退化率 <span class="math inline">\(\boldsymbol{\hat{\eta}}\)</span> 的经验分布函数 及其 95% 置信区间, 以及拟合的对数正态分布. 结果表明, 对数正态分布能够很好地拟合退化率分布. 同时Anderson-Darling 检验的 <span class="math inline">\(P\)</span> 值为 0.883, 进一步验证用对数正态分布刻画样品间变异性的合理性. 图 <a href="#fig-devicebcs1-2" class="quarto-xref"><span>3.13 (b)</span></a> 显示了形状参数与尺度参数倒数的回归线及其相关系数 <span class="math inline">\(\rho\)</span>, 结果表明两者之间存在显著的正相关关系.</p>
<p>随后采用 VB、EM 和贝叶斯方法对设备-B 数据进行拟合, 并使用所提 RGa 退化模型进行分析. 拟合结果汇总于表 <span class="math inline">\(\ref{tbl-tab:addlabe3}\)</span>. 从表中可以看出, VB 方法在计算效率上显著优于其他方法, 同时在精度方面表现良好. 图 <a href="#fig-fig:devicebpdf" class="quarto-xref"><span>3.14 (a)</span></a> 展示了样本平均值及每种算法的估计平均退化路径 (<span class="math inline">\(\hat{\eta} t\)</span>) . 可以看出, 各算法的估计平均退化路径均能很好地拟合样本平均值.</p>
<div id="fig-fig:devicebcs1" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig:devicebcs1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fig:devicebcs1" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-devicebcs1-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-devicebcs1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="figures/Gamma/ITR2023/devicebcs1.pdf" class="img-fluid" data-ref-parent="fig-fig:devicebcs1">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-devicebcs1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) 估计CDF
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fig:devicebcs1" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-devicebcs1-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-devicebcs1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="figures/Gamma/ITR2023/devicebcs2.pdf" class="img-fluid" data-ref-parent="fig-fig:devicebcs1">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-devicebcs1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) 形状参数与尺度参数的关系
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig:devicebcs1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.13: 模型验证相关结果.
</figcaption>
</figure>
</div>
<p>接下来, 将设备-B数据分别用五种基准模型拟合, 其对数似然值和 AIC 值列于表 <span class="math inline">\(\ref{tbl-tab:addlabel4}\)</span>. 结果显示, 提出的 RGaLn 模型在所有候选模型中具有最小的AIC值, 可认为是最优模型. 图 <a href="#fig-fig:devicebcdfkm" class="quarto-xref"><span>3.14 (b)</span></a> 中展示了经验分布函数以及退化阈值 <span class="math inline">\(\omega = 0.3\)</span> 下基于 GaGa 和 RGaLn 模型估计的寿命分布. 结果表明, RGaLn 模型的拟合效果显著优于 GaGa 模型.</p>
<div id="fig-fig:devicebcdf_com" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig:devicebcdf_com-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fig:devicebcdf_com" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-fig:devicebpdf" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fig:devicebpdf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="figures/Gamma/ITR2023/devicebpath.pdf" class="img-fluid" data-ref-parent="fig-fig:devicebcdf_com">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fig:devicebpdf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) 平均退化路径估计
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-fig:devicebcdf_com" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-fig:devicebcdfkm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-fig:devicebcdfkm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="figures/Gamma/ITR2023/devicebkm.pdf" class="img-fluid" data-ref-parent="fig-fig:devicebcdf_com">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-fig:devicebcdfkm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) 寿命估计CDF
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig:devicebcdf_com-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.14: 设备-B数据下寿命分布相关结果.
</figcaption>
</figure>
</div>
<!-- ### 总结 {#sec-ITR2023-s6} -->
<!-- 本文提出了一种重参数化的伽马退化模型, 该模型对参数具有清晰的物理解释, 并且保持了与传统伽马退化模型相同的退化均值和方差之间的依赖性, 且可以直接将随机效应引入退化率中. 但更重要的是, 随机效应部分中的形状参数和阻断参数被分离开, 这使得VB推断变得可行. 在VB算法的开发中, 利用GH求积来进行数值积分, 并采用拉普拉斯近似为形状参数难以处理的VPD提供闭式变分均值和方差. 考虑到VB方法区间估计的不足, 基于观测Fisher信息矩阵开发了一种调整后的区间估计. 数值实验展示了VB算法的计算效率和估计精度. 通过对激光退化数据和设备-B数据的分析, 结果表明所提出的伽马退化模型可以提供令人满意的拟合效果.  -->
<!-- 尽管VB算法已经在多个领域得到了广泛应用, 但在实际应用中仍面临许多挑战和局限性. 对于模型参数中的非共轭部分, 我们难以在平均场VB推断下获得参数的解析解. 此外, 当模型参数具有高维性或潜在变量之间的高度相关性时, 基于平均场VB方法难以获得令人满意的估计精度. 例如, 对于带有随机效应的传统伽马过程退化模型 [@tsai2012optimal], 随机效应部分的参数无法获得解析的VB解. 尽管Stan [@carpenter2017stan] 将VB算法整合到了工程应用中, 但它直接用多元正态分布\index{正态分布}来近似目标模型参数. 当模型参数具有偏态分布时, 参数估计会存在较大的偏差. 为了解决VB算法在应用中的这些局限性, 我们提出了一种替代的VB推断策略. 在平均场变分推断中, 我们假设模型参数是阻断独立的, 尽可能保留参数之间的相关性. 然后, 我们对模型参数的共轭部分进行VB推断, 这不仅可以获得共轭部分的参数解析解, 还能降低模型参数的维度. 最后, 我们基于其他近似贝叶斯\index{贝叶斯}方法对非共轭部分进行近似推断.  -->
<!-- 未来的研究中, 我们可能关注以下三个方面. 首先是考虑带有协变量的加速退化模型及其对应的VB算法. 其次, 针对具有测量误差\index{测量误差}的RGa模型进行快速贝叶斯\index{贝叶斯}推断是一个值得深入研究的挑战. 最后也是最重要的, 非线性退化路径在实际中很常见, 探索非齐次RGa模型的快速贝叶斯\index{贝叶斯}推断将是一个重要的研究方向.  -->
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="sec-Append-3B" class="level3" data-number="3.3.5">
<h3 data-number="3.3.5" class="anchored" data-anchor-id="sec-Append-3B"><span class="header-section-number">3.3.5</span> 附录</h3>
<!-- {.unnumbered} -->
<section id="定理-thm-itr2023-th1-证明" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="定理-thm-itr2023-th1-证明">定理 <a href="#thm-ITR2023-th1" class="quarto-xref"><span>3.3</span></a> 证明</h4>
<p>根据式<span class="math inline">\(\eqref{gammpdfx}\)</span>和<span class="math inline">\(\eqref{lognorpdfx}\)</span>, <span class="math inline">\(Y(t)\)</span> 和 <span class="math inline">\(\eta\)</span> 的联合PDF可表示为 <span class="math display">\[\begin{equation}
\begin{aligned}     
p_{Y(t),\eta}(y_{t},\eta \mid \boldsymbol{\Theta}) = p_{Y(t)}(y_{t} \mid \eta,\alpha)p(\eta \mid \mu,\sigma^2),
\end{aligned}
\label{gamlnorpdfx}
\end{equation}\]</span> 其中<span class="math inline">\(\boldsymbol{\Theta} = (\alpha, \mu, \sigma^2)\)</span>. 接下来, 对式 <span class="math inline">\(\eqref{gamlnorpdfx}\)</span>关于<span class="math inline">\(\eta\)</span>求积分, 可得到 <span class="math inline">\(Y(t)\)</span> 的边际PDF:<br>
<span class="math display">\[\begin{equation*}
\begin{aligned}     
p_{Y(t)}(y_{t} \mid \boldsymbol{\Theta}) =&amp; \frac{\alpha^{\alpha t y_{t}^{\alpha t -1}}}{\Gamma(\alpha t) \sqrt{2\pi}\sigma} \int_{0}^{+\infty} \eta^{-\alpha t -1} e^{-\frac{\alpha y_{t}}{\eta}-\frac{(\ln(\eta) -\mu)^2}{2\sigma^2}} \diff\eta.
\end{aligned}
\end{equation*}\]</span><br>
由于积分函数的复杂性和积分区域的约束, 这一积分的求解可能会导致数值不稳定的结果. 可通过重参数化或变量变换 <span class="math inline">\(z = (\log(\eta)-\mu)/\sqrt{2\sigma^2}\)</span>, 从而得到 <span class="math display">\[\begin{equation}\label{ungamlnorpdfx1}
    p_{Y(t)}(y_{t} \mid \boldsymbol{\Theta}) =
        \frac{\alpha^{\alpha t} y_{t}^{\alpha t -1}}{\Gamma(\alpha t) \sqrt{\pi}} \int_{-\infty}^{+\infty} q(z,y_{t} \mid \boldsymbol{\Theta}) e^{-z^2} \diff z,  
\end{equation}\]</span> 其中 <span class="math display">\[
q(z,y_{t} \mid \boldsymbol{\Theta}) = \exp\left[-\alpha t(\mu + z\sqrt{2\sigma^2}) -\alpha y_{t} e^{-(\mu +z\sqrt{2\sigma^2})}\right].\]</span></p>
</section>
<section id="观测-fisher-信息矩阵" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="观测-fisher-信息矩阵">观测 Fisher 信息矩阵</h4>
<p>基于对数似然函数, 对<span class="math inline">\(\ell(\boldsymbol{\Theta})\)</span>关于 <span class="math inline">\(\boldsymbol{\Theta}\)</span> 中每个参数求一阶导数可得 <span class="math display">\[\begin{align*}
  \frac{\partial \ell(\boldsymbol{\Theta})}{\partial \alpha} =&amp; - NM h_{c}(\psi(\alpha h_{c})+\log(\alpha)+1) + \sum_{n=1}^{N}\sum_{m=1}^{M} h_{c}\log(x_{n,m}) + \sum_{n=1}^{N}A_{n}(\alpha),\nonumber\\
  \frac{\partial \ell(\boldsymbol{\Theta})}{\partial \theta_{d}}=&amp; \sum_{n=1}^{N}A_{n}(\theta_{d}),
\end{align*}\]</span> 其中 <span class="math display">\[
A_{n}(s) = \frac{\int_{-\infty}^{\infty} \frac{\partial q(z,y_{n,M},\boldsymbol{\Theta})}{\partial s}\exp(-z^2)\diff z}{\int_{-\infty}^{\infty} q(z,y_{n,M},\boldsymbol{\Theta})\exp(-z^2)\diff z},
\theta_{d}\in\{\mu,\sigma^2\}.
\]</span> <span class="math inline">\(q(z,y_{n,M},\boldsymbol{\Theta})\)</span> 中每个元素的一阶导数为 <span class="math display">\[\begin{align*}
    \frac{\partial q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \alpha} &amp;= q(z,y_{n,M},\boldsymbol{\Theta})\cdot \log\left(q(z,y_{n,M},\boldsymbol{\Theta})\right)\cdot \alpha^{-1},\nonumber\\
    \frac{\partial q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \mu} &amp;= q(z,y_{n,M},\boldsymbol{\Theta})\cdot\left( -\log\left(q(z,y_{n,M},\boldsymbol{\Theta})\right) -\alpha M h_{c}\left(\sqrt{2\sigma^2}z+\mu+1\right)\right) ,\nonumber\\
    \frac{\partial q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \sigma^2} &amp;= \frac{\partial q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \mu}\cdot \frac{z}{\sqrt{2\sigma^2}} .\nonumber\\
\end{align*}\]</span> 接下来, 对<span class="math inline">\(\ell(\boldsymbol{\Theta})\)</span>关于 <span class="math inline">\(\boldsymbol{\Theta}\)</span>求二阶偏导数可得 <span class="math display">\[\begin{align*}
  \frac{\partial \ell(\boldsymbol{\Theta})}{\partial \alpha^2} &amp; = - NM h_{c}(h_{c}\psi'(\alpha h_{c})+1/\alpha)%\\
  +\sum_{n=1}^{N} \left[B_{n}(\alpha,\alpha) + A_{n}(\alpha)^2\right], \nonumber\\
  \frac{\partial \ell(\boldsymbol{\Theta})}{\partial \theta_{d}\partial \theta_{s}}&amp;=\sum_{n=1}^{N} \left[B_{n}(\theta_{d},\theta_{s}) - A_{n}(\theta_{d})A_{n}(\theta_{s})\right],
\end{align*}\]</span> 其中 <span class="math display">\[B_{n}(s_{1},s_{2})=\frac{\int_{-\infty}^{\infty} \frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial s_{1} \partial s_{2}}\exp(-z^2)\diff z}{\int_{-\infty}^{\infty} q(z,y_{n,M},\boldsymbol{\Theta})\exp(-z^2)\diff z},
\theta_{d},\theta_{s}\in\boldsymbol{\Theta},
(\theta_{d},\theta_{s})\neq (\alpha, \alpha).
\]</span> <span class="math inline">\(q(z,y_{n,M},\boldsymbol{\Theta})\)</span> 对 <span class="math inline">\(\boldsymbol{\Theta}\)</span> 中每个元素的二阶导数为 <span class="math display">\[\begin{align*}
    \frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \alpha^2} &amp;= \frac{\partial q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \alpha}\cdot \log\left(q(z,y_{n,M},\boldsymbol{\Theta})\right)\cdot \alpha^{-1},\nonumber\\
  \frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \alpha \partial \mu} &amp;= \frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \mu \partial \alpha} = \left(\log\left(q(z,y_{n,M},\boldsymbol{\Theta})\right)+  1  \right)\times\frac{\partial q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \mu} \cdot\alpha^{-1},\nonumber \\
  \frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \alpha \partial \sigma^2} &amp; = \frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \sigma^2\partial \alpha }
  =\frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \alpha \partial \mu}\cdot \frac{z}{\sqrt{2\sigma^2}},\\
  \frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \mu^2} &amp;= \frac{\partial q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \mu}\left(-\log\left(q(z,y_{n,M},\boldsymbol{\Theta})\right) -\alpha M h_{c} \left(\sqrt{2\sigma^2}z+\mu+1\right)-1\right)\\
  &amp;-q(z,y_{n,M},\boldsymbol{\Theta})\cdot \alpha M h_{c},\nonumber\\
  \frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \mu \partial \sigma^2} &amp; = \frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \sigma^2 \partial \mu} %\\
  = \frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \mu^2} \cdot \frac{z}{\sqrt{2\sigma^2}},\nonumber\\
  \frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial (\sigma^2)^2}  &amp;=
  \left(\frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \mu \partial \sigma^2} -\frac{\partial q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \mu} \cdot \frac{1}{2\sigma^2}\right)\times \frac{z}{\sqrt{2\sigma^2}}.
\end{align*}\]</span> 上述推导过程表明, 对式 <span class="math inline">\(\eqref{ci2}\)</span> 进行数值计算并不困难. 首先, 式 <span class="math inline">\(\eqref{ci2}\)</span> 中涉及的所有积分项都具有GH求积的结构. 其次, <span class="math inline">\(\eqref{ci2}\)</span> 中的二阶偏导数项可以通过 <span class="math inline">\(\eqref{ci4}\)</span> 转化为简单的算术运算, 这些也可以通过GH求积计算. 计算式 <span class="math inline">\(\eqref{ci2}\)</span> 仅涉及一个低维的3x3矩阵的求逆运算, 这可以通过多种成熟的集成算法完成, 例如R软件中的<em>solve()</em>函数. 在实际操作中, 由于计算精度溢出可能导致矩阵求逆的误差, 这种情况可以通过将参数间的协方差设定为较小值来处理.</p>
</section>
<section id="基准估计方法" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="基准估计方法">基准估计方法</h4>
<p>EM算法通常用于对不可解析的似然函数求MLE, 特别是对于具有缺失数据的模型 <span class="citation" data-cites="mclachlan2007algorithm">(<a href="references.html#ref-mclachlan2007algorithm" role="doc-biblioref">McLachlan 等, 2007</a>)</span>. 对于所提伽马退化模型, 设隐变量 <span class="math inline">\(\boldsymbol{\eta}\)</span> 为缺失数据, 然后可以使用EM算法来获得 <span class="math inline">\(\boldsymbol{\Theta}\)</span> 的MLE, 其流程如下:</p>
<ol type="1">
<li><p><strong>E步</strong>: 给定第 <span class="math inline">\(s\)</span> 次迭代后的估计值 <span class="math inline">\(\boldsymbol{\Theta}^{(s)}\)</span>, 计算后续M步所需的 <span class="math inline">\(\eta_{n}\)</span> 的矩为 <span class="math display">\[\begin{equation}
  \begin{aligned}
E_{1n}^{(s)}&amp;=E_{q_{1}(\eta_{n})}[\ln(\eta_{n})]|_{\boldsymbol{\Theta}=\boldsymbol{\Theta^{(s)}}},\nonumber\\
E_{2n}^{(s)}&amp;=E_{q_{1}(\eta_{n})}[1/(\eta_{n})]|_{\boldsymbol{\Theta}=\boldsymbol{\Theta^{(s)}}},\\ E_{3n}^{(s)}&amp;=E_{q_{1}(\eta_{n})}[(\ln(\eta_{n}))^2]|_{\boldsymbol{\Theta}=\boldsymbol{\Theta^{(s)}}},\nonumber
  \end{aligned}\label{em1}
\end{equation}\]</span> 其中 <span class="math display">\[\begin{equation}
  \begin{aligned}
q_{1}(\eta_{n}) \propto&amp; \eta_{n}^{\mu^{(s)}/(\sigma^2)^{(s)}-\alpha^{(s)}Mh_{c}-1} e^{-\frac{\alpha^{(s)}y_{n,M}}{\eta_{n}}-\frac{(\ln(\eta_{n}))^2}{2(\sigma^2)^{(s)}}}.
  \end{aligned}\label{em2}
\end{equation}\]</span> 注意, 式 <span class="math inline">\(\eqref{em2}\)</span> 也可以转换为GH求积, 并用于在E步中计算 <span class="math inline">\(E_{dn}^{(s)}, d=1,2,3\)</span>.</p></li>
<li><p><strong>M步</strong>: 使用 <span class="math inline">\(E_{dn}^{(s)}, d=1,2,3\)</span> 更新参数 <span class="math inline">\(\boldsymbol{\Theta}\)</span> 为 <span class="math display">\[\begin{equation}
  \begin{aligned}
\alpha^{(s+1)} &amp;= \mathop{\textrm{arg min}}\limits_{\alpha \in \Omega_{\alpha}}\left\{\left\vert NM\left[h_{c}(\ln(\alpha)+1)-\psi(\alpha h_{c}) \right.\right.\right.\nonumber\\
&amp;\ \ \ \ +\left.\left.\left.h_{c}\left(w_{5}-M\sum_{n=1}^{N}E_{1n}\right)-w_{6}\sum_{n=1}^{N}E_{2n}\right]\right\vert \right\},\nonumber\\
\mu^{(s+1)} &amp;= \frac{1}{N}\sum_{n=1}^{N} E_{1n}^{(s)},\\
(\sigma^2)^{(s+1)}&amp;=\frac{1}{N}\sum_{n=1}^{N}\left[E_{3n}-(\mu^{(s+1)})^2\right].\nonumber
  \end{aligned}\label{em3}
\end{equation}\]</span> EM算法的实现从参数的初始值 <span class="math inline">\(\boldsymbol{\Theta^{(0)}}\)</span> 开始, 然后在 <span class="math inline">\(\eqref{em1}\)</span>和<span class="math inline">\(\eqref{em3}\)</span>之间迭代, 直到满足给定的收敛条件.</p></li>
</ol>
<p>贝叶斯方法通过结合数据与先验信息, 推断目标参数的后验分布. 然而, 在贝叶斯分析中, 直接获得每个边际后验的解析形式通常较为困难. 为此, 可采用MCMC方法, 特别是Gibbs抽样算法, 从参数的满条件后验分布中生成样本, 逐步迭代直到马尔可夫链达到平稳时终止. 对于当前的RGa退化模型, 基于MCMC的框架如下:</p>
<ol type="1">
<li><p>在当前后验样本 <span class="math inline">\(\boldsymbol{\Theta}^{(s)}\)</span> 下, 从 <span class="math inline">\(\eta_{n}\)</span> 的满条件后验中生成 <span class="math inline">\(\eta_{n}^{(s+1)}\)</span>, 即 <span class="math display">\[\begin{equation}\label{gib1}
  p_{2}(\eta_{n} \mid \boldsymbol{\Theta^{(s)}}) = \prod_{m=1}^{M} p_{x \mid \eta}(x_{n,m} \mid \alpha^{(s)}).
\end{equation}\]</span></p></li>
<li><p>在当前后验样本 <span class="math inline">\(\boldsymbol{\eta}^{(s+1)}\)</span> 下, 从 <span class="math inline">\(\alpha\)</span> 的满条件后验中生成 <span class="math inline">\(\boldsymbol{\Theta}^{(s+1)}\)</span>, 即 <span class="math display">\[\begin{equation}\label{gib2}
  p_{2}(\alpha \mid \boldsymbol{\eta}^{(s+1)}) = \prod_{n=1}^{N}\prod_{m=1}^{M} p_{x \mid \eta}(x_{n,m} \mid \eta_{n}^{(s+1)},\alpha) p(\alpha),
\end{equation}\]</span> 以及 从<span class="math inline">\((\mu, \sigma^2)\)</span> 的满条件后验中采样: <span class="math display">\[\begin{equation}\label{gib3}
  p_{2}(\mu,\sigma^2 \mid \boldsymbol{\eta}^{(s+1)}) = \prod_{n=1}^{N} p_{\eta}(\eta_{n}^{(s+1)} \mid \mu,\sigma^2) p(\mu,\sigma^2),
\end{equation}\]</span> 其中 <span class="math inline">\(p(\alpha)\)</span> 和 <span class="math inline">\(p(\mu,\sigma^2)\)</span> 是 <span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\((\mu,\sigma^2)\)</span>的先验, 与VB算法中的设置相同. 贝叶斯方法的实现从设置初始值 <span class="math inline">\(\boldsymbol{\Theta}^{(0)}\)</span> 和 <span class="math inline">\(\boldsymbol{\eta}^{(0)}\)</span> 开始, 并基于式 <span class="math inline">\(\eqref{gib1}\)</span>-<span class="math inline">\(\eqref{gib3}\)</span> 迭代生成后验样本, 直到所有链达到稳定且充分混合.</p></li>
</ol>



<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-berger2013" class="csl-entry" role="listitem">
Berger J O, 2013. Statistical decision theory and <span>B</span>ayesian analysis[M]. Springer Science &amp; Business Media.
</div>
<div id="ref-blei2017variational" class="csl-entry" role="listitem">
Blei D M, Kucukelbir A, McAuliffe J D, 2017. Variational inference: A review for statisticians[J]. Journal of the American Statistical Association, 112(518): 859–877.
</div>
<div id="ref-bolstad2016introduction" class="csl-entry" role="listitem">
Bolstad W M, Curran J M, 2016. Introduction to <span>Bayesian</span> statistics[M]. John Wiley &amp; Sons.
</div>
<div id="ref-pracma2021" class="csl-entry" role="listitem">
Borchers H W, 2019. Pracma: practical numerical math functions[J]. R package version, 2(9): 519.
</div>
<div id="ref-bouetal2015" class="csl-entry" role="listitem">
Bousquet N, Fouladirad M, Grall A, 等, 2015. Bayesian gamma processes for optimizing condition-based maintenance under uncertainty[J]. Applied Stochastic Models in Business and Industry, 31(3): 360–379.
</div>
<div id="ref-dams1975" class="csl-entry" role="listitem">
Damsleth E, 1975. Conjugate classes for gamma distributions[J]. Scandinavian Journal of Statistics, 2(2): 80–84.
</div>
<div id="ref-davis2007methods" class="csl-entry" role="listitem">
Davis P J, Rabinowitz P, 2007. Methods of numerical integration[M]. Courier Corporation.
</div>
<div id="ref-denison2002bayesian" class="csl-entry" role="listitem">
Denison D G, Holmes C C, Mallick B K, 等, 2002. Bayesian methods for nonlinear classification and regression[M]. John Wiley &amp; Sons.
</div>
<div id="ref-azevedo1994laplace" class="csl-entry" role="listitem">
Geisser S, Hodges J, Press S, 等, 1990. The validity of posterior expansions based on <span>Laplace</span>’s method[J]. Bayesian and likelihood methods in statistics and econometrics, 7: 473.
</div>
<div id="ref-gelman2014bayesian" class="csl-entry" role="listitem">
Gelman A, Carlin J B, Stern H S, 等, 2014. Bayesian Data Analysis[M]. Taylor &amp; Francis.
</div>
<div id="ref-gilwil1992" class="csl-entry" role="listitem">
Gilks W R, Wild P, 1992. Adaptive rejection sampling for Gibbs sampling[J]. Journal of the Royal Statistical Society: Series C, 41(2): 337–348.
</div>
<div id="ref-halwan2005" class="csl-entry" role="listitem">
Hall P, Wang J Z, 2005. Bayesian likelihood methods for estimating the end point of a distribution[J]. Journal of the Royal Statistical Society: Series B, 67(5): 717–729.
</div>
<div id="ref-jaakkola2000bayesian" class="csl-entry" role="listitem">
Jaakkola T S, Jordan M I, 2000. Bayesian parameter estimation via variational methods[J]. Statistics and Computing, 10(1): 25–37.
</div>
<div id="ref-krishnamoorthy2016handbook" class="csl-entry" role="listitem">
Krishnamoorthy K, 2016. Handbook of statistical distributions with applications[M]. CRC Press.
</div>
<div id="ref-linngtsu2019" class="csl-entry" role="listitem">
Ling M H, Ng H, Tsui K L, 2019. Bayesian and likelihood inferences on remaining useful life in two-phase degradation models under gamma process[J]. Reliability Engineering &amp; System Safety, 184: 77–85.
</div>
<div id="ref-liu1994note" class="csl-entry" role="listitem">
Liu Q, Pierce D A, 1994. A note on <span>Gauss—Hermite</span> quadrature[J]. Biometrika, 81(3): 624–629.
</div>
<div id="ref-wangetal03" class="csl-entry" role="listitem">
Marsaglia G, Tsang W W, Wang J, 2003. Evaluating Kolmogorov’s distribution[J]. Journal of Statistical Software, 8: 1–4.
</div>
<div id="ref-mclachlan2007algorithm" class="csl-entry" role="listitem">
McLachlan G J, Krishnan T, 2007. The EM algorithm and extensions[M]. John Wiley &amp; Sons.
</div>
<div id="ref-Meeker1998" class="csl-entry" role="listitem">
Meeker W Q, Escobar L A, Pascual F G, 1998. Statistical Methods for Reliability Data[M]. John Wiley &amp; Sons.
</div>
<div id="ref-parpad2005" class="csl-entry" role="listitem">
Park C, Padgett W, 2005. Accelerated degradation models for failure based on geometric Brownian motion and gamma processes[J]. Lifetime Data Analysis, 11(4): 511–527.
</div>
<div id="ref-paroissin2017" class="csl-entry" role="listitem">
Paroissin C, 2017. Online estimation methods for the gamma degradation process[J]. IEEE Transactions on Reliability, 66(4): 1361–1367.
</div>
<div id="ref-seo2017data" class="csl-entry" role="listitem">
Seo K, Pan R, 2017. Data analysis of step-stress accelerated life tests with heterogeneous group effects[J]. IISE Transactions, 49(9): 885–898.
</div>
<div id="ref-tsai2012optimal" class="csl-entry" role="listitem">
Tsai C-C, Tseng S-T, Balakrishnan N, 2012. Optimal design for degradation tests based on gamma processes with random effects[J]. IEEE Transactions on Reliability, 61(2): 604–613.
</div>
<div id="ref-turlapaty2020variational" class="csl-entry" role="listitem">
Turlapaty A C, 2020. Variational Bayesian estimation of statistical properties of composite gamma log-normal distribution[J]. IEEE Transactions on Signal Processing, 68: 6481–6492.
</div>
<div id="ref-wang2008" class="csl-entry" role="listitem">
Wang X, 2008. A pseudo-likelihood estimation method for nonhomogeneous gamma process model with random effects[J]. Statistica Sinica, 18(3): 1153–1163.
</div>
<div id="ref-wang2005inadequacy" class="csl-entry" role="listitem">
Wang B, Titterington D M, 2005. Inadequacy of interval estimates corresponding to variational Bayesian approximations[C]//International Workshop on Artificial Intelligence and Statistics. PMLR: 373–380.
</div>
<div id="ref-wang2021degradation" class="csl-entry" role="listitem">
Wang Z, Zhai Q, Chen P, 2021. Degradation modeling considering unit-to-unit heterogeneity-A general model and comparative study[J]. Reliability Engineering &amp; System Safety, 216: 107897.
</div>
<div id="ref-xushen2018" class="csl-entry" role="listitem">
Xu A, Shen L, 2018. Improved on-line estimation for gamma process[J]. Statistics &amp; Probability Letters, 143: 67–73.
</div>
<div id="ref-xutang2012" class="csl-entry" role="listitem">
Xu A, Tang Y, 2012. Objective <span>B</span>ayesian analysis for linear degradation models[J]. Communications in Statistics-Theory and Methods, 41(21): 4034–4046.
</div>
<div id="ref-Ye2015" class="csl-entry" role="listitem">
Ye Z-S, Chen N, Shen Y, 2015. A new class of Wiener process models for degradation analysis[J]. Reliability Engineering &amp; System Safety, 139: 58–67.
</div>
<div id="ref-zaidan2016gas" class="csl-entry" role="listitem">
Zaidan M A, Mills A R, Harrison R F, 等, 2016. Gas turbine engine prognostics using <span>Bayesian</span> hierarchical models: A variational approach[J]. Mechanical Systems and Signal Processing, 70: 120–140.
</div>
<div id="ref-zellner1986" class="csl-entry" role="listitem">
Zellner A, 1986. On assessing prior distributions and Bayesian regression analysis with g-prior distributions[J]. Bayesian Inference and Decision Techniques.
</div>
<div id="ref-zhou2020variational" class="csl-entry" role="listitem">
Zhou S, Xu A, Lian Y, 等, 2020. Variational <span>Bayesian</span> analysis for <span>Wiener</span> degradation model with random effects[J]. Communications in Statistics-Theory and Methods, : 1–21.
</div>
</div>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "已复制");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "已复制");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/02-Wiener.html" class="pagination-link" aria-label="基于维纳过程的统计建模">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">基于维纳过程的统计建模</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/04-IG.html" class="pagination-link" aria-label="基于逆高斯过程的统计建模">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">基于逆高斯过程的统计建模</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">源代码</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb1" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu"># 基于伽马过程的统计建模 {#sec-03-Gamma}</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">## 伽马过程 {#sec-Gamma}</span></span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a>如果随机过程 $<span class="sc">\{</span>Y(t), t \ge 0<span class="sc">\}</span>$ 满足以下性质:</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a>(i) $Y(0) = 0$;</span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a>(ii) $<span class="sc">\{</span>Y(t), t \ge 0<span class="sc">\}</span>$ 具有平稳和独立增量;</span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a>(iii) 对任意的两个时间$t&gt;s &gt;0$, 增量 $Y_{ts} = Y(t) - Y(s)$ 服从伽马分布伽马分布\index{伽马分布} $Ga(\alpha(t-s),\beta)$, 其PDF为 $$</span>
<span id="cb1-12"><a href="#cb1-12"></a>      f(y  \mid  \alpha, \beta) = \frac{\beta^{\alpha(t-s)} y^{\alpha(t-s)-1}}{\Gamma(\alpha(t-s))} \exp\left<span class="sc">\{</span>-\beta y \right<span class="sc">\}</span>,</span>
<span id="cb1-13"><a href="#cb1-13"></a>      $$ 其中$\Gamma(\cdot)$ 表示伽马函数, $\alpha$ 和 $\beta$ 是未知参数, 且取值大于0. 称随机过程$<span class="sc">\{</span>Y(t), t \ge 0<span class="sc">\}</span>$为齐次伽马过程, 记作 $Y(t) \sim \mathcal{GP}(\alpha t, \beta)$.</span>
<span id="cb1-14"><a href="#cb1-14"></a></span>
<span id="cb1-15"><a href="#cb1-15"></a>当产品性能退化\index{性能退化}服从伽马过程\index{伽马过程}$\mathcal{GP}(\alpha t, \beta)$且失效阈值为 $\omega$时, 定义产品寿命\index{寿命}为 $T=\inf<span class="sc">\{</span>t \mid Y(t)\ge\omega<span class="sc">\}</span>$. 此时, 寿命\index{寿命}$T$的CDF可表示为 \begin{equation}</span>
<span id="cb1-16"><a href="#cb1-16"></a>  \begin{aligned}</span>
<span id="cb1-17"><a href="#cb1-17"></a>    F_{T}(t \mid \alpha,\beta)&amp;=P(T&lt; t)=P(Y_(t)&gt;\omega)=\frac{\Psi(\beta\omega,\alpha t)}{\Gamma(\alpha t)},</span>
<span id="cb1-18"><a href="#cb1-18"></a>  \end{aligned}</span>
<span id="cb1-19"><a href="#cb1-19"></a>\end{equation} 其中 $\Psi(k,\alpha)$ 是上不完全伽马函数, 定义为 $\Psi(k,\alpha)=\int_{k}^{\infty}x^{\alpha-1}\exp(-x)\text{d}x$. 本章采用贝叶斯\index{贝叶斯}框架进行统计推断, 故将参数$\alpha$和$\beta$视为随机 变量, 并统一使用条件分布的形式. 尽管$F_{T}(t \mid \alpha,\beta)$ 可通过常见软件(如 *R* 或 *MATLAB*) 直接计算, 但产品的MTTF与寿命\index{寿命}分位数缺乏显式解析解, 导致后验推断效率低下, 尤其在实时在线预测场景中计算负担显著. 为此, 可采用 @parpad2005 推荐的方法, 使用两参数 Birnbaum-Saunders (BS) 分布 $BS(\alpha^\ast,\beta^\ast)$ 来近似 $F_{T}(t \mid \alpha,\beta)$. BS分布的CDF为 $$\Phi\left(\frac{1}{\alpha^\ast}\left<span class="co">[</span><span class="ot">\sqrt{\frac{x}{\beta^\ast}}-\sqrt{\frac{\beta^\ast}{x}}\right</span><span class="co">]</span>\right),$$ 其中 $\alpha^\ast=\sqrt{\frac{1}{\beta\omega}}$, $\beta^\ast=\frac{\beta \omega}{\alpha}$. 此外, 产品的MTTF可近似为 \begin{equation}</span>
<span id="cb1-20"><a href="#cb1-20"></a>\beta^\ast\left(1+\frac{\left(\alpha^\ast\right)^2}{2}\right)=\frac{1+2\beta\omega}{2\alpha}.</span>
<span id="cb1-21"><a href="#cb1-21"></a>\end{equation}</span>
<span id="cb1-22"><a href="#cb1-22"></a></span>
<span id="cb1-23"><a href="#cb1-23"></a>本章围绕伽马过程\index{伽马过程}展开建模与统计推断. 第 @sec-Bayes-Gamma 节构建伽马过程\index{伽马过程}的贝叶斯\index{贝叶斯}分析框架, 并提出多种后验采样算法以适应不同场景下的参数推断需求. 针对产品异质性\index{异质性}带来的模型复杂度提升问题, 第 @sec-VB-Gamma 节提出一种重参数化伽马过程\index{伽马过程}及其变分贝叶斯\index{变分贝叶斯} (Variational Bayesian, VB) 算法. 该算法通过赋予参数明确物理意义, 显著提升推断效率, 为复杂退化模型的求解提供高效方案.</span>
<span id="cb1-24"><a href="#cb1-24"></a></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="fu">## 伽马过程的贝叶斯分析 {#sec-Bayes-Gamma}</span></span>
<span id="cb1-26"><a href="#cb1-26"></a></span>
<span id="cb1-27"><a href="#cb1-27"></a>在线RUL预测\index{RUL预测}通过退化建模与统计推断实现参数估计. 在伽马过程\index{伽马过程}退化模型领域, @paroissin2017 和 @xushen2018 提出了递推式线性估计方法, 但其在 RUL 预测及置信区间\index{置信区间}估计中的应用仍存在局限性. 传统离线方法 (如基于贝叶斯\index{贝叶斯}框架和极大似然法的策略 <span class="co">[</span><span class="ot">@wang2008; @linngtsu2019; @wang2021degradation</span><span class="co">]</span>) 需依赖过去全部的退化数据, 当新增观测时需重新计算, 对存储空间与计算资源需求较高. 为此, 本节介绍了一种低计算量、高效的伽马过程\index{伽马过程}在线 RUL 预测框架. 内容涵盖了以下几个方面:</span>
<span id="cb1-28"><a href="#cb1-28"></a></span>
<span id="cb1-29"><a href="#cb1-29"></a><span class="ss">1.  </span>贝叶斯\index{贝叶斯}推断方法: 推导伽马过程\index{伽马过程}中模型参数的共轭先验\index{先验}, 并以此为基础提出贝叶斯\index{贝叶斯}推断方法. 相较于无信息先验\index{先验}与混合先验\index{先验}形式 <span class="co">[</span><span class="ot">@bouetal2015; @linngtsu2019</span><span class="co">]</span>, 该方法通过超参数动态更新简化后验计算, 并针对异质性\index{异质性}退化场景提供超参数设定准则.</span>
<span id="cb1-30"><a href="#cb1-30"></a></span>
<span id="cb1-31"><a href="#cb1-31"></a><span class="ss">2.  </span>**算法开发**: 开发三种后验分布随机样本生成算法, 克服共轭先验\index{先验}结构复杂性与后验采样效率问题. 通过数值模拟实验验证各算法的计算性能与精度优势.</span>
<span id="cb1-32"><a href="#cb1-32"></a></span>
<span id="cb1-33"><a href="#cb1-33"></a><span class="ss">3.  </span>**在线**RUL预测\index{RUL预测}算法: 基于共轭先验\index{先验}的解析递推特性, 构建在线 RUL 预测算法. 其流程 ( 详见第 @sec-ITR2025-rul 节) 仅需两步:</span>
<span id="cb1-34"><a href="#cb1-34"></a></span>
<span id="cb1-35"><a href="#cb1-35"></a><span class="ss">-   </span>**后验递推更新**: 利用当前观测值与历史推断结果更新后验分布;</span>
<span id="cb1-36"><a href="#cb1-36"></a><span class="ss">-   </span>**后验样本生成**: 调用预设算法输出参数后验样本. 相比传统方法, 该机制避免全量数据存储与重复计算, 显著提升在线推断效率</span>
<span id="cb1-37"><a href="#cb1-37"></a></span>
<span id="cb1-38"><a href="#cb1-38"></a>本节结构安排如下: 第 @sec-ITR2025-prior 节介绍伽马过程\index{伽马过程}的共轭先验\index{先验}及其性质; 第 @sec-ITR2025-ps 节介绍三种基于共轭先验\index{先验}的后验样本生成算法; 第 @sec-ITR2025-sim 节通过模拟评估算法的估计精度和计算效率; 第 @sec-ITR2025-heter 节讨论共轭先验\index{先验}在具有异质效应伽马过程\index{伽马过程}中的扩展; 第 @sec-ITR2025-rul 节提出一种在线 RUL 预测算法; 第 @sec-ITR2025-case 节展示新方法在实际案例中的应用.</span>
<span id="cb1-39"><a href="#cb1-39"></a></span>
<span id="cb1-40"><a href="#cb1-40"></a><span class="fu">### 共轭先验 {#sec-ITR2025-prior}</span></span>
<span id="cb1-41"><a href="#cb1-41"></a></span>
<span id="cb1-42"><a href="#cb1-42"></a>假设产品性能的退化路径服从伽马过程\index{伽马过程} $\mathcal{GP}(\alpha t,\beta)$. 从总体中随机选择 $n$ 个产品进行测试, 测量时间 为 $T_1&lt;T_2&lt;\cdots&lt;T_m$. 记第 $i$ 个产品在时间点 $T_j$ 的退化值为 $Y_i(T_j)$, $i=1,\dots,n,$ $j=1,\dots,m$. 设 $Y_{ij}=Y_i(T_j)-Y_i(T_{j-1})$ 且 $t_j=T_j-T_{j-1}$, 其中 $Y_i(T_0)=0$ 且 $T_0=0$, $i=1,\dots,n,$ $j=1,\dots,m$. 根据伽马过程\index{伽马过程}的性质 (iii), 有 $Y_{ij}\sim \textrm{Ga}(\alpha t_j,\beta)$. 令 $y_{ij}$ 表示 $Y_{ij}$ 的观测值, 并将观测数据表示为 $\bm{y}=<span class="sc">\{</span>y_{ij}, i=1,\dots,n, j=1,\dots,m<span class="sc">\}</span>$. 此时, 基于数据 $\bm{y}$, 似然函数\index{似然函数}为 \begin{align}\label{like0}</span>
<span id="cb1-43"><a href="#cb1-43"></a>        L( \bm{y} \mid \alpha,\beta) &amp;=\prod_{i=1}^{n}\prod_{j=1}^{m}\dfrac{\beta^{\alpha t_j}}{\Gamma(\alpha t_j)}</span>
<span id="cb1-44"><a href="#cb1-44"></a>        y_{ij}^{\alpha t_j-1}\exp<span class="sc">\{</span>-\beta y_{ij}<span class="sc">\}</span>\nonumber<span class="sc">\\</span></span>
<span id="cb1-45"><a href="#cb1-45"></a>        &amp;\propto\dfrac{\beta^{nT_m\alpha}\left<span class="co">[</span><span class="ot">\prod_{i=1}^{n}\prod_{j=1}^{m}y_{ij}^{t_{j}}\right</span><span class="co">]</span>^\alpha}</span>
<span id="cb1-46"><a href="#cb1-46"></a>        {\left<span class="co">[</span><span class="ot">\prod_{j=1}^{m}\Gamma(\alpha t_j)\right</span><span class="co">]</span>^n}\exp\left<span class="sc">\{</span>-\beta \sum_{i=1}^{n}\sum_{j=1}^{m}y_{ij}\right<span class="sc">\}</span>\nonumber<span class="sc">\\</span></span>
<span id="cb1-47"><a href="#cb1-47"></a>        &amp;\propto \dfrac{\beta^{nm\overline{T}_m\alpha}\exp\{-mn\bar{y}_a\beta\}}{\left[\prod_{j=1}^{m}\left(\Gamma(\alpha t_j)\right)^{1/m}\right]^{mn}}</span>
<span id="cb1-48"><a href="#cb1-48"></a>        \left<span class="co">[</span><span class="ot">\prod_{i=1}^{n}\prod_{j=1}^{m}y_{ij}^{\frac{t_{j}}{nm\overline{T}_m}}\right</span><span class="co">]</span>^{nm\overline{T}_m\alpha},</span>
<span id="cb1-49"><a href="#cb1-49"></a>\end{align} 其中$\overline{T}_m=\frac{T_m}{m}$, $\bar{y}_a=\frac{1}{mn}\sum_{i=1}^{n}\sum_{j=1}^{m}y_{ij}$.</span>
<span id="cb1-50"><a href="#cb1-50"></a></span>
<span id="cb1-51"><a href="#cb1-51"></a>::: {#thm-ITR2025-th2}</span>
<span id="cb1-52"><a href="#cb1-52"></a>基于似然函数\index{似然函数} \eqref{like0}, $\alpha$ 和 $\beta$ 的共轭先验\index{先验}为 \begin{equation}\label{con0}</span>
<span id="cb1-53"><a href="#cb1-53"></a>    \pi(\alpha,\beta)=  C \dfrac{(\beta\omega)^{\delta \overline{T}_m\alpha}}{\left[\prod_{j=1}^{m}\left(\Gamma(\alpha t_j)\right)^{1/m}\right]^{\delta}}</span>
<span id="cb1-54"><a href="#cb1-54"></a>        \exp<span class="sc">\{</span>-\delta\lambda\beta<span class="sc">\}</span>,</span>
<span id="cb1-55"><a href="#cb1-55"></a>\end{equation} 其中 $C$ 是正则化常数, $\delta$、$\omega$ 和 $\lambda$ 是非负超参数, 分别为先验\index{先验}分布的扩散、形状以及尺度参数.</span>
<span id="cb1-56"><a href="#cb1-56"></a>:::</span>
<span id="cb1-57"><a href="#cb1-57"></a></span>
<span id="cb1-58"><a href="#cb1-58"></a>定理 @thm-ITR2025-th2 的证明见本节附录 @sec-Append-3A. 共轭先验\index{先验} $\pi(\alpha,\beta)$ 与测量时间相关. 尽管其形式较为复杂, 但可以通过将$\pi(\alpha, \beta)$ 分解如下形式, 使其更为简洁和易于处理. \begin{align}\label{deco0}</span>
<span id="cb1-59"><a href="#cb1-59"></a>        \pi(\alpha,\beta)&amp;%=\pi(\beta \mid \alpha)\pi(\alpha)</span>
<span id="cb1-60"><a href="#cb1-60"></a>        \propto</span>
<span id="cb1-61"><a href="#cb1-61"></a>        \dfrac{(\delta\lambda)^{\delta \overline{T}_m\alpha+1}}{\Gamma\left(1+\delta \overline{T}_m\alpha\right)}</span>
<span id="cb1-62"><a href="#cb1-62"></a>        \beta^{\delta \overline{T}_m\alpha}\exp<span class="sc">\{</span>-\delta\lambda\beta<span class="sc">\}</span>\nonumber<span class="sc">\\</span></span>
<span id="cb1-63"><a href="#cb1-63"></a>        &amp;\ \ \ \times</span>
<span id="cb1-64"><a href="#cb1-64"></a>        \dfrac{\left(\dfrac{\omega}{\delta\lambda}\right)^{\delta \overline{T}_m\alpha}\Gamma\left(1+\delta \overline{T}_m\alpha\right)}{\left[\prod_{j=1}^{m}\left(\Gamma(\alpha t_j)\right)^{1/m}\right]^{\delta}}.</span>
<span id="cb1-65"><a href="#cb1-65"></a>\end{align} 可以发现, 在给定 $\alpha$ 时, $\beta$的条件先验\index{先验} $\pi(\beta \mid \alpha)$ 服从伽马分布\index{伽马分布} $\textrm{Ga}(\delta \overline{T}_m\alpha+1,\delta\lambda)$. 因此, $\pi(\beta \mid \alpha)$ 的众数、方差和变异系数分别为 $\overline{T}_m\alpha/\lambda$、 $(\delta \overline{T}_m\alpha+1)/(\delta\lambda)^2$ 和 $(\delta \overline{T}_m \alpha+1)^{-1/2}$, 其中超参数 $\lambda$ 是标准的尺度参数, 而超参数 $\delta$ 则在给定 $\alpha$ 时决定了方差和变异系数. 当 $\delta$ 较大时, $\pi(\beta \mid \alpha)$ 的分布曲将集中于众数附近. 因此, 将 $\delta$ $\delta$ 定义为扩散参数. $\alpha$ 的边际先验\index{先验}形式正比于:\</span>
<span id="cb1-66"><a href="#cb1-66"></a>\begin{equation*}</span>
<span id="cb1-67"><a href="#cb1-67"></a>    h(\alpha)=  \dfrac{\left(\dfrac{\omega}{\delta\lambda}\right)^{\delta \overline{T}_m\alpha}\Gamma\left(1+\delta \overline{T}_m\alpha\right)}{\left[\prod_{j=1}^{m}\left(\Gamma(\alpha t_j)\right)^{1/m}\right]^{\delta}}.</span>
<span id="cb1-68"><a href="#cb1-68"></a>\end{equation*} 根据 Stirling 公式, 可知: $$</span>
<span id="cb1-69"><a href="#cb1-69"></a>\lim\limits_{u\rightarrow +\infty}\frac{\sqrt{2\pi}u^{u+1/2}\exp<span class="sc">\{</span>-u<span class="sc">\}</span>}{\Gamma(u+1)}=1.</span>
<span id="cb1-70"><a href="#cb1-70"></a>$$ 当 $\alpha\rightarrow+\infty$ 时, 用Stirling 公式对伽马函数做近似处理, 得到以下结果:\</span>
<span id="cb1-71"><a href="#cb1-71"></a>\begin{align}\label{appro0}</span>
<span id="cb1-72"><a href="#cb1-72"></a>    h(\alpha)&amp;\equiv\dfrac{\left(\dfrac{\omega}{\delta\lambda}\right)^{\delta \overline{T}_m\alpha} \sqrt{2\pi}(\delta\overline{T}_m\alpha)^{\delta\overline{T}_m\alpha+1/2}\exp\{-\delta\overline{T}_m\alpha\}}{\left[\prod_{j=1}^{m}\left(\sqrt{2\pi}(\alpha t_j)^{\alpha t_j-1/2}\exp<span class="sc">\{</span>-\alpha t_j<span class="sc">\}</span>\right)^{1/m}\right]^{\delta}}\nonumber<span class="sc">\\</span></span>
<span id="cb1-73"><a href="#cb1-73"></a>    &amp;= O\left(\alpha^{\frac{\delta+1}{2}}\exp\left<span class="sc">\{</span>-\alpha\delta \overline{T}_m \log\left(\frac{\lambda}{\omega}\frac{\prod_{j=1}^{m}t_j^{t_j/T_m}}{\overline{T}_m}\right)\right<span class="sc">\}</span>\right),</span>
<span id="cb1-74"><a href="#cb1-74"></a>\end{align} 其中$h(\alpha)=O(g(\alpha))$ 表示 $h(\alpha)$ 和 $g(\alpha)$ 同阶. 可以证明 $\log\left(\frac{\prod{j=1}^{m}t_j^{t_j/T_m}}{\overline{T}_m}\right)\ge 0$ (详见本节附录 @sec-Append-3A). 为了保证 $\pi(\alpha)$ 是正常的PDF, 一个充分条件是 $\omega&lt;\lambda$. 同时根据 \eqref{appro0} 可知 $\pi(\alpha)$ 的右尾特性类似于伽马分布\index{伽马分布} $$</span>
<span id="cb1-75"><a href="#cb1-75"></a>\textrm{Ga}\left(\frac{\delta+3}{2},\delta \overline{T}m \left<span class="co">[</span><span class="ot">\log\left(\frac{\lambda}{\omega}\right)+\log\left(\frac{\prod{j=1}^{m}t_j^{t_j/T_m}}{\overline{T}_m}\right)\right</span><span class="co">]</span>\right).$$ 在 $\pi(\alpha)$ 中, $\omega$ 起到尺度参数的作用, 进一步影响 $\pi(\beta \mid \alpha)$ 的形状. 因此, $\omega$ 被称为形状参数. 由于 $\pi(\beta \mid \alpha)$ 的伽马条件先验\index{先验}和 $\pi(\alpha)$ 的右尾特性, 这种共轭先验\index{先验} $\pi(\alpha,\beta)$ 被称为近似伽马-伽马 (Approximated-gamma-gamma, AGG) 分布, 记为 $\textrm{AGG}(\delta,\omega,\lambda)$.</span>
<span id="cb1-76"><a href="#cb1-76"></a></span>
<span id="cb1-77"><a href="#cb1-77"></a>图 @fig-fig:config0 展示了当 $t_j=1$ 且 $j=1,\dots,m$ 时, 不同 $(\delta,\omega,\lambda)$ 值下 $\pi(\alpha,\beta)$ 的函数图和等高线图. 以 $\delta=2$, $\omega=0.5$, $\lambda=1.5$ 为基准, 从图中可以看出, 当 $\delta$ 的值增加到 5 且其他两个超参数保持不变时, 众数的位置几乎相同, 但等高线更集中于众数附近. 增大 $\lambda$ 的值同样有类似现象, 但众数的位置有所变化. $\omega$ 则会改变 $\pi(\alpha,\beta)$ 的形状, 并使其众数的位置发生偏移. 综上所述, 该图展示了 不同参数对 AGG 分布的形状和众数位置有显著影响, 为选择合理的超参数提供了依据.</span>
<span id="cb1-78"><a href="#cb1-78"></a></span>
<span id="cb1-79"><a href="#cb1-79"></a>**注1**: 当采用等间隔测量(即$t_j=l$)时, $\pi(\alpha,\beta)$ 的形式简化为 \begin{equation}\label{con1} \pi(\alpha,\beta)=C \dfrac{(\beta\omega)^{\delta l\alpha}}{\left<span class="co">[</span><span class="ot">\Gamma(l\alpha)\right</span><span class="co">]</span>^{\delta}} \exp{(-\delta\lambda\beta)}.</span>
<span id="cb1-80"><a href="#cb1-80"></a>\end{equation} 当 $l=1$ 时, $\pi(\alpha,\beta)$ 简化为伽马分布\index{伽马分布} $Ga(\alpha,\beta)$ 的共轭先验\index{先验}<span class="co">[</span><span class="ot">@dams1975</span><span class="co">]</span>.</span>
<span id="cb1-81"><a href="#cb1-81"></a></span>
<span id="cb1-82"><a href="#cb1-82"></a>**注2**: 超参数的取值可以基于先验\index{先验}信息量的强弱来选择. 如图 @fig-fig:config0 所示, 不同的超参数组合会显著影响 $(\alpha,\beta)$的分布特性: 较大的 $\delta$、较小的 $\omega$ 或较大的 $\lambda$ 会导致 $(\alpha, \beta)$ 的方差较小, 表示强的先验\index{先验}信息. 在先验\index{先验}知识较少的情况下, 可以选择较小的 $\delta$、较大的 $\omega$ 或较小的 $\lambda$. 在实际应用中, 可以通过调整 $\delta$ 控制先验\index{先验}信息的强度. 例如, 根据式 \eqref{post0}, $\alpha$ 和 $\beta$ 的后验分布为 $\textrm{AGG}(\delta_p,\omega_p,\lambda_p)$. 特别地, 对于 $\omega$ 和 $\lambda$, 可以使用以下基于观测数据的选择方案:\</span>
<span id="cb1-83"><a href="#cb1-83"></a>\begin{equation}\label{hyper}</span>
<span id="cb1-84"><a href="#cb1-84"></a>    \omega=\prod_{i=1}^{n}\prod_{j=1}^{m}y_{ij}^{\frac{t_{j}}{nm\overline{T}_m}},</span>
<span id="cb1-85"><a href="#cb1-85"></a>    ~\lambda=\bar{y}_a.</span>
<span id="cb1-86"><a href="#cb1-86"></a>\end{equation} 这种超参数选择方法属于数据驱动先验\index{先验}的范畴, 其合理性已在贝叶斯\index{贝叶斯}统计中得到广泛验证. 例如: 回归系数的先验\index{先验} <span class="co">[</span><span class="ot">@zellner1986</span><span class="co">]</span>, 阈值参数的有效先验\index{先验} <span class="co">[</span><span class="ot">@halwan2005</span><span class="co">]</span>, 线性退化路径模型的参考先验\index{先验} <span class="co">[</span><span class="ot">@xutang2012</span><span class="co">]</span>等. 式 \eqref{hyper} 所建议的超参数设置具有以下优点: 1. 共轭性保证: 当观测增量中至少有两个值不相等时, 自动满足共轭先验\index{先验}的条件 $\omega &lt; \lambda$. 2. 众数合理性: $\omega$ 和 $\lambda$ 决定了先验\index{先验}分布 $\pi(\alpha, \beta)$ 的众数位置, 通过数据驱动方式可确保众数值的合理性. 3. 信息量可解释性: 超参数 $\delta$ 类似于测量次数, 其大小可解释为等效的先验\index{先验}信息量:\</span>
<span id="cb1-87"><a href="#cb1-87"></a>$\delta = 1$: 等效于单个产品的单次测量信息; $\delta = 0$: 非信息性先验\index{先验}, 表示完全不依赖先验\index{先验}信息; $\delta = mn$: 与所有观测数据的信息量等效, 表示非常强的先验\index{先验}信息. 基于上述优点, 本章在模拟研究与数据分析中采用自动化策略 \eqref{hyper} 指定超参数值, 从而简化共轭先验\index{先验}的设定过程.</span>
<span id="cb1-88"><a href="#cb1-88"></a></span>
<span id="cb1-89"><a href="#cb1-89"></a><span class="co">&lt;!--这些先验\index{先验}方法在实际应用中已被广泛验证, 具有很高的实用性. 对于式 \eqref{hyper} 所建议的超参数设置, 其优点包括以下几点:   (1) 当观测增量中至少有两个值不相等时, 自动满足共轭先验的条件 $\omega&lt;\lambda$. (2) $\omega$ 和 $\lambda$ 决定了先验分布 $\pi(\alpha,\beta)$ 的众数位置, 通过数据驱动的方式可以建议出合理的众数值.  (3) 在这种设置下, 超参数 $\delta$ 类似于测量次数. $\delta$ 的大小可以看作与测量次数等效的先验信息量.  例如, $\delta=1$:  等效于单个产品的单次测量信息; $\delta=0$:  非信息性先验, 表示完全不依赖先验信息; $\delta=mn$:  与所有观测数据的信息量等效, 表示非常强的先验信息.  基于这些优点, 本章将在模拟研究和数据分析中采用自动化策略 \eqref{hyper} 来指定超参数值, 这可以简化共轭先验的设定. --&gt;</span></span>
<span id="cb1-90"><a href="#cb1-90"></a></span>
<span id="cb1-91"><a href="#cb1-91"></a>**注3**: 在实际工程应用中, 可能已经掌握了一些关于参数 $\alpha$ 和 $\beta$ 的先验\index{先验}信息 (如众数、均值、分位数和方差等). 然而, 由于联合先验\index{先验}分布 $\pi(\alpha,\beta)$ 的形式复杂, 缺乏解析表达式, 直接确定其超参数 $(\delta,\lambda,\omega)$ 可能较为困难. 以下是一种将这些先验\index{先验}信息合理融入到超参数设定中的方法, 分为以下三个步骤:\</span>
<span id="cb1-92"><a href="#cb1-92"></a>(1) 设定 $\delta$ 的值: 如注释 2 所述, 可以通过等效测量信息量, 主观地设定 $\delta$; (2) 确定 $\lambda$ 的值: 利用 $\alpha$ 的信息, 结合 $\beta$ 的信息以及条件先验\index{先验}分布 $\pi(\beta \mid \alpha)$ 来确定 $\lambda$; (3) 确定 $\omega$ 的值: 根据 $\alpha$ 的近似分布 $$</span>
<span id="cb1-93"><a href="#cb1-93"></a>Ga\left(\frac{\delta+3}{2},\delta \overline{T}_{m} \left<span class="co">[</span><span class="ot">\log\left(\frac{\lambda}{\omega}\right)+\log\left(\frac{\prod{j=1}^{m}t_j^{t_j/T_m}}{\overline{T}_m}\right)\right</span><span class="co">]</span>\right),$$ 结合 $\alpha$ 的信息设定 $\omega$. 例如, 对于 $\alpha$ 和 $\beta$ 的众数 $\alpha_M$ 和 $\beta_M$, 若工程师对其置信度较低, 则可以选择一个相对较小的 $\delta$ 值. 给定 $\alpha=\alpha_M$ 时, 可知 $\pi(\beta \mid \alpha)$ 的众数为 $\overline{T}_m\alpha_M/\lambda$. 之后可通过求解 $\beta_M=\overline{T}_m\alpha_M/\lambda$ 得到 $\lambda=\overline{T}_m\alpha_M/\beta_M$. 由于 $\alpha$ 的边际先验\index{先验}的近似具有众数为如下形式:\</span>
<span id="cb1-94"><a href="#cb1-94"></a>$$\frac{\delta+1}{2\delta \overline{T}_m</span>
<span id="cb1-95"><a href="#cb1-95"></a>\left<span class="co">[</span><span class="ot">\log\left(\frac{\lambda}{\omega}\right)+\log\left(\frac{\prod_{j=1}^{m}t_j^{t_j/T_m}}{\overline{T}_m}\right)\right</span><span class="co">]</span>}.</span>
<span id="cb1-96"><a href="#cb1-96"></a>$$ 给定众数 $\alpha_M$, 可以得到 $$\omega=\frac{\prod_{j=1}^{m}t_j^{t_j/T_m}}{\overline{T}_m}\exp\left<span class="sc">\{</span>\log\lambda-\frac{\delta+1}{2\delta \overline{T}_m\alpha_M}\right<span class="sc">\}</span>.$$</span>
<span id="cb1-97"><a href="#cb1-97"></a></span>
<span id="cb1-100"><a href="#cb1-100"></a><span class="in">```{r}</span></span>
<span id="cb1-101"><a href="#cb1-101"></a><span class="co">#| label: fig-fig:config0</span></span>
<span id="cb1-102"><a href="#cb1-102"></a><span class="co">#| fig.align: 'center'</span></span>
<span id="cb1-103"><a href="#cb1-103"></a><span class="co">#| echo: FALSE</span></span>
<span id="cb1-104"><a href="#cb1-104"></a><span class="co">#| out.width: '95%'</span></span>
<span id="cb1-105"><a href="#cb1-105"></a><span class="co">#| fig.cap: '共轭先验的PDF特性概览. 左图为 PDF 的完整形态, 右图为其对应的等高线表示.'</span></span>
<span id="cb1-106"><a href="#cb1-106"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/Gamma/ITR2025/config.pdf"</span>)</span>
<span id="cb1-107"><a href="#cb1-107"></a><span class="in">```</span></span>
<span id="cb1-108"><a href="#cb1-108"></a></span>
<span id="cb1-109"><a href="#cb1-109"></a><span class="fu">### 后验抽样 {#sec-ITR2025-ps}</span></span>
<span id="cb1-110"><a href="#cb1-110"></a></span>
<span id="cb1-111"><a href="#cb1-111"></a>由于后验分布 $\pi(\alpha,\beta \mid \bm{y})$ 无法得到解析形式, 直接计算 $\alpha$ 和 $\beta$ 的贝叶斯\index{贝叶斯}估计变得不可行. 蒙特卡罗方法为处理这种难以解析的后验分布提供了一种可行的替代推断手段. 该方法的核心思想是从参数的联合后验分布中抽取随机样本, 并利用这些样本对参数或其函数进行点估计和区间估计. 本节将介绍三种用于产生AGG分布随机数的算法.</span>
<span id="cb1-112"><a href="#cb1-112"></a></span>
<span id="cb1-113"><a href="#cb1-113"></a><span class="fu">#### Gibbs 采样</span></span>
<span id="cb1-114"><a href="#cb1-114"></a></span>
<span id="cb1-115"><a href="#cb1-115"></a>Gibbs采样是一种特殊的马尔可夫链蒙特卡罗 (Monte Carlo Markov chain, MCMC\index{MCMC}) 方法, 其通过从完全条件后验密度 $\pi(\beta \mid \alpha,\bm{y})$ 和 $\pi(\alpha \mid \beta,\bm{y})$迭代抽样来实现. 根据式 \eqref{deco0}, 完全条件后验密度 $\pi(\beta \mid \alpha,\bm{y})$ 是一个伽马分布\index{伽马分布} $Ga(\delta_p\bar{T}_m\alpha,\delta_p\lambda_p)$ ; 而 $\pi(\alpha \mid \beta,\bm{y})$ 的完全条件后验密度与下式成比例 $$\dfrac{(\beta\omega_p)^{\delta_p \overline{T}_m\alpha}}{\left[\prod_{j=1}^{m}\left(\Gamma(\alpha t_j)\right)^{1/m}\right]^{\delta_p}}.</span>
<span id="cb1-116"><a href="#cb1-116"></a>$$ 可以证明 $\pi(\alpha \mid \beta,\bm{y})$ 具有对数凹的性质. 因此, 可以利用自适应拒绝采样 (Adaptive synthetic sampling, ARS) 算法生成 $\pi(\alpha \mid \beta,\bm{y})$ 的随机样本<span class="co">[</span><span class="ot">@gilwil1992</span><span class="co">]</span>. 在获得 $\alpha$ 和 $\beta$ 的后验样本后, 可构造任何参数的函数 $\eta=p(\alpha,\beta)$ (例如: 产品的可靠度\index{可靠度}、MTTF) 的贝叶斯\index{贝叶斯}估计. Gibbs 采样的后验推断过程详见算法 \ref{ITR2025-algo1}.</span>
<span id="cb1-117"><a href="#cb1-117"></a></span>
<span id="cb1-118"><a href="#cb1-118"></a><span class="fu">#### 离散网格采样</span></span>
<span id="cb1-119"><a href="#cb1-119"></a></span>
<span id="cb1-120"><a href="#cb1-120"></a>后验分布 $\pi(\alpha,\beta \mid \bm{y})$ 可表示为条件分布 $\pi(\beta \mid \alpha,\bm{y})$ 与边缘分布 $\pi(\alpha \mid \bm{y})$ 的乘积, 即 $\pi(\alpha, \beta \mid \bm{y}) = \pi(\beta \mid \alpha, \bm{y}) \pi(\alpha \mid \bm{y})$, 其中 $\pi(\beta \mid \alpha,\bm{y})$ 为 $Ga(\delta_p\bar{T}_m\alpha, \delta_p\lambda_p)$, $\pi(\alpha \mid \bm{y})$ 与以下函数成比例: \begin{equation}\label{pmargi}</span>
<span id="cb1-121"><a href="#cb1-121"></a>    h_p(\alpha)=\dfrac{\left(\dfrac{\omega_p}{\delta_p\lambda_p}\right)^{\delta_p \overline{T}_m\alpha}\Gamma\left(1+\delta_p \overline{T}_m\alpha\right)}{\left[\prod_{j=1}^{m}\left(\Gamma(\alpha t_j)\right)^{1/m}\right]^{\delta_p}}.</span>
<span id="cb1-122"><a href="#cb1-122"></a>\end{equation} 根据上述分解, 当给定从 $\pi(\alpha \mid \bm{y})$ 生成的随机样本 $\alpha_0$时, 可直接从 $Ga(\delta_p\bar{T}_m\alpha_0,\delta_p\lambda_p)$ 中生成$\beta$ 的随机样本. 因此, 目前主要挑战在于生成 $\alpha$ 的随机样本. 由于 $\pi(\alpha \mid \bm{y})$ 具有复杂性, 本节提出一种简便的离散网格采样法(Discrete grid sampling, DGS): 通过在一系列网格点上构建离散分布来近似 $\alpha$ 的边缘后验分布, 从而实现 $\alpha$ 的统计推断. 具体方法如下: 首先, 选取一个区间 $[A_1, A_2]$, 使$\alpha$落入该区间的概率接近1, 即, 计算定积分 $\int_{A_1}^{A_2}\pi(\alpha \mid \bm{y})\text{d}\alpha$的值是否接近1. 区间 $<span class="co">[</span><span class="ot">A_1, A_2</span><span class="co">]</span>$可利用六西格玛法来确定, 具体步骤如下:</span>
<span id="cb1-123"><a href="#cb1-123"></a></span>
<span id="cb1-124"><a href="#cb1-124"></a>(a) 确定 $\tilde{\alpha}=\mathop{\arg\max}\limits_{\alpha} \log h_p(\alpha)$, 以及 $$I\left(\tilde{\alpha}\right)=-\dfrac{\partial^2\log h_p(\alpha)}{\partial \alpha^2}\biggl|_{\alpha=\tilde{\alpha}}.</span>
<span id="cb1-125"><a href="#cb1-125"></a>    $$</span>
<span id="cb1-126"><a href="#cb1-126"></a></span>
<span id="cb1-127"><a href="#cb1-127"></a>(b) 根据 <span class="co">[</span><span class="ot">@berger2013</span><span class="co">]</span> 的研究, $\pi(\alpha \mid \bm{y})$ 可以用正态分布\index{正态分布} $N\left(\tilde{\alpha},\tilde{\sigma}^2\right)$ 近似, 其中 $\tilde{\sigma}=\sqrt{1/I\left(\tilde{\alpha}\right)}$.</span>
<span id="cb1-128"><a href="#cb1-128"></a></span>
<span id="cb1-129"><a href="#cb1-129"></a>(c) 构建区间 $A_1=\max{0,\tilde{\alpha}-6\tilde{\sigma}}$ 和 $A_2=\tilde{\alpha}+6\tilde{\sigma}$. 根据正态分布\index{正态分布}的性质, 可知 $\alpha$ 落在区间 $<span class="co">[</span><span class="ot">A_1,A_2</span><span class="co">]</span>$ 内的概率几乎为 1.</span>
<span id="cb1-130"><a href="#cb1-130"></a></span>
<span id="cb1-131"><a href="#cb1-131"></a>在区间 $<span class="co">[</span><span class="ot">A_1, A_2</span><span class="co">]</span>$ 内选择 $M$ 个等间距网格点 $\left<span class="sc">\{</span>A_1=\alpha^{(1)},\alpha^{(2)},\dots,A_2=\alpha^{(M)}\right<span class="sc">\}</span>$, 并使用未标准化的后验密度 $h_p(\alpha)$ 计算每个网格点的概率 \begin{equation}\label{disalp}</span>
<span id="cb1-132"><a href="#cb1-132"></a>    P(\alpha=\alpha^{(s)})=\dfrac{h_p\left(\alpha^{(s)}\right)}{\sum_{i=1}^{M}h_p\left(\alpha^{(i)}\right)}, \quad s=1,\dots,M.</span>
<span id="cb1-133"><a href="#cb1-133"></a>\end{equation} 通过选择足够大的 $M$, 可以确保离散分布的近似精度. 通过离散分布采样显著简化了从 $\pi(\alpha \mid \bm{y})$ 中抽样的难度. 例如, 在 R 语言中, 可以直接使用 \texttt{sample()} 函数来模拟随机样本. 上述方法的核心是将复杂的连续分布转换为易操作的离散分布, 显著降低了抽样的计算复杂度. 基于该方法的后验推断过程可见算法 \ref{ITR2025-algo2}.</span>
<span id="cb1-134"><a href="#cb1-134"></a></span>
<span id="cb1-135"><a href="#cb1-135"></a><span class="fu">#### 重要性重采样</span></span>
<span id="cb1-136"><a href="#cb1-136"></a></span>
<span id="cb1-137"><a href="#cb1-137"></a>第三种算法与第二种算法的主要区别在于生成 $\pi(\alpha \mid \bm{y})$ 后验样本的方法, 该算法采用了重要性重采样 (Sampling Importance Resampling, SIR) 方法. 在 SIR 中, 采样步骤首先从辅助分布 $g(\alpha)$ 中生成一组随机数, 然后通过重新计算权重, 将其近似为来自 $\pi(\alpha \mid \bm{y})$ 的样本. 辅助分布 $g(\alpha)$ 的选择较为灵活, 可以从一组易于抽样的分布中选取. 然而, SIR 方法的效率取决于 $g(\alpha)$ 和 $\pi(\alpha \mid \bm{y})$ 的相似程度, 尤其是分布尾部的相似性会影响近似的精度. 从式 \eqref{appro0} 可知, $\pi(\alpha \mid \bm{y})$ 的尾部形式 (当 $\alpha \rightarrow \infty$ 时) 与形状参数 $(\delta_p+3)/2$ 和尺度参数 $$</span>
<span id="cb1-138"><a href="#cb1-138"></a>\nu=\delta_p\overline{T}m \left<span class="co">[</span><span class="ot">\log\left(\frac{\lambda_p}{\omega_p}\right)+\log\left(\frac{\prod{j=1}^{m}t_j^{t_j/T_m}}{\overline{T}_m}\right)\right</span><span class="co">]</span></span>
<span id="cb1-139"><a href="#cb1-139"></a>$$ 的伽马分布\index{伽马分布}尾部同阶. 因此, 伽马分布\index{伽马分布} $Ga(a, b)$ 是一个合适的辅助分布, 其参数 $a$ 和 $b$ 可以通过以下步骤来确定:</span>
<span id="cb1-140"><a href="#cb1-140"></a></span>
<span id="cb1-141"><a href="#cb1-141"></a>(a) 令 $\tilde{\alpha}=\mathop{\arg\max}\limits_{\alpha} \log h_p(\alpha)$, 并计算 $$</span>
<span id="cb1-142"><a href="#cb1-142"></a>    I\left(\tilde{\alpha}\right)=-\dfrac{\partial^2\log h_p(\alpha)}{\partial \alpha^2}\biggl|_{\alpha=\tilde{\alpha}}.</span>
<span id="cb1-143"><a href="#cb1-143"></a>    $$</span>
<span id="cb1-144"><a href="#cb1-144"></a></span>
<span id="cb1-145"><a href="#cb1-145"></a>(b) 初始化 $b$ 为 $b_0=\nu$, 并初始化 $a$ 为 $a_0=\tilde{\alpha}b_0$. 确保辅助分布 $Ga(a_0,b_0)$ 的均值为 $\tilde{\alpha}$.</span>
<span id="cb1-146"><a href="#cb1-146"></a></span>
<span id="cb1-147"><a href="#cb1-147"></a>(c) 计算精度比 $R=\frac{b_0^2/a_0}{I\left(\tilde{\alpha}\right)}$, 然后更新参数 $a=a_0/R$ 和 $b=b_0/R$. 该步骤不会改变辅助分布的均值, 但可以使 $Ga(a, b)$ 的方差与 $\pi(\alpha \mid \bm{y})$ 的渐近方差一致.</span>
<span id="cb1-148"><a href="#cb1-148"></a></span>
<span id="cb1-149"><a href="#cb1-149"></a>通过以上步骤确定了辅助分布 $Ga(a, b)$, 并从中产生 $M$ 个随机样本 $\left<span class="sc">\{</span>\alpha^{(1)},\alpha^{(2)},\dots,\alpha^{(M)}\right<span class="sc">\}</span>$. 计算权重 $w_i=h_p\left(\alpha^{(i)}\right)/f_{Ga}\left(\alpha^{(i)} \mid a,b\right)$, $i=1,\dots,M$, 其中 $f_{Ga}\left(\alpha^{(i)} \mid a,b\right)$ 表示 $Ga(a,b)$ 在 $\alpha^{(i)}$ 处的PDF值. 对权重进行归一化, 得到 $\tilde{w}_i=w_i/\sum_{j=1}^{M}w_j$. 最后, 从离散分布中生成 $\alpha$ 的随机样本, 其分布律为 \begin{equation}\label{dis2}</span>
<span id="cb1-150"><a href="#cb1-150"></a>    P\left(\alpha=\alpha^{(i)}\right)=\tilde{w}_i,~i=1,2,\dots,M.</span>
<span id="cb1-151"><a href="#cb1-151"></a>\end{equation} SIR 算法的后验推断过程可见算法 \ref{ITR2025-algo3}.</span>
<span id="cb1-152"><a href="#cb1-152"></a></span>
<span id="cb1-153"><a href="#cb1-153"></a><span class="fu">### 模拟实验 {#sec-ITR2025-sim}</span></span>
<span id="cb1-154"><a href="#cb1-154"></a></span>
<span id="cb1-155"><a href="#cb1-155"></a>在开展模拟研究之前, 首先利用所提方法分析激光退化数据, 其退化路径如图 @fig-fig:laser2 所示, 其中 $n=15$, $m=16$, $\omega=10$. <span class="co">&lt;!-- 从图中可以看到有三个器件在测试终止时间之前, 退化值已经超过了阈值.  --&gt;</span> 在应用伽马过程\index{伽马过程}拟合数据之前, 首先, 通过Kolmogorov-Smirnov检验来验证数据是否符合伽马过程\index{伽马过程}的 假设<span class="co">[</span><span class="ot">@wangetal03</span><span class="co">]</span>. 由于该数据集中所有 $t_j$ 的值均为 250 小时, 因此 $y_{ij} \sim Ga(250\alpha, \beta)$. 使用 *R* 软件中的 *ks.test()* 函数进行检验, 得到 p 值为 0.13, 大于显著性水平 0.05. 这表明伽马过程\index{伽马过程}能够用来拟合该数据. 因此, 假设激光器件的退化路径服从伽马过程\index{伽马过程} $\mathcal{GP}(\alpha t,\beta)$. 接着, 基于共轭先验\index{先验} \eqref{con0} 进行贝叶斯\index{贝叶斯}推断, 其中设定 $\delta=1$ 且 $\lambda=\bar{y}_a$. 由于数据是等间隔测量的, 因此 $\omega=\bar{y}_g=\prod_{i=1}^{n}\prod_{1}^{m}y_{ij}^{1/(mn)}$, 即 $\{y_{ij}, i=1,\dots,15,j=1,\dots,16\}$ 的几何平均值. 在第 @sec-ITR2025-prior 节中曾讨论过, $\delta=1$ 表示先验\index{先验}信息仅相当于一次测量的信息量, 与总计 $mn$ 次测量数据相比, 先验\index{先验}信息较弱. 因此, $\alpha$ 和 $\beta$ 的后验分布为 $\textrm{AGG}\left(mn+1,\prod_{i=1}^{n}\prod_{1}^{m}y_{ij}^{1/(mn)},\bar{y}_a\right)$. 利用上述三种算法分别得到 $\alpha$ 和 $\beta$ 的点估计及其 95% 区间估计, 同时估计 4500 ( 小时) 时设备的可靠度\index{可靠度} $R(4500)$. 估计结果列在表 \ref{tbl-tab:dat1}中 (其中"GS" 表示基于 Gibbs 采样的算法). 在 Gibbs 采样中, 设定迭代次数 $K_1$ 为 3000, 其中前 1000 次迭代作为预烧样本\index{预烧样本}舍弃, 并设定稀释(thinning)间隔为2, 最终保留 1000 个有效样本用于后验推断. 在 DGS 中, 离散化区间为 $<span class="co">[</span><span class="ot">0,10</span><span class="co">]</span>$, 网格点数量设为 10000, 后验推断的样本量同样为 1000. 在 SIR 中, 设定 $M=10,000$, 并从中重采样 $K_3=1,000$个样本. 正如表 \ref{tbl-tab:dat1} 所示, 三种算法下 $\alpha$、$\beta$ 和 $R(4500)$ 的贝叶斯\index{贝叶斯}点估计及 95%区间估计上均表现出高度一致性.</span>
<span id="cb1-156"><a href="#cb1-156"></a></span>
<span id="cb1-157"><a href="#cb1-157"></a><span class="in">```{=latex}</span></span>
<span id="cb1-158"><a href="#cb1-158"></a><span class="in">\begin{table}</span></span>
<span id="cb1-159"><a href="#cb1-159"></a><span class="in">    \centering</span></span>
<span id="cb1-160"><a href="#cb1-160"></a><span class="in">    \caption{$\alpha$、$\beta$ 和 $R(4500)$ 的点估计及其 95\% 置信区间. }\label{tbl-tab:dat1}</span></span>
<span id="cb1-161"><a href="#cb1-161"></a><span class="in">    \renewcommand{\arraystretch}{1.25}</span></span>
<span id="cb1-162"><a href="#cb1-162"></a><span class="in">  \vskip 0mm \setlength{\tabcolsep}{1.2mm}</span></span>
<span id="cb1-163"><a href="#cb1-163"></a><span class="in">    \begin{tabular}{cccccccccc}</span></span>
<span id="cb1-164"><a href="#cb1-164"></a><span class="in">            \hline </span></span>
<span id="cb1-165"><a href="#cb1-165"></a><span class="in">            \multirow{2}[4]{*}{估计值} &amp; \multicolumn{3}{c}{GS算法} &amp; \multicolumn{3}{c}{DGS算法} &amp; \multicolumn{3}{c}{SIR算法} \\</span></span>
<span id="cb1-166"><a href="#cb1-166"></a><span class="in">            \cline{2-10}</span></span>
<span id="cb1-167"><a href="#cb1-167"></a><span class="in">            &amp;</span></span>
<span id="cb1-168"><a href="#cb1-168"></a><span class="in">            $\alpha$    &amp; $\beta$  &amp; $R(4500)$  &amp; $\alpha$  &amp; $\beta$  &amp; $R(4500)$ &amp;$\alpha$    &amp; $\beta$  &amp; $R(4500)$  \\</span></span>
<span id="cb1-169"><a href="#cb1-169"></a><span class="in">            \hline</span></span>
<span id="cb1-170"><a href="#cb1-170"></a><span class="in">            Point &amp;  0.0309&amp;15.342&amp;0.879&amp; 0.0308&amp;15.325&amp;0.878&amp;0.0310&amp;15.438&amp;0.882\\</span></span>
<span id="cb1-171"><a href="#cb1-171"></a><span class="in">            2.5\%  &amp; 0.0258&amp;12.693&amp; 0.740&amp; 0.0260&amp;12.698&amp;0.737&amp;0.0256&amp;12.677&amp; 0.743\\</span></span>
<span id="cb1-172"><a href="#cb1-172"></a><span class="in">            97.5\% &amp; 0.0366&amp;18.332&amp;0.963&amp; 0.0370&amp;18.328&amp;0.962&amp;0.0366&amp;18.368&amp;0.964\\</span></span>
<span id="cb1-173"><a href="#cb1-173"></a><span class="in">            \hline </span></span>
<span id="cb1-174"><a href="#cb1-174"></a><span class="in">    \end{tabular}</span></span>
<span id="cb1-175"><a href="#cb1-175"></a><span class="in">\end{table}</span></span>
<span id="cb1-176"><a href="#cb1-176"></a><span class="in">```</span></span>
<span id="cb1-177"><a href="#cb1-177"></a>为了更全面地比较这三种算法, 本节在具有不同信息量的共轭先验\index{先验}下进行了模拟研究. 数据通过伽马过程\index{伽马过程} $\mathcal{GP}(\alpha t,\beta)$生成, 参数设定为 $\alpha=0.031$ 和 $\beta=15.35$ (接近表 \ref{tbl-tab:dat1} 中的估计值). 实验中, 共对 $n=15$ 个样本进行了测试, 每个样本以 250 小时的间隔进行测量, 总计进行了 $m=16$ 次测量, 并将失效阈值设定为 10. 采用共轭先验\index{先验}分布 $\textrm{AGG}(\delta,\bar{y}_g, \bar{y}_a)$, 通过设定$\delta=0,1,m/4,m/2$ 来评估先验\index{先验}信息量对结果的影响.</span>
<span id="cb1-178"><a href="#cb1-178"></a></span>
<span id="cb1-179"><a href="#cb1-179"></a>随机生成了 $N=10000$ 个数据集, 并应用所提出的算法进行分析, 得到 $\alpha$、$\beta$、$R(4500)$ 和 MTTF 的贝叶斯\index{贝叶斯}点估计及其 95% 区间估计. 基于这些估计结果, 计算了相对偏差 (Relative bias, RB) 和 RMSE, 结果分别列于表 \ref{tbl-tab:arb} 和表 \ref{tbl-tab:rmse}. 在所有情况下, 参数估计均表现出令人满意的效果: $\alpha$、$\beta$ 和 $R(4500)$ 的贝叶斯\index{贝叶斯}估计的 RB 约为 2%, 而 MTTF 的贝叶斯\index{贝叶斯}估计的 RB 约为 0.1%. 三种算法在 RB 和 RMSE 上的表现几乎一致, 且先验\index{先验}信息量 $\delta$ 的变化对估计结果的影响不显著.</span>
<span id="cb1-180"><a href="#cb1-180"></a></span>
<span id="cb1-181"><a href="#cb1-181"></a>在评估参数的区间估计时, 计算了 95% 可信区间\index{可信区间}的平均长度和CP. 结果分别列在表 \ref{tbl-tab:length} 和表 \ref{tbl-tab:cp}. 分析发现, 随着先验\index{先验}信息量的增加, 95% 置信区间\index{置信区间}的长度逐渐减小, 且三种算法在这一趋势上表现相似, 差异不显著. 然而, 在覆盖概率方面, 不同算法表现出一定差异. 对于模型参数 $\alpha$ 和 $\beta$, 无论先验\index{先验}信息量 $\delta$ 的变化如何, 基于DGS和SIR算法的覆盖概率更接近理想的95%水平, 而基于GS算法的覆盖概率则相对较低. 对于 $R(4500)$ 和 MTTF的估计, 三种算法的覆盖概率均接近名义水平(即, 95%), 表明所提出的后验采样算法在这些指标估计中具有较高的准确性.</span>
<span id="cb1-182"><a href="#cb1-182"></a></span>
<span id="cb1-183"><a href="#cb1-183"></a><span class="in">```{=latex}</span></span>
<span id="cb1-184"><a href="#cb1-184"></a><span class="in">\begin{table}</span></span>
<span id="cb1-185"><a href="#cb1-185"></a><span class="in">    \centering</span></span>
<span id="cb1-186"><a href="#cb1-186"></a><span class="in">    \caption{参数点估计的相对偏差.}\label{tbl-tab:arb}</span></span>
<span id="cb1-187"><a href="#cb1-187"></a><span class="in">    \renewcommand{\arraystretch}{1.25}</span></span>
<span id="cb1-188"><a href="#cb1-188"></a><span class="in">  \vskip 0mm \setlength{\tabcolsep}{1.4mm}</span></span>
<span id="cb1-189"><a href="#cb1-189"></a><span class="in">    \begin{tabular}{ccccccccc}</span></span>
<span id="cb1-190"><a href="#cb1-190"></a><span class="in">            \hline </span></span>
<span id="cb1-191"><a href="#cb1-191"></a><span class="in">            \multirow{2}[4]{*}{算法} &amp; \multicolumn{4}{c}{$\delta=0$} &amp; \multicolumn{4}{c}{$\delta=1$} \\</span></span>
<span id="cb1-192"><a href="#cb1-192"></a><span class="in">            \cline{2-9}</span></span>
<span id="cb1-193"><a href="#cb1-193"></a><span class="in">            &amp;</span></span>
<span id="cb1-194"><a href="#cb1-194"></a><span class="in">            $\alpha$    &amp; $\beta$  &amp; $R(4500)$ &amp; MTTF &amp; $\alpha$    &amp; $\beta$  &amp; $R(4500)$ &amp; MTTF \\</span></span>
<span id="cb1-195"><a href="#cb1-195"></a><span class="in">            \hline</span></span>
<span id="cb1-196"><a href="#cb1-196"></a><span class="in">            GS &amp;  0.0245&amp;   0.0256  &amp; 0.0161&amp;  0.00109&amp; 0.0243&amp; 0.0254&amp;  0.0161&amp;    0.00108\\</span></span>
<span id="cb1-197"><a href="#cb1-197"></a><span class="in">            DGS  &amp; 0.0245&amp;  0.0256&amp;  0.0161&amp;    0.0011&amp; 0.0245&amp; 0.0256&amp; 0.0161&amp; 0.00109\\</span></span>
<span id="cb1-198"><a href="#cb1-198"></a><span class="in">            SIR &amp; 0.0245&amp;   0.0256&amp; 0.0161&amp; 0.00109&amp;    0.0245&amp; 0.0256&amp; 0.0161&amp; 0.00109\\</span></span>
<span id="cb1-199"><a href="#cb1-199"></a><span class="in">            \hline</span></span>
<span id="cb1-200"><a href="#cb1-200"></a><span class="in">            \multirow{2}[4]{*}{算法} &amp; \multicolumn{4}{c}{$\delta=\frac{m}{4}$} &amp; \multicolumn{4}{c}{$\delta=\frac{m}{2}$} \\</span></span>
<span id="cb1-201"><a href="#cb1-201"></a><span class="in">            \cline{2-9}</span></span>
<span id="cb1-202"><a href="#cb1-202"></a><span class="in">            &amp;</span></span>
<span id="cb1-203"><a href="#cb1-203"></a><span class="in">            $\alpha$    &amp; $\beta$  &amp; $R(4500)$ &amp; MTTF &amp; $\alpha$    &amp; $\beta$  &amp; $R(4500)$ &amp; MTTF \\</span></span>
<span id="cb1-204"><a href="#cb1-204"></a><span class="in">            \hline</span></span>
<span id="cb1-205"><a href="#cb1-205"></a><span class="in">            GS &amp;  0.0233&amp;   0.0247&amp; 0.0153&amp; 0.00136&amp;    0.0234&amp; 0.0248&amp; 0.0151&amp; 0.00137\\</span></span>
<span id="cb1-206"><a href="#cb1-206"></a><span class="in">            DGS  &amp; 0.0234&amp;  0.0249&amp; 0.0152&amp; 0.00137&amp;    0.0233&amp; 0.0247&amp; 0.0151&amp; 0.00136\\</span></span>
<span id="cb1-207"><a href="#cb1-207"></a><span class="in">            SIR &amp; 0.0234&amp;   0.0249&amp; 0.0152&amp; 0.00138&amp;    0.0232&amp; 0.0246&amp; 0.0151&amp; 0.00136\\</span></span>
<span id="cb1-208"><a href="#cb1-208"></a><span class="in">            \hline</span></span>
<span id="cb1-209"><a href="#cb1-209"></a><span class="in">    \end{tabular}</span></span>
<span id="cb1-210"><a href="#cb1-210"></a><span class="in">\end{table}</span></span>
<span id="cb1-211"><a href="#cb1-211"></a><span class="in">```</span></span>
<span id="cb1-212"><a href="#cb1-212"></a><span class="in">```{=latex}</span></span>
<span id="cb1-213"><a href="#cb1-213"></a><span class="in">\begin{table}</span></span>
<span id="cb1-214"><a href="#cb1-214"></a><span class="in">    \centering</span></span>
<span id="cb1-215"><a href="#cb1-215"></a><span class="in">    \caption{参数点估计的RMSE. }\label{tbl-tab:rmse}</span></span>
<span id="cb1-216"><a href="#cb1-216"></a><span class="in">    \renewcommand{\arraystretch}{1.25}</span></span>
<span id="cb1-217"><a href="#cb1-217"></a><span class="in"> \vskip 0mm \setlength{\tabcolsep}{1.2mm}</span></span>
<span id="cb1-218"><a href="#cb1-218"></a><span class="in">  \begin{tabular}{ccccccccc}</span></span>
<span id="cb1-219"><a href="#cb1-219"></a><span class="in">            \hline</span></span>
<span id="cb1-220"><a href="#cb1-220"></a><span class="in">            \multirow{2}[4]{*}{算法} &amp; \multicolumn{4}{c}{$\delta=0$} &amp; \multicolumn{4}{c}{$\delta=1$} \\</span></span>
<span id="cb1-221"><a href="#cb1-221"></a><span class="in">            \cline{2-9}</span></span>
<span id="cb1-222"><a href="#cb1-222"></a><span class="in">            &amp;</span></span>
<span id="cb1-223"><a href="#cb1-223"></a><span class="in">            $\alpha$    &amp; $\beta$  &amp; $R(4500)$ &amp; MTTF &amp; $\alpha$    &amp; $\beta$  &amp; $R(4500)$ &amp; MTTF \\</span></span>
<span id="cb1-224"><a href="#cb1-224"></a><span class="in">            \hline</span></span>
<span id="cb1-225"><a href="#cb1-225"></a><span class="in">            GS &amp;  0.00302&amp;  1.547&amp;  0.0601&amp; 115.218&amp;    0.00302&amp;    1.547&amp;  0.0601&amp; 115.205\\</span></span>
<span id="cb1-226"><a href="#cb1-226"></a><span class="in">            DGS  &amp; 0.00301&amp;1.539&amp;0.0601&amp;    115.267&amp;    0.00301&amp;    1.538&amp;  0.0601&amp; 115.258\\</span></span>
<span id="cb1-227"><a href="#cb1-227"></a><span class="in">            SIR &amp; 0.00301&amp;  1.539&amp;  0.0601&amp; 115.267&amp;    0.00301&amp;    1.538&amp;  0.0601&amp; 115.258\\</span></span>
<span id="cb1-228"><a href="#cb1-228"></a><span class="in">            \hline</span></span>
<span id="cb1-229"><a href="#cb1-229"></a><span class="in">            \multirow{2}[4]{*}{算法} &amp; \multicolumn{4}{c}{$\delta=\frac{m}{4}$} &amp; \multicolumn{4}{c}{$\delta=\frac{m}{2}$} \\</span></span>
<span id="cb1-230"><a href="#cb1-230"></a><span class="in">            \cline{2-9}</span></span>
<span id="cb1-231"><a href="#cb1-231"></a><span class="in">            &amp;</span></span>
<span id="cb1-232"><a href="#cb1-232"></a><span class="in">            $\alpha$    &amp; $\beta$  &amp; $R(4500)$ &amp; MTTF &amp; $\alpha$    &amp; $\beta$  &amp; $R(4500)$ &amp; MTTF \\</span></span>
<span id="cb1-233"><a href="#cb1-233"></a><span class="in">            \hline</span></span>
<span id="cb1-234"><a href="#cb1-234"></a><span class="in">            GS &amp;  0.00302&amp;1.546&amp;    0.0599&amp; 115.204&amp;    0.00296&amp;    1.512&amp;  0.0607&amp; 116.192\\</span></span>
<span id="cb1-235"><a href="#cb1-235"></a><span class="in">            DGS  &amp; 0.00301&amp; 1.537&amp;0.0600&amp;115.250&amp;   0.00294&amp;1.501&amp;  0.0607&amp; 116.205\\</span></span>
<span id="cb1-236"><a href="#cb1-236"></a><span class="in">            SIR &amp; 0.00301&amp;  1.537&amp;  0.0600&amp; 115.250&amp;    0.00294&amp;    1.501&amp;  0.0607&amp; 116.205\\</span></span>
<span id="cb1-237"><a href="#cb1-237"></a><span class="in">            \hline </span></span>
<span id="cb1-238"><a href="#cb1-238"></a><span class="in">    \end{tabular}</span></span>
<span id="cb1-239"><a href="#cb1-239"></a><span class="in">\end{table}</span></span>
<span id="cb1-240"><a href="#cb1-240"></a><span class="in">```</span></span>
<span id="cb1-241"><a href="#cb1-241"></a><span class="in">```{=latex}</span></span>
<span id="cb1-242"><a href="#cb1-242"></a><span class="in"> \begin{table}</span></span>
<span id="cb1-243"><a href="#cb1-243"></a><span class="in">    \centering</span></span>
<span id="cb1-244"><a href="#cb1-244"></a><span class="in">    \caption{参数 95\% 可信区间的长度. }\label{tbl-tab:length}</span></span>
<span id="cb1-245"><a href="#cb1-245"></a><span class="in">    \renewcommand{\arraystretch}{1.25}</span></span>
<span id="cb1-246"><a href="#cb1-246"></a><span class="in"> \vskip 0mm \setlength{\tabcolsep}{1mm}</span></span>
<span id="cb1-247"><a href="#cb1-247"></a><span class="in">    \begin{tabular}{ccccccccc}</span></span>
<span id="cb1-248"><a href="#cb1-248"></a><span class="in">            \hline </span></span>
<span id="cb1-249"><a href="#cb1-249"></a><span class="in">            \multirow{2}[4]{*}{算法} &amp; \multicolumn{4}{c}{$\delta=0$} &amp; \multicolumn{4}{c}{$\delta=1$} \\</span></span>
<span id="cb1-250"><a href="#cb1-250"></a><span class="in">            \cline{2-9}</span></span>
<span id="cb1-251"><a href="#cb1-251"></a><span class="in">            &amp;</span></span>
<span id="cb1-252"><a href="#cb1-252"></a><span class="in">            $\alpha$    &amp; $\beta$  &amp; $R(4500)$ &amp; MTTF &amp; $\alpha$    &amp; $\beta$  &amp; $R(4500)$ &amp; MTTF \\</span></span>
<span id="cb1-253"><a href="#cb1-253"></a><span class="in">            \hline</span></span>
<span id="cb1-254"><a href="#cb1-254"></a><span class="in">            GS &amp;  0.0109&amp;   5.588&amp;  0.224&amp;  447.444&amp;    0.0109&amp; 5.585&amp;  0.224&amp;  446.609\\</span></span>
<span id="cb1-255"><a href="#cb1-255"></a><span class="in">            DGS  &amp; 0.0109&amp;  5.629&amp;  0.224&amp;  446.274 &amp;0.0109&amp;    5.620&amp;  0.223&amp;  445.596\\</span></span>
<span id="cb1-256"><a href="#cb1-256"></a><span class="in">            SIR &amp; 0.0110&amp;   5.630&amp;  0.224&amp;  446.414&amp;    0.0109&amp; 5.624&amp;  0.223&amp;  445.318\\</span></span>
<span id="cb1-257"><a href="#cb1-257"></a><span class="in">            \hline</span></span>
<span id="cb1-258"><a href="#cb1-258"></a><span class="in">            \multirow{2}[4]{*}{算法} &amp; \multicolumn{4}{c}{$\delta=\frac{m}{4}$} &amp; \multicolumn{4}{c}{$\delta=\frac{m}{2}$} \\</span></span>
<span id="cb1-259"><a href="#cb1-259"></a><span class="in">            \cline{2-9}</span></span>
<span id="cb1-260"><a href="#cb1-260"></a><span class="in">            &amp;</span></span>
<span id="cb1-261"><a href="#cb1-261"></a><span class="in">            $\alpha$    &amp; $\beta$  &amp; $R(4500)$ &amp; MTTF &amp; $\alpha$    &amp; $\beta$  &amp; $R(4500)$ &amp; MTTF \\</span></span>
<span id="cb1-262"><a href="#cb1-262"></a><span class="in">            \hline</span></span>
<span id="cb1-263"><a href="#cb1-263"></a><span class="in">            GS &amp;  0.0108&amp;   5.541&amp;  0.222&amp;  444.082&amp;    0.0107&amp; 5.502&amp;  0.220&amp;  440.493\\</span></span>
<span id="cb1-264"><a href="#cb1-264"></a><span class="in">            DGS  &amp; 0.0108&amp;  5.582&amp;  0.221&amp;  443.013 &amp;0.0107&amp;    5.535&amp;  0.219&amp;  439.562\\</span></span>
<span id="cb1-265"><a href="#cb1-265"></a><span class="in">            SIR &amp; 0.0109&amp;   5.581&amp;  0.221&amp;  443.131&amp;    0.0108&amp; 5.536&amp;  0.219&amp;  439.373\\</span></span>
<span id="cb1-266"><a href="#cb1-266"></a><span class="in">            \hline </span></span>
<span id="cb1-267"><a href="#cb1-267"></a><span class="in">    \end{tabular}</span></span>
<span id="cb1-268"><a href="#cb1-268"></a><span class="in">\end{table}</span></span>
<span id="cb1-269"><a href="#cb1-269"></a><span class="in">```</span></span>
<span id="cb1-270"><a href="#cb1-270"></a><span class="in">```{=latex}</span></span>
<span id="cb1-271"><a href="#cb1-271"></a><span class="in"> \begin{table}</span></span>
<span id="cb1-272"><a href="#cb1-272"></a><span class="in">    \centering</span></span>
<span id="cb1-273"><a href="#cb1-273"></a><span class="in">    \caption{参数 95\% 可信区间的覆盖概率. }\label{tbl-tab:cp}</span></span>
<span id="cb1-274"><a href="#cb1-274"></a><span class="in">    \renewcommand{\arraystretch}{1.25}</span></span>
<span id="cb1-275"><a href="#cb1-275"></a><span class="in">  \vskip 0mm \setlength{\tabcolsep}{1mm}</span></span>
<span id="cb1-276"><a href="#cb1-276"></a><span class="in">  \begin{tabular}{ccccccccc}</span></span>
<span id="cb1-277"><a href="#cb1-277"></a><span class="in">            \hline </span></span>
<span id="cb1-278"><a href="#cb1-278"></a><span class="in">            \multirow{2}[4]{*}{算法} &amp; \multicolumn{4}{c}{$\delta=0$} &amp; \multicolumn{4}{c}{$\delta=1$} \\</span></span>
<span id="cb1-279"><a href="#cb1-279"></a><span class="in">            \cline{2-9}</span></span>
<span id="cb1-280"><a href="#cb1-280"></a><span class="in">            &amp;</span></span>
<span id="cb1-281"><a href="#cb1-281"></a><span class="in">            $\alpha$    &amp; $\beta$  &amp; $R(4500)$ &amp; MTTF &amp; $\alpha$    &amp; $\beta$  &amp; $R(4500)$ &amp; MTTF \\</span></span>
<span id="cb1-282"><a href="#cb1-282"></a><span class="in">            \hline</span></span>
<span id="cb1-283"><a href="#cb1-283"></a><span class="in">            GS &amp;  0.9372&amp;   0.9369&amp; 0.9474&amp; 0.9492&amp; 0.9344&amp; 0.9336&amp; 0.9458&amp; 0.9475\\</span></span>
<span id="cb1-284"><a href="#cb1-284"></a><span class="in">            DGS  &amp; 0.9424&amp;  0.9424&amp; 0.9463&amp; 0.9481&amp; 0.9416&amp; 0.9396&amp; 0.9460&amp; 0.9468\\</span></span>
<span id="cb1-285"><a href="#cb1-285"></a><span class="in">            SIR &amp; 0.9418&amp;   0.9406&amp; 0.9467&amp; 0.9473&amp; 0.9411&amp; 0.9413&amp; 0.9471&amp; 0.9484\\</span></span>
<span id="cb1-286"><a href="#cb1-286"></a><span class="in">            \hline</span></span>
<span id="cb1-287"><a href="#cb1-287"></a><span class="in">            \multirow{2}[4]{*}{算法} &amp; \multicolumn{4}{c}{$\delta=\frac{m}{4}$} &amp; \multicolumn{4}{c}{$\delta=\frac{m}{2}$} \\</span></span>
<span id="cb1-288"><a href="#cb1-288"></a><span class="in">            \cline{2-9}</span></span>
<span id="cb1-289"><a href="#cb1-289"></a><span class="in">            &amp;</span></span>
<span id="cb1-290"><a href="#cb1-290"></a><span class="in">            $\alpha$    &amp; $\beta$  &amp; $R(4500)$ &amp; MTTF &amp; $\alpha$    &amp; $\beta$  &amp; $R(4500)$ &amp; MTTF \\</span></span>
<span id="cb1-291"><a href="#cb1-291"></a><span class="in">            \hline</span></span>
<span id="cb1-292"><a href="#cb1-292"></a><span class="in">            GS &amp;  0.9340&amp;   0.9337&amp; 0.9455&amp; 0.9478&amp; 0.9385&amp; 0.9369&amp; 0.9399&amp; 0.9413\\</span></span>
<span id="cb1-293"><a href="#cb1-293"></a><span class="in">            DGS  &amp; 0.9394&amp;  0.9384&amp; 0.9454&amp; 0.9466&amp; 0.9434&amp; 0.9428&amp; 0.9411&amp; 0.9423\\</span></span>
<span id="cb1-294"><a href="#cb1-294"></a><span class="in">            SIR &amp; 0.9406&amp;   0.9384&amp; 0.9451&amp; 0.9456&amp; 0.9451&amp; 0.9424&amp; 0.9415&amp; 0.9427\\</span></span>
<span id="cb1-295"><a href="#cb1-295"></a><span class="in">            \hline </span></span>
<span id="cb1-296"><a href="#cb1-296"></a><span class="in">    \end{tabular}</span></span>
<span id="cb1-297"><a href="#cb1-297"></a><span class="in">\end{table}</span></span>
<span id="cb1-298"><a href="#cb1-298"></a><span class="in">```</span></span>
<span id="cb1-299"><a href="#cb1-299"></a>在计算效率方面, 三种算法(Gibbs采样、DGS以及SIR)在每个数据集上的平均运行时间分别为0.602 秒、0.00341 秒以及0.00499 秒. 测试环境为运行 Windows 11 操作系统的台式机, 配备 Intel(R) Core(TM) i7-10700 CPU(2.9 GHz) 和 16 GB RAM. 该结果显示, DGS和 SIR 算法的计算效率相近, 并且都显著快于Gibbs算法, 速度提升了超过一百倍. 在实时推断的应用场景中, 计算效率是一个关键因素. 随着新观测数据的不断收集, 需要实时更新后验分布, 同时在保持估计精度的情况下, 尽可能快速完成推断过程. 正如表 \ref{tbl-tab:arb} 至表 \ref{tbl-tab:cp} 所示, DGS和 SIR 算法不仅在计算效率上具有明显优势, 而且在估计精度方面表现优异, 充分满足在线推断的需求. 基于上述结果, 在后续章节中, 将主要采用DGS和 SIR 算法用于在线RUL的预测研究.</span>
<span id="cb1-300"><a href="#cb1-300"></a></span>
<span id="cb1-301"><a href="#cb1-301"></a><span class="fu">### 异质性 {#sec-ITR2025-heter}</span></span>
<span id="cb1-302"><a href="#cb1-302"></a></span>
<span id="cb1-303"><a href="#cb1-303"></a>产品间的异质性\index{异质性}通常源于内在因素和外在因素的差异. 内在因素包括原材料和生产工艺的变化, 而外在因素则涉及操作环境和使用习惯的不同. 这种异质性\index{异质性}导致每个产品的性能退化\index{性能退化}轨迹各不相同. 尽管如此, 由于这些产品源自同一总体, 它们的失效机制通常是一致的. 基于此, 假设第 $i$ 个产品的性能退化\index{性能退化}服从伽马过程\index{伽马过程} $\mathcal{GP}(\alpha t, \beta_i)$. 这里形状参数$\alpha$相同是由于产品失效机制一致, 而不同的尺度参数 $\beta_i$ 则刻画产品间的异质性\index{异质性}. 为简化符号, 假设采用等间隔测量, 即相邻测量时间点的间隔为 $l$. 试验中测试了 $n$ 个产品, 在时间点 $T_m = ml$ 时, 每个产品进行了 $m$ 次测量. 令 $Y_{ij}$ 表示第 $i$ 个产品在时间点 $T_j = jl$ 的退化值, 其中 $i=1, \dots, n$, $j=1, \dots, m$. 定义退化增量为 $y_{ij} = Y_{ij} - Y_{ij-1}$, 并设 $Y_{i0} = 0$. 在时间点 $T_m$处, 记观测数据为 $\bm{y_{(m)}} = <span class="sc">\{</span>y_{ij}, i=1,\dots,n,~j=1,\dots,m<span class="sc">\}</span>$. 由于 $Y_i(t) \sim \mathcal{GP}(\alpha t, \beta_i)$, 可得 $y_{ij} \sim Ga(\alpha l, \beta_i)$. 基于观测数据 $\bm{y_{(m)}}$, 对应的似然函数\index{似然函数}为 \begin{align}\label{like2}</span>
<span id="cb1-304"><a href="#cb1-304"></a>        L\left( \bm{y_{(m)}} \mid \alpha,\beta_1,\dots,\beta_n\right)&amp;=\prod_{i=1}^{n}\prod_{j=1}^{m}\dfrac{\beta_i^{\alpha l}}{\Gamma(\alpha l)}</span>
<span id="cb1-305"><a href="#cb1-305"></a>        y_{ij}^{\alpha l-1}\exp<span class="sc">\{</span>-\beta_i y_{ij}<span class="sc">\}</span>\nonumber<span class="sc">\\</span></span>
<span id="cb1-306"><a href="#cb1-306"></a>        &amp;\propto \dfrac{\bar{\beta}_g^{mnl\alpha}}{\left<span class="co">[</span><span class="ot">\Gamma(\alpha l)\right</span><span class="co">]</span>^{mn}}</span>
<span id="cb1-307"><a href="#cb1-307"></a>        \bar{y}_{g(m)}^{mnl\alpha}\exp\left\{-\sum_{i=1}^{n}m\bar{y}_{i(m)}\beta\right<span class="sc">\}</span>,</span>
<span id="cb1-308"><a href="#cb1-308"></a>\end{align} 其中 \begin{align*}</span>
<span id="cb1-309"><a href="#cb1-309"></a>\bar{\beta}_{g}&amp;=\left[\prod_{i=1}^{n}\beta_{i}\right]^{1/n},</span>
<span id="cb1-310"><a href="#cb1-310"></a>\bar{y}_{g(m)}=\left[\prod_{i=1}^{n}\prod_{j=1}^{m}y_{ij}\right]^{\frac{1}{mn}},<span class="sc">\\</span></span>
<span id="cb1-311"><a href="#cb1-311"></a>\bar{y}_{i(m)}&amp;=\frac{1}{m}\sum_{j=1}^{m}y_{ij}, i=1, \dots, n.</span>
<span id="cb1-312"><a href="#cb1-312"></a>\end{align*}</span>
<span id="cb1-313"><a href="#cb1-313"></a></span>
<span id="cb1-314"><a href="#cb1-314"></a>::: {#thm-ITR2025-th3}</span>
<span id="cb1-315"><a href="#cb1-315"></a>基于似然函数\index{似然函数}\eqref{like2}, $(\alpha,\beta_1,\dots,\beta_n)^{'}$ 的共轭先验\index{先验}为 \begin{equation}\label{con2}</span>
<span id="cb1-316"><a href="#cb1-316"></a>  \begin{aligned}</span>
<span id="cb1-317"><a href="#cb1-317"></a>      \pi(\alpha,\beta_1,\dots,\beta_n)&amp;=</span>
<span id="cb1-318"><a href="#cb1-318"></a>        C \dfrac{\left(\bar{\beta}_g\omega\right)^{\delta_1 l\alpha}}{\left<span class="co">[</span><span class="ot">\Gamma(l\alpha)\right</span><span class="co">]</span>^{\delta_1}}</span>
<span id="cb1-319"><a href="#cb1-319"></a>      \exp\left<span class="sc">\{</span>-\sum_{i=1}^{n}\delta_2\lambda_i\beta_i\right<span class="sc">\}</span>,</span>
<span id="cb1-320"><a href="#cb1-320"></a>  \end{aligned}</span>
<span id="cb1-321"><a href="#cb1-321"></a>\end{equation} 其中$C$ 是正则化常数, $\delta_1$、$\delta_2$、$\omega$ 和 $\lambda_i$ 是非负超参数.</span>
<span id="cb1-322"><a href="#cb1-322"></a>:::</span>
<span id="cb1-323"><a href="#cb1-323"></a></span>
<span id="cb1-324"><a href="#cb1-324"></a>定理 @thm-ITR2025-th3 的证明见本节附录 @sec-Append-3A. 当 $\beta_1=\dots=\beta_n=\beta$, $\delta_1=n\delta_2=\delta$ 且 $\lambda_1=\dots=\lambda_n=\lambda$ 时, 共轭先验\index{先验} \eqref{con2} 简化为 \eqref{con1}. 为了更好地理解共轭先验\index{先验} \eqref{con2}, 可将 $\pi(\alpha,\beta_1,\dots,\beta_n)$ 分解为 \begin{equation*}</span>
<span id="cb1-325"><a href="#cb1-325"></a>\begin{aligned}</span>
<span id="cb1-326"><a href="#cb1-326"></a>        \pi(\alpha,\beta_1,\dots,\beta_n)&amp;=\prod_{i=1}^{n}\pi(\beta_i \mid \alpha)\pi(\alpha)<span class="sc">\\</span></span>
<span id="cb1-327"><a href="#cb1-327"></a>        &amp;\propto\prod_{i=1}^{n}\dfrac{(\delta_2\lambda_i)^{1+\delta_1l\alpha/n}\beta_i^{\delta_1 l\alpha/n}}{\Gamma(1+\delta_1 l\alpha/n)}\exp<span class="sc">\{</span>-\delta_2\lambda_i\beta_i<span class="sc">\}\\</span></span>
<span id="cb1-328"><a href="#cb1-328"></a>        &amp;\ \ \ \ \times \dfrac{\left<span class="co">[</span><span class="ot">\Gamma(1+\delta_1 l\alpha/n)\right</span><span class="co">]</span>^n}{\left<span class="co">[</span><span class="ot">\Gamma(l\alpha)\right</span><span class="co">]</span>^{\delta_1}}\exp\left<span class="sc">\{</span>-\alpha\delta_1 l\left<span class="co">[</span><span class="ot">\log\left(\frac{\delta_2}{\omega}\right)+\frac{1}{n}\sum_{i=1}^{n}\log\lambda_i\right</span><span class="co">]</span>\right<span class="sc">\}</span>.  </span>
<span id="cb1-329"><a href="#cb1-329"></a>\end{aligned}</span>
<span id="cb1-330"><a href="#cb1-330"></a>\end{equation*} 因此, 给定 $\alpha$ 时, $\beta_i$ 的条件分布为 $Ga(1+\delta_1 l\alpha/n,\delta_2\lambda_i)$, 而 $\alpha$ 的边缘PDF与下式成比例 \begin{align}\label{margi2}</span>
<span id="cb1-331"><a href="#cb1-331"></a>    g(\alpha)&amp;=\dfrac{\left<span class="co">[</span><span class="ot">\Gamma(1+\delta_1 l\alpha/n)\right</span><span class="co">]</span>^n}{\left<span class="co">[</span><span class="ot">\Gamma(l\alpha)\right</span><span class="co">]</span>^{\delta_1}}\nonumber<span class="sc">\\</span></span>
<span id="cb1-332"><a href="#cb1-332"></a>    &amp;\quad\times \exp\left<span class="sc">\{</span>-\alpha\delta_1 l\left[\log\left(\frac{\delta_2}{\omega}\right)+</span>
<span id="cb1-333"><a href="#cb1-333"></a>    \frac{1}{n}\sum_{i=1}^{n}\log\lambda_i\right]\right<span class="sc">\}</span>.</span>
<span id="cb1-334"><a href="#cb1-334"></a>\end{align} 利用Stirling公式, 当 $\alpha\rightarrow\infty$ 时, 有 $$</span>
<span id="cb1-335"><a href="#cb1-335"></a>g(\alpha)\equiv O\left(\alpha^{\frac{\delta_1+n}{2}}</span>
<span id="cb1-336"><a href="#cb1-336"></a>\exp\left<span class="sc">\{</span>-A\alpha\right<span class="sc">\}</span>\right), </span>
<span id="cb1-337"><a href="#cb1-337"></a>$$ 其中 $$</span>
<span id="cb1-338"><a href="#cb1-338"></a>A=\delta_1 l\left<span class="co">[</span><span class="ot">\log\left(\frac{n\delta_2}{\delta_1}\right)+\frac{1}{n}\sum_{i=1}^{n}\log\left(\frac{\lambda_i}{\omega}\right)\right</span><span class="co">]</span>.</span>
<span id="cb1-339"><a href="#cb1-339"></a>$$ 因此, 当 $\alpha\rightarrow\infty$时, $\pi(\alpha)$趋于0的速度与伽马分布\index{伽马分布}$\textrm{Ga}\left(\frac{\delta_1+n+2}{2},K\right)$同阶. 因此, 称$\pi(\alpha,\beta_1,\dots,\beta_n)$ 为近似伽马-多元伽马(Approximated-gamma-multivariate gamma, AGMG) 分布, 维度为 $n$, 记作 $\textrm{AGMG}_n(\bm\gamma,\omega,\bm\xi)$, 其中 $\bm\gamma=(\delta_1,\delta_2)^{'}$, $\bm\xi=(\lambda_1,\dots,\lambda_n)^{'}$.</span>
<span id="cb1-340"><a href="#cb1-340"></a></span>
<span id="cb1-341"><a href="#cb1-341"></a>由式 \eqref{post2} 可知, 参数 $(\alpha,\beta_1,\dots,\beta_n)^{'}$ 的后验分布服从 $\textrm{AGMG}_n\left(\bm\gamma_{p(m)}, \omega_{p(m)}, \bm\xi_{p(m)}\right)$, 其中 $\bm\gamma_{p(m)}=(\delta_{1p(m)},\delta_{2p(m)})^{'}$ 和 $\bm\xi_{p(m)}=(\lambda_{1p(m)},\dots,\lambda_{np(m)})^{'}$. 超参数 $\omega$ 和 $\bm\xi$ 的具体选择分别为 $\bar{y}{g(m)}$ 和 $\bm{\bar{y}}{(m)}=\left(\bar{y}{1(m)},\dots,\bar{y}{n(m)}\right)^{'}$. 由于后验分布的形式为 $\textrm{AGMG}_n(\bm\gamma_{p(m)},\bar{y}{g(m)},\bm{\bar{y}}{(m)})$. 在该设置下, 超参数 $\delta_1$ 和 $\delta_2$ 与测量次数有类似的解释. 由等式 \eqref{con1}可知, $\delta_1$ 和 $\delta_2$ 主要决定 AGMG 分布的峰度, 从而控制先验\index{先验}信息的权重. 生成AGMG 分布的随机样本可以通过适当修改算法 \ref{ITR2025-algo2} 和 \ref{ITR2025-algo3} 来实现. 主要区别在于目标分布变更为 $\textrm{AGMG}_n\left(\bm\gamma_{p(m)},\omega_{p(m)},\bm\xi_{p(m)}\right)$ 中 $\alpha$ 的后验边缘分布, 而在给定 $\alpha$时, $\beta_i$则从伽马分布\index{伽马分布} $\textrm{Ga}\left(1+\delta_{1p(m)} l\alpha/n,\delta_{2p(m)}\lambda_{ip(m)}\right)$中产生随机数, 其中 $i=1,\dots,n$. 这两种算法 (DGS 和 SIR) 的计算时间与维度 $n$ 成正比. 为了说明这一点, 本小节在相同的参数设置下, 对 $n$ 从 2 到 50 的 AGMG 分布应用了这两种算法, 并记录了计算时间, 结果如图 @fig-fig:ctime 所示. 从图中可以看出, 计算时间随着 $n$ 的增加而线性增长. 例如, 当 $n$ 从 2 增加到 50 时, DGS 的计算时间从 0.00328 秒增加到 0.00895 秒, 而 SIR 的计算时间从 0.00448 秒增加到 0.0101 秒. 这表明即使在较大的 $n$ 值下, 这两种算法仍然保持着较高的计算效率.</span>
<span id="cb1-342"><a href="#cb1-342"></a></span>
<span id="cb1-345"><a href="#cb1-345"></a><span class="in">```{r}</span></span>
<span id="cb1-346"><a href="#cb1-346"></a><span class="co">#| label: fig-fig:ctime</span></span>
<span id="cb1-347"><a href="#cb1-347"></a><span class="co">#| fig.align: 'center'</span></span>
<span id="cb1-348"><a href="#cb1-348"></a><span class="co">#| echo: FALSE</span></span>
<span id="cb1-349"><a href="#cb1-349"></a><span class="co">#| out.width: '75%'</span></span>
<span id="cb1-350"><a href="#cb1-350"></a><span class="co">#| fig.cap: '不同维度下对 AGMG 分布进行采样的两种算法的计算时间. '</span></span>
<span id="cb1-351"><a href="#cb1-351"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/Gamma/ITR2025/ctime.pdf"</span>)</span>
<span id="cb1-352"><a href="#cb1-352"></a><span class="in">```</span></span>
<span id="cb1-353"><a href="#cb1-353"></a></span>
<span id="cb1-354"><a href="#cb1-354"></a>RUL预测\index{RUL预测}是产品故障\index{故障}诊断与健康管理的核心基础. 在实际应用中, 当产品处于正常工作状态时 ( 即退化量尚未达到失效阈值) , 需要基于实时监测数据动态评估其剩余使用寿命. 具体而言, 假设在时间 $t_m$ 监测到第 $i$ 个产品的退化轨迹 $<span class="sc">\{</span>Y_{i1},\dots,Y_{im}<span class="sc">\}</span>$ 均满足 $Y_{ij} &lt; \omega$ ( 其中 $\omega$ 为失效阈值) , 则其在时间 $t_m$ 的 RUL 定义为 $$Z_{it_m}=\inf<span class="sc">\{</span>z:Y_i(z+t_m)&gt;\omega|Y_{ij}&lt;\omega,j=1,\dots,m<span class="sc">\}</span>,$$ 其分布函数为 \begin{align}</span>
<span id="cb1-355"><a href="#cb1-355"></a>    F_{Z_{it_m}}(z \mid \alpha,\beta_i)&amp;=P(Y_i(z+t_m)&gt;\omega)=P(Y_i(z)&gt;\omega-Y_{im})\nonumber<span class="sc">\\</span></span>
<span id="cb1-356"><a href="#cb1-356"></a>    &amp;=\frac{\Psi(\beta(\omega-Y_{im}),\alpha z)}{\Gamma(\alpha z)}.</span>
<span id="cb1-357"><a href="#cb1-357"></a>\end{align} 由伽马过程\index{伽马过程}的齐次性可知, 最后两个等式成立. 由于$F_{Z_{it_m}}(z \mid \alpha,\beta_i)$较为复杂, 可用两参数BS分布$BS(\alpha_{im}^\ast,\beta_{im}^\ast)$近似<span class="co">[</span><span class="ot">@parpad2005</span><span class="co">]</span>, 其中 $$\alpha_{im}^\ast=\sqrt{\frac{1}{\beta_i(\omega-Y_{im})}},\quad</span>
<span id="cb1-358"><a href="#cb1-358"></a>\beta_{im}^\ast=\frac{\beta_i(\omega-Y_{im})}{\alpha}.</span>
<span id="cb1-359"><a href="#cb1-359"></a>$$ 因此, 在时间点$t_m$, 第$i$个产品RUL的均值可近似为 $$\mu_{im}(\alpha,\beta_i)=\beta_{im}^\ast\left(1+\left(\alpha_{im}^\ast\right)^2/2\right)=</span>
<span id="cb1-360"><a href="#cb1-360"></a>\dfrac{1+2\beta_i(\omega-Y_{im})}{2\alpha}.$$ 此外, $Z_{i t_m}$ 的分布 $\rho$ 分位数可近似为 $$\mu^{\rho}_{im}(\alpha,\beta_i)=\frac{\beta_{im}^\ast}{4}\left[u_\rho\alpha_{im}^\ast +\sqrt{\left(u_\rho\alpha_{im}^\ast\right)^{2}+4}\right]^{2},$$ 其中 $u_\rho$ 是标准正态分布\index{正态分布}的 $\rho$ 分位数. 在时间$t_m$, 第 $i$ 个产品RUL 的贝叶斯\index{贝叶斯}点预测为 \begin{equation}\label{point}</span>
<span id="cb1-361"><a href="#cb1-361"></a>    \tilde{\mu}_{im}=\int_0^{\infty}\int_0^{\infty}\mu_{im}(\alpha,\beta_i)\pi(\alpha,\beta_i \mid  \bm{y_{(m)}})\text{d}\alpha\text{d}\beta_i.</span>
<span id="cb1-362"><a href="#cb1-362"></a>\end{equation} 在时间$t_m$时, 第 $i$ 个产品 RUL 的 $1-\rho$ 可信水平的贝叶斯\index{贝叶斯}区间预测为 \begin{equation}\label{inter}</span>
<span id="cb1-363"><a href="#cb1-363"></a>    \left(\tilde{\mu}_{im}^{\rho/2},\tilde{\mu}_{im}^{1-\rho/2}\right),</span>
<span id="cb1-364"><a href="#cb1-364"></a>\end{equation} 其中 $$</span>
<span id="cb1-365"><a href="#cb1-365"></a>\tilde{\mu}_{im}^{\rho}=\int_0^{\infty}\int_0^{\infty}\mu^{\rho}_{im}(\alpha,\beta_i)\pi(\alpha,\beta_i \mid \bm{y_{(m)}})\text{d}\alpha\text{d}\beta_i.</span>
<span id="cb1-366"><a href="#cb1-366"></a>$$ 给定后验样本 ${(\alpha^{(k)},\beta_i^{(k)}), k=1,\dots,K}$, 式 \eqref{point} 和 \eqref{inter} 可通过蒙特卡罗方法近似: \begin{equation}\label{mcest}</span>
<span id="cb1-367"><a href="#cb1-367"></a>    \tilde{\mu}_{im}\approx\frac{1}{K}\sum_{k=1}^{K}\mu_{im}(\alpha^{(k)},\beta_i^{(k)}),~~</span>
<span id="cb1-368"><a href="#cb1-368"></a>    \tilde{\mu}_{im}^{\rho}\approx\frac{1}{K}\sum_{k=1}^{K}\mu^{\rho}_{im}(\alpha^{(k)},\beta_i^{(k)}). </span>
<span id="cb1-369"><a href="#cb1-369"></a>\end{equation}</span>
<span id="cb1-370"><a href="#cb1-370"></a></span>
<span id="cb1-371"><a href="#cb1-371"></a>**注4**: DGS 和 SIR 算法主要用于产生模型参数 $(\alpha,\beta_1,\dots,\beta_n)^{'}$ 的后验样本. 基于这些后验样本, 可通过式 \eqref{mcest} 对 $n$ 个产品进行 RUL 预测. 算法具备高度灵活性, 既适用于单个产品的预测, 也适用于多个产品的协同预测. 当 $n=1$ 时, 算法仅利用单个产品的信息, 退化为第 @sec-ITR2025-ps 节中的内容. 当 $n\ge 2$ 时, 算法通过共享多个产品的信息来共同估计参数 $\alpha$, 并利用其他产品的信息提高参数 $\beta_i$ 的估计精度.</span>
<span id="cb1-372"><a href="#cb1-372"></a></span>
<span id="cb1-373"><a href="#cb1-373"></a><span class="fu">### RUL预测 {#sec-ITR2025-rul}</span></span>
<span id="cb1-374"><a href="#cb1-374"></a></span>
<span id="cb1-375"><a href="#cb1-375"></a><span class="co">&lt;!-- 随着先进传感技术的兴起和普及, 产品的性能退化信息可以实时监测, 并且在收集到新的观测数据后, RUL 预测将进行更新. 在本节中, 我们将提出一种基于伽马过程的在线 RUL 预测算法. 该算法在在线更新方面具有多项优势, 例如高计算效率、低数据存储空间需求、同时对多个产品进行 RUL 预测等.  --&gt;</span></span>
<span id="cb1-376"><a href="#cb1-376"></a></span>
<span id="cb1-377"><a href="#cb1-377"></a>假设在时间点$t_{m+1}=(m+1)l$收集到了 $n$ 个产品的新退化增量 $\bm{y}_{(m+1)}=(y_{1m+1},\dots,y_{nm+1})^{'}$. 在获取新的观测数据后, $(\alpha,\beta_1,\dots,\beta_n)^{'}$ 的后验分布需要更新. 对于具有共轭先验\index{先验}的贝叶斯\index{贝叶斯}推断, 可使用递推公式来实现更新. 由式 \eqref{post2} 可知, 在时间 $t_{m+1}=(m+1)l$ 时, $(\alpha,\beta_1,\dots,\beta_n)^{'}$ 的后验分布为 $\textrm{AGMG}_n\left(\bm\gamma_{p(m+1)},\omega_{p(m+1)},\bm\xi_{p(m+1)}\right)$, 其中参数 $\bm\gamma_{p(m+1)}$、$\omega_{p(m+1)}$ 和 $\bm\xi_{p(m+1)}$ 可实现递推更新. 即 \begin{equation}\label{post3}</span>
<span id="cb1-378"><a href="#cb1-378"></a>  \begin{aligned}</span>
<span id="cb1-379"><a href="#cb1-379"></a>    \bm\gamma_{p(m+1)}&amp;=\bm\gamma_{p(m)}+(n,1)^{'}, <span class="sc">\\</span></span>
<span id="cb1-380"><a href="#cb1-380"></a>    \omega_{(m+1)}&amp;=\omega_{(m)}^{\frac{mn+\delta_1}{(m+1)n+\delta_1}}\left<span class="co">[</span><span class="ot">\prod_{i=1}^{m}y_{im+1}\right</span><span class="co">]</span>^{\frac{1}{(m+1)n+\delta_1}},<span class="sc">\\</span></span>
<span id="cb1-381"><a href="#cb1-381"></a>    \bm\lambda_{(m+1)}&amp;=\frac{m+\delta_2}{m+1+\delta_2}\bm\lambda_{(m)}+\frac{1}{m+1+\delta_2}\bm{y}_{(m+1)}.  </span>
<span id="cb1-382"><a href="#cb1-382"></a>  \end{aligned}</span>
<span id="cb1-383"><a href="#cb1-383"></a>\end{equation} 由式 \eqref{post3}可知, 后验分布的更新仅依赖$t_m$时刻后验分布中的参数值和新增观测数据, 可显著提升计算和数据存储效率. 本章提出的高效 DGS 和 SIR 算法, 可快速生成 AGMG 分布样本, 并用于多个产品的在线 RUL 预测. 具体过程如下:</span>
<span id="cb1-384"><a href="#cb1-384"></a></span>
<span id="cb1-385"><a href="#cb1-385"></a><span class="in">```{=latex}</span></span>
<span id="cb1-386"><a href="#cb1-386"></a><span class="in">\begin{algorithm}</span></span>
<span id="cb1-387"><a href="#cb1-387"></a><span class="in">    \caption{在线 RUL 预测}\label{algo4}</span></span>
<span id="cb1-388"><a href="#cb1-388"></a><span class="in">    \LinesNumbered</span></span>
<span id="cb1-389"><a href="#cb1-389"></a><span class="in">    \KwIn{时间 $t_{m}=ml$ 时 $(\alpha,\beta_1,\dots,\beta_n)^{'}$ 的后验分布参数值, 以及时间 $t_{m+1}=(m+1)l$ 时的新观测数据 $(y_{1m+1},\dots,y_{nm+1})$. \\}</span></span>
<span id="cb1-390"><a href="#cb1-390"></a><span class="in">    \KwOut{$n$ 个产品的 RUL 点估计和 $100(1-\rho)\%$ 置信区间. }</span></span>
<span id="cb1-391"><a href="#cb1-391"></a><span class="in">    \BlankLine</span></span>
<span id="cb1-392"><a href="#cb1-392"></a><span class="in">    根据式 \eqref{post3} 更新 $(\alpha,\beta_1,\dots,\beta_n)^{'}$ 的后验分布. </span></span>
<span id="cb1-393"><a href="#cb1-393"></a><span class="in">    通过 DGS 或 SIR 从更新后的后验分布中生成随机样本.   </span></span>
<span id="cb1-394"><a href="#cb1-394"></a><span class="in">    </span></span>
<span id="cb1-395"><a href="#cb1-395"></a><span class="in">    根据式 \eqref{mcest} 计算 $n$ 个产品的 RUL 点估计和 $100(1-\rho)\%$ 区间估计.   </span></span>
<span id="cb1-396"><a href="#cb1-396"></a><span class="in">\end{algorithm}</span></span>
<span id="cb1-397"><a href="#cb1-397"></a><span class="in">```</span></span>
<span id="cb1-398"><a href="#cb1-398"></a><span class="fu">### 实例分析 {#sec-ITR2025-case}</span></span>
<span id="cb1-399"><a href="#cb1-399"></a></span>
<span id="cb1-400"><a href="#cb1-400"></a><span class="fu">#### 激光退化数据</span></span>
<span id="cb1-401"><a href="#cb1-401"></a></span>
<span id="cb1-402"><a href="#cb1-402"></a>基于第 \ref{sec-ITR2025-sim} 节的激光退化数据集 ( 见图 @fig-fig:laser2) , 我们重点分析第 1、6 和 10 个激光设备. 观测数据显示, 这三个设备在运行4000小时后均因性能退化\index{性能退化}量超过阈值 $\omega=10$而发生失效. 由于监测间隔为 250小时, 其失效时间\index{失效时间}区间可精确锁定为相邻监测时间点之间. 例如, 第一个设备的退化值在 3750 至 4000 小时之间超过了阈值. 因此, 可采用线性插值法来估计其失效时间\index{失效时间}. 第一个设备在 3750 小时时记录的退化值为 9.87, 而在 4000 小时时为 10.94. 通过线性插值法, 其失效时间\index{失效时间}估计为 $$3750+\dfrac{10-9.87}{10.94-9.87}\times (4000-3750)=3785.75~~ \text{小时}.$$ 同理, 第 6 和第 10 个设备的失效时间\index{失效时间}分别估计为 3506.75 小时和 3351.25 小时.</span>
<span id="cb1-403"><a href="#cb1-403"></a></span>
<span id="cb1-406"><a href="#cb1-406"></a><span class="in">```{r}</span></span>
<span id="cb1-407"><a href="#cb1-407"></a><span class="co">#| label: fig-fig:pvas1</span></span>
<span id="cb1-408"><a href="#cb1-408"></a><span class="co">#| fig.align: 'center'</span></span>
<span id="cb1-409"><a href="#cb1-409"></a><span class="co">#| echo: FALSE</span></span>
<span id="cb1-410"><a href="#cb1-410"></a><span class="co">#| out.width: '75%'</span></span>
<span id="cb1-411"><a href="#cb1-411"></a><span class="co">#| fig.cap: '每个激光设备的 Kolmogorov-Smirnov 检验 $p$ 值. '</span></span>
<span id="cb1-412"><a href="#cb1-412"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/Gamma/ITR2025/pvalue1.pdf"</span>)</span>
<span id="cb1-413"><a href="#cb1-413"></a><span class="in">```</span></span>
<span id="cb1-414"><a href="#cb1-414"></a></span>
<span id="cb1-417"><a href="#cb1-417"></a><span class="in">```{r}</span></span>
<span id="cb1-418"><a href="#cb1-418"></a><span class="co">#| label: fig-fig:paresti</span></span>
<span id="cb1-419"><a href="#cb1-419"></a><span class="co">#| fig.align: 'center'</span></span>
<span id="cb1-420"><a href="#cb1-420"></a><span class="co">#| echo: FALSE</span></span>
<span id="cb1-421"><a href="#cb1-421"></a><span class="co">#| out.width: '95%'</span></span>
<span id="cb1-422"><a href="#cb1-422"></a><span class="co">#| fig.cap: '激光退化数据中 $\alpha$、$\beta_1$、$\beta_6$ 和 $\beta_{10}$ 的在线估计值. '</span></span>
<span id="cb1-423"><a href="#cb1-423"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/Gamma/ITR2025/paresti.pdf"</span>)</span>
<span id="cb1-424"><a href="#cb1-424"></a><span class="in">```</span></span>
<span id="cb1-425"><a href="#cb1-425"></a></span>
<span id="cb1-426"><a href="#cb1-426"></a>通过 Kolmogorov-Smirnov 检验验证各设备退化数据与伽马过程\index{伽马过程} $\mathcal{GP}(\alpha t, \beta_i)$ 的拟合优度. 如图 @fig-fig:pvas1 所示, 所有设备的检验 p 值均大于 0.05 的显著性水平, 统计上无法拒绝原假设, 表明伽马过程\index{伽马过程}模型能够有效描述退化轨迹的随机特性.</span>
<span id="cb1-427"><a href="#cb1-427"></a></span>
<span id="cb1-428"><a href="#cb1-428"></a>基于上述模型验证结果, 应用第 \ref{sec-ITR2025-rul} 节提出的在线预测算法进行实时 RUL 预测. 具体实施过程如下: 从 $t=500$ 小时开始, 仅基于前两次监测数据初始化预测模型; 随着监测数据累积, 通过算法 \ref{algo4} 递归更新参数后验分布; 计算出每个时间点三台设备的 RUL 点预测值及其 95% 预测区间. 图 @fig-fig:paresti 展示了随时间变化的 $\alpha$、$\beta_1$、$\beta_6$ 和 $\beta_{10}$ 的估计值. 从图中可发现, $\beta_1$、$\beta_6$ 和 $\beta_{10}$ 的估计值呈上升趋势, 且它们之间差异显著, 表面设备间具有较强的异质性\index{异质性}. 图 @fig-fig:rulpred 展示了在各个时间点上三台设备RUL的点预测值 及其 95% 预测区间, 并与每个时间点的实际 RUL 进行了对比. 如图所示, 几乎所有实际 RUL 均被 95% 预测区间覆盖, 且点预测值与实际 RUL 非常接近, 显示了预测的高准确性.</span>
<span id="cb1-429"><a href="#cb1-429"></a></span>
<span id="cb1-432"><a href="#cb1-432"></a><span class="in">```{r}</span></span>
<span id="cb1-433"><a href="#cb1-433"></a><span class="co">#| label: fig-fig:rulpred</span></span>
<span id="cb1-434"><a href="#cb1-434"></a><span class="co">#| fig.align: 'center'</span></span>
<span id="cb1-435"><a href="#cb1-435"></a><span class="co">#| echo: FALSE</span></span>
<span id="cb1-436"><a href="#cb1-436"></a><span class="co">#| out.width: '80%'</span></span>
<span id="cb1-437"><a href="#cb1-437"></a><span class="co">#| fig.cap: '第 1、6 和 10 个设备的 RUL 点预测值及其 95\% 预测区间. '</span></span>
<span id="cb1-438"><a href="#cb1-438"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/Gamma/ITR2025/rulpred.pdf"</span>)</span>
<span id="cb1-439"><a href="#cb1-439"></a><span class="in">```</span></span>
<span id="cb1-440"><a href="#cb1-440"></a></span>
<span id="cb1-441"><a href="#cb1-441"></a><span class="fu">#### 列车车轮数据</span></span>
<span id="cb1-442"><a href="#cb1-442"></a></span>
<span id="cb1-443"><a href="#cb1-443"></a><span class="co">&lt;!-- 列车车轮数据来源于 [@peng2020student]. 随着行驶距离的增加, 车轮会逐渐磨损. 当车轮直径的磨损达到 60 毫米时, 认为车轮失效. 原始数据集包含 14 个样本, 测量点从 50 到 600 之间均匀分布, 间隔为 50, 其中距离单位为 1000 公里(kkm) .  --&gt;</span></span>
<span id="cb1-444"><a href="#cb1-444"></a></span>
<span id="cb1-445"><a href="#cb1-445"></a>本节将使用所提出的模型和方法对列车车轮数据 (见图 @fig-fig:wheeldata) 进行分析, 并预测每个测量点上车轮的RUL. 从图 @fig-fig:wheeldata 可以看出, 退化路径呈线性并且单调递增. 有三个车轮在 600 千公里前已经失效. 通过线性插值法计算第5、第9和第11个车轮的失效时间\index{失效时间}, 结果分别为 523.537、558.861 和 421.508 千公里.</span>
<span id="cb1-446"><a href="#cb1-446"></a></span>
<span id="cb1-447"><a href="#cb1-447"></a><span class="co">&lt;!-- ```{r} --&gt;</span></span>
<span id="cb1-448"><a href="#cb1-448"></a></span>
<span id="cb1-449"><a href="#cb1-449"></a><span class="co">&lt;!-- #| label: fig-fig:wheeldata --&gt;</span></span>
<span id="cb1-450"><a href="#cb1-450"></a></span>
<span id="cb1-451"><a href="#cb1-451"></a><span class="co">&lt;!-- #| fig.align: 'center' --&gt;</span></span>
<span id="cb1-452"><a href="#cb1-452"></a></span>
<span id="cb1-453"><a href="#cb1-453"></a><span class="co">&lt;!-- #| echo: FALSE --&gt;</span></span>
<span id="cb1-454"><a href="#cb1-454"></a></span>
<span id="cb1-455"><a href="#cb1-455"></a><span class="co">&lt;!-- #| out.width: '60%' --&gt;</span></span>
<span id="cb1-456"><a href="#cb1-456"></a></span>
<span id="cb1-457"><a href="#cb1-457"></a><span class="co">&lt;!-- #| fig.cap: '列车车轮数据. ' --&gt;</span></span>
<span id="cb1-458"><a href="#cb1-458"></a></span>
<span id="cb1-459"><a href="#cb1-459"></a><span class="co">&lt;!-- knitr::include_graphics("figures/Gamma/ITR2025/wheel.pdf") --&gt;</span></span>
<span id="cb1-460"><a href="#cb1-460"></a></span>
<span id="cb1-461"><a href="#cb1-461"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb1-462"><a href="#cb1-462"></a></span>
<span id="cb1-465"><a href="#cb1-465"></a><span class="in">```{r}</span></span>
<span id="cb1-466"><a href="#cb1-466"></a><span class="co">#| label: fig-fig:pvas2</span></span>
<span id="cb1-467"><a href="#cb1-467"></a><span class="co">#| fig.align: 'center'</span></span>
<span id="cb1-468"><a href="#cb1-468"></a><span class="co">#| echo: FALSE</span></span>
<span id="cb1-469"><a href="#cb1-469"></a><span class="co">#| out.width: '75%'</span></span>
<span id="cb1-470"><a href="#cb1-470"></a><span class="co">#| fig.cap: '每个列车车轮的 Kolmogorov-Smirnov 检验 $p$ 值. '</span></span>
<span id="cb1-471"><a href="#cb1-471"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/Gamma/ITR2025/pvalue2.pdf"</span>)</span>
<span id="cb1-472"><a href="#cb1-472"></a><span class="in">```</span></span>
<span id="cb1-473"><a href="#cb1-473"></a></span>
<span id="cb1-474"><a href="#cb1-474"></a><span class="co">&lt;!--对每个列车车轮的退化数据进行了Kolmogorov-Smirnov检验, 结果如图 @fig-fig:pvas2 所示, 所有车轮的p值均显著高于显著性水平 0.05. 这表明伽马过程\index{伽马过程}模型可以很好地拟合这些数据. 基于此, 采用考虑异质效应的伽马过程\index{伽马过程}对数据进行拟合, 并从第二次测量开始对上述三个车轮的 RUL 进行在线预测. 图 @fig-fig:wheelrul 展示了三个车轮的真实RUL、点预测值及其95\%预测区间. 如图所示, RUL的预测值与实际RUL高度吻合, 并且在所有测量点, 真实RUL均被95\%置信区间\index{置信区间}所覆盖. 这一结果表明, 所提出的算法在不确定性量化方面表现优异, 能够为列车车轮的健康管理提供支撑. --&gt;</span></span>
<span id="cb1-475"><a href="#cb1-475"></a></span>
<span id="cb1-476"><a href="#cb1-476"></a>基于 Kolmogorov-Smirnov 检验结果 ( 图 @fig-fig:pvas2 显示所有车轮退化数据的检验 p 值均大于 0.05) , 验证了伽马过程\index{伽马过程}模型对列车车轮退化数据的适用性. 采用考虑异质性\index{异质性}效应的伽马过程\index{伽马过程}模型进行建模, 并从第二次监测时点开始在线 RUL 预测. 如图 @fig-fig:wheelrul 所示, 三个车轮的 RUL 点预测值与实际退化轨迹高度吻合, 且所有时间节点的真实 RUL 均被 95% 预测区间完整覆盖, 表明所提算法在不确定性量化与工程实用性方面具有显著优势, 可为轨道交通关键部件的预防性维护决策提供可靠依据.</span>
<span id="cb1-477"><a href="#cb1-477"></a></span>
<span id="cb1-480"><a href="#cb1-480"></a><span class="in">```{r}</span></span>
<span id="cb1-481"><a href="#cb1-481"></a><span class="co">#| label: fig-fig:wheelrul</span></span>
<span id="cb1-482"><a href="#cb1-482"></a><span class="co">#| fig.align: 'center'</span></span>
<span id="cb1-483"><a href="#cb1-483"></a><span class="co">#| echo: FALSE</span></span>
<span id="cb1-484"><a href="#cb1-484"></a><span class="co">#| out.width: '95%'</span></span>
<span id="cb1-485"><a href="#cb1-485"></a><span class="co">#| fig.cap: '第 5、9 和 11 个车轮的 RUL 点预测值及其 95\% 预测区间. '</span></span>
<span id="cb1-486"><a href="#cb1-486"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/Gamma/ITR2025/wheelrul.pdf"</span>)</span>
<span id="cb1-487"><a href="#cb1-487"></a><span class="in">```</span></span>
<span id="cb1-488"><a href="#cb1-488"></a></span>
<span id="cb1-489"><a href="#cb1-489"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> 总结 {#sec-ITR2025-conc} --&gt;</span></span>
<span id="cb1-490"><a href="#cb1-490"></a></span>
<span id="cb1-491"><a href="#cb1-491"></a><span class="co">&lt;!-- 本文提出了一种专门针对齐次伽马过程\index{伽马过程}的共轭先验, 并深入研究了其特性. 利用这些特性, 我们提出了三种高级算法(Gibbs 采样、DGS 和 SIR) , 用于从后验分布中模拟随机样本. 生成的样本能够实现精确的后验推断, 模拟研究展示了 DGS 和 SIR 的高计算效率与精度. 扩展了该方法的适用范围, 共轭先验框架进一步包含具有异质效应的伽马过程\index{伽马过程}, 从而能够设计类似的算法生成后验参数样本. 这种共轭参数结构的主要优势在于其可以轻松递推更新后验分布, 显著减少存储空间并提升计算效率. 利用后验分布的递推更新能力, 我们开发了一种创新的在线算法, 可同时对多个产品进行 RUL 预测. 通过两个实际案例验证了所提出的在线算法, 结果表明其能够合理地提供 RUL 的点预测和 95% 置信区间\index{置信区间}.  --&gt;</span></span>
<span id="cb1-492"><a href="#cb1-492"></a></span>
<span id="cb1-493"><a href="#cb1-493"></a><span class="co">&lt;!-- 尽管所提出的在线算法能够高效分析大规模数据集, 但也存在一定的局限性. 一个显著的局限性是, 在线更新过程仅适用于测量时间点均匀分布的情况. 这一限制源于共轭先验的特性, 该先验在简化贝叶斯\index{贝叶斯}更新过程时依赖于时间点的均匀性. 当测量时间不均匀时, 共轭性被打破, 后验计算变得复杂, 算法效率降低. 然而, 第 @sec-ITR2025-conc 节和第 @sec-ITR2025-ps 节中开发的共轭先验及后验采样算法具有更广泛的应用. 例如, 利用共轭先验的混合仍然是共轭先验的性质, 该方法可以扩展到处理包含多个子群体的总体问题[@yuanji15; @xuhuwang20]. 此外, 当退化路径为非线性时, 可以引入额外的参数 $\phi$. 在这种情况下, 完全共轭先验的构建变得不可能. 一种折中方案是为 $(\alpha,\beta,\phi)$ 构建半共轭先验. 具体而言, 给定 $\phi$, 对 $(\alpha,\beta)$ 保持共轭结构, 然后对 $\phi$ 赋予一个先验分布. 此方法在处理各种复杂场景时提供了更大的灵活性和适应性, 从而增强了其在实际应用中的实用性.  --&gt;</span></span>
<span id="cb1-494"><a href="#cb1-494"></a></span>
<span id="cb1-495"><a href="#cb1-495"></a><span class="fu">### 附录 {#sec-Append-3A}</span></span>
<span id="cb1-496"><a href="#cb1-496"></a></span>
<span id="cb1-497"><a href="#cb1-497"></a><span class="co">&lt;!-- {.unnumbered} --&gt;</span></span>
<span id="cb1-498"><a href="#cb1-498"></a></span>
<span id="cb1-499"><a href="#cb1-499"></a><span class="fu">#### 定理 @thm-ITR2025-th2 的证明 {.unnumbered}</span></span>
<span id="cb1-500"><a href="#cb1-500"></a></span>
<span id="cb1-501"><a href="#cb1-501"></a>基于似然函数\index{似然函数} \eqref{like0} 和先验\index{先验} \eqref{con0}, $\alpha$ 和 $\beta$ 的联合后验密度为 \begin{align}\label{post0}</span>
<span id="cb1-502"><a href="#cb1-502"></a>      \pi(\alpha,\beta|\bm{y})&amp;\propto    L(\bm{y} \mid \alpha,\beta)\pi(\alpha,\beta)\nonumber<span class="sc">\\</span></span>
<span id="cb1-503"><a href="#cb1-503"></a>      &amp;\propto \dfrac{(\beta\omega_p)^{\delta_p\overline{T}_m\alpha}}{\left[\prod_{j=1}^{m}\left(\Gamma(\alpha t_j)\right)^{1/m}\right]^{\delta_p}}</span>
<span id="cb1-504"><a href="#cb1-504"></a>      \exp<span class="sc">\{</span>-\delta_p\lambda_p\beta<span class="sc">\}</span>,</span>
<span id="cb1-505"><a href="#cb1-505"></a>\end{align} 其中 \begin{align*}</span>
<span id="cb1-506"><a href="#cb1-506"></a>\delta_p&amp;=mn+\delta,<span class="sc">\\</span></span>
<span id="cb1-507"><a href="#cb1-507"></a>\omega_p&amp;=\omega^{\frac{\delta}{mn+\delta}}\left<span class="co">[</span><span class="ot">\prod_{i=1}^{n}\prod_{j=1}^{m}y_{ij}^{\frac{t_{j}}{nm\overline{T}_m}}\right</span><span class="co">]</span>^{\frac{mn}{mn+\delta}},<span class="sc">\\</span></span>
<span id="cb1-508"><a href="#cb1-508"></a>\lambda_p&amp;=\frac{mn}{mn+\delta}\bar{y}_a+\frac{\delta}{mn+\delta}\lambda.</span>
<span id="cb1-509"><a href="#cb1-509"></a>\end{align*} 因此, $\pi(\alpha,\beta)$ 和 $\pi(\alpha,\beta \mid \bm{y})$ 均属于同一分布族.</span>
<span id="cb1-510"><a href="#cb1-510"></a></span>
<span id="cb1-511"><a href="#cb1-511"></a><span class="fu">#### 不等式证明 {.unnumbered}</span></span>
<span id="cb1-512"><a href="#cb1-512"></a></span>
<span id="cb1-513"><a href="#cb1-513"></a><span class="co">&lt;!-- {.unnumbered} --&gt;</span></span>
<span id="cb1-514"><a href="#cb1-514"></a></span>
<span id="cb1-515"><a href="#cb1-515"></a><span class="co">&lt;!-- $\log\left(\frac{\prod_{j=1}^{m}t_j^{t_j/T_m}}{\overline{T}_m}\right)\ge 0$ --&gt;</span></span>
<span id="cb1-516"><a href="#cb1-516"></a></span>
<span id="cb1-517"><a href="#cb1-517"></a>由 $T_m=\sum_{j=1}^{m}t_j$, 得到 \begin{equation*}</span>
<span id="cb1-518"><a href="#cb1-518"></a>  \begin{aligned}</span>
<span id="cb1-519"><a href="#cb1-519"></a>    \log\left(\frac{\prod_{j=1}^{m}t_j^{t_j/T_m}}{\overline{T}_m}\right)&amp;=</span>
<span id="cb1-520"><a href="#cb1-520"></a>    \sum_{j=1}^{m}\frac{t_j}{T_m}\log(t_j)-\log\left(\overline{T}_m\right)  <span class="sc">\\</span></span>
<span id="cb1-521"><a href="#cb1-521"></a>    &amp;=\frac{\sum_{j=1}^{m}t_j\log(t_j)}{\sum_{j=1}^{m}t_j}-\log\left(\frac{1}{m}\sum_{j=1}^{m}t_j\right)    </span>
<span id="cb1-522"><a href="#cb1-522"></a>\end{aligned}</span>
<span id="cb1-523"><a href="#cb1-523"></a>\end{equation*} 令 $q(x)=x\log(x)$, 则 $q(x)$ 是凸函数. 利用 Jensen 不等式得 \begin{equation*}</span>
<span id="cb1-524"><a href="#cb1-524"></a>\begin{aligned}</span>
<span id="cb1-525"><a href="#cb1-525"></a>    \sum_{j=1}^{m}t_j\log(t_j)&amp;\ge m\cdot \frac{1}{m}\sum_{j=1}^{m}t_j\cdot \log\left(\frac{1}{m}\sum_{j=1}^{m}t_j\right)<span class="sc">\\</span></span>
<span id="cb1-526"><a href="#cb1-526"></a>&amp;=\left(\sum_{j=1}^{m}t_j\right)\cdot \log\left(\frac{1}{m}\sum_{j=1}^{m}t_j\right). </span>
<span id="cb1-527"><a href="#cb1-527"></a> \end{aligned}</span>
<span id="cb1-528"><a href="#cb1-528"></a>\end{equation*} 因此, 可以得出: $\log\left(\frac{\prod_{j=1}^{m}t_j^{t_j/T_m}}{\overline{T}_m}\right)\ge 0$.</span>
<span id="cb1-529"><a href="#cb1-529"></a></span>
<span id="cb1-530"><a href="#cb1-530"></a><span class="fu">#### 三种后验抽样方法 {.unnumbered}</span></span>
<span id="cb1-531"><a href="#cb1-531"></a></span>
<span id="cb1-532"><a href="#cb1-532"></a><span class="in">```{=latex}</span></span>
<span id="cb1-533"><a href="#cb1-533"></a><span class="in">\begin{algorithm}</span></span>
<span id="cb1-534"><a href="#cb1-534"></a><span class="in">    \caption{Gibbs 采样}\label{ITR2025-algo1}</span></span>
<span id="cb1-535"><a href="#cb1-535"></a><span class="in">    \LinesNumbered</span></span>
<span id="cb1-536"><a href="#cb1-536"></a><span class="in">    \KwIn{观测数据 $\bm{y}$. \\}</span></span>
<span id="cb1-537"><a href="#cb1-537"></a><span class="in">    \KwOut{$\alpha,\beta$ 和 $\eta$ 的点估计和 $100(1-\rho)\%$ 置信区间. }</span></span>
<span id="cb1-538"><a href="#cb1-538"></a><span class="in">    \BlankLine</span></span>
<span id="cb1-539"><a href="#cb1-539"></a><span class="in">    随机初始化 $\alpha$ 和 $\beta$(例如, $\alpha_0$ 和 $\beta_0$) , 并计算 $\delta_p$、$\omega_p$ 和 $\lambda_p$. </span></span>
<span id="cb1-540"><a href="#cb1-540"></a><span class="in">    </span></span>
<span id="cb1-541"><a href="#cb1-541"></a><span class="in">    \For{$k$ in $\{1,2,\dots,K_1\}$}{  </span></span>
<span id="cb1-542"><a href="#cb1-542"></a><span class="in">    从 $\textrm{Ga}(\delta_p\bar{T}_m\alpha_{k-1},\delta_p\lambda_p)$ 中生成 $\beta_k$;   </span></span>
<span id="cb1-543"><a href="#cb1-543"></a><span class="in">      </span></span>
<span id="cb1-544"><a href="#cb1-544"></a><span class="in">    通过 ARS 算法从 $\pi(\alpha \mid \beta_k,\bm{y})$ 中生成 $\alpha_k$;   </span></span>
<span id="cb1-545"><a href="#cb1-545"></a><span class="in">      </span></span>
<span id="cb1-546"><a href="#cb1-546"></a><span class="in">    计算 $\eta_k=p(\alpha_k,\beta_k)$.   </span></span>
<span id="cb1-547"><a href="#cb1-547"></a><span class="in">}     </span></span>
<span id="cb1-548"><a href="#cb1-548"></a><span class="in">舍弃前 $B$ 个预烧样本, 并选择间隔 $L$ 来消除后验样本中的自相关性.   </span></span>
<span id="cb1-549"><a href="#cb1-549"></a><span class="in">  </span></span>
<span id="cb1-550"><a href="#cb1-550"></a><span class="in">通过后验样本 $\{(\alpha_k,\beta_k,\eta_k),k=B+1,B+L+1,B+2L+1,\dots,K_1\}$ 计算这些参数的点估计和 $100(1-\rho)\%$ 区间估计.      </span></span>
<span id="cb1-551"><a href="#cb1-551"></a><span class="in">\end{algorithm}</span></span>
<span id="cb1-552"><a href="#cb1-552"></a><span class="in">```</span></span>
<span id="cb1-553"><a href="#cb1-553"></a><span class="in">```{=latex}</span></span>
<span id="cb1-554"><a href="#cb1-554"></a><span class="in">\begin{algorithm}</span></span>
<span id="cb1-555"><a href="#cb1-555"></a><span class="in">    \caption{离散网格采样}\label{ITR2025-algo2}</span></span>
<span id="cb1-556"><a href="#cb1-556"></a><span class="in">    \LinesNumbered</span></span>
<span id="cb1-557"><a href="#cb1-557"></a><span class="in">    \KwIn{观测数据 $\bm{y}$. \\}</span></span>
<span id="cb1-558"><a href="#cb1-558"></a><span class="in">    \KwOut{$\alpha,\beta$ 和 $\eta$ 的点估计和 $100(1-\rho)\%$ 置信区间. }</span></span>
<span id="cb1-559"><a href="#cb1-559"></a><span class="in">    \BlankLine</span></span>
<span id="cb1-560"><a href="#cb1-560"></a><span class="in">    计算 $\delta_p$、$\omega_p$ 和 $\lambda_p$. </span></span>
<span id="cb1-561"><a href="#cb1-561"></a><span class="in">    </span></span>
<span id="cb1-562"><a href="#cb1-562"></a><span class="in">    通过六西格玛法则确定区间 $[A_1,A_2]$.   </span></span>
<span id="cb1-563"><a href="#cb1-563"></a><span class="in">  </span></span>
<span id="cb1-564"><a href="#cb1-564"></a><span class="in">选择 $M$ 个网格点 $\left\{A_1=\alpha^{(1)},\alpha^{(2)},\dots,A_2=\alpha^{(M)}\right\}$, 计算每个网格的概率 \eqref{disalp}.   </span></span>
<span id="cb1-565"><a href="#cb1-565"></a><span class="in">  </span></span>
<span id="cb1-566"><a href="#cb1-566"></a><span class="in">\For{$k$ in $\{1,2,\dots,K_2\}$}{  </span></span>
<span id="cb1-567"><a href="#cb1-567"></a><span class="in">    从离散分布 \eqref{disalp} 中生成 $\alpha_k$;   </span></span>
<span id="cb1-568"><a href="#cb1-568"></a><span class="in">      </span></span>
<span id="cb1-569"><a href="#cb1-569"></a><span class="in">    从 $\textrm{Ga}(\delta_p\bar{T}_m\alpha_{k},\delta_p\lambda_p)$ 中生成 $\beta_k$;   </span></span>
<span id="cb1-570"><a href="#cb1-570"></a><span class="in">      </span></span>
<span id="cb1-571"><a href="#cb1-571"></a><span class="in">    计算 $\eta_k=p(\alpha_k,\beta_k)$.   </span></span>
<span id="cb1-572"><a href="#cb1-572"></a><span class="in">}     </span></span>
<span id="cb1-573"><a href="#cb1-573"></a><span class="in">通过后验样本 $\{(\alpha_k,\beta_k,\eta_k),k=1,\dots,K_2\}$ 计算这些参数的点估计和 $100(1-\rho)\%$ 区间估计.   </span></span>
<span id="cb1-574"><a href="#cb1-574"></a><span class="in">\end{algorithm}</span></span>
<span id="cb1-575"><a href="#cb1-575"></a><span class="in">```</span></span>
<span id="cb1-576"><a href="#cb1-576"></a><span class="in">```{=latex}</span></span>
<span id="cb1-577"><a href="#cb1-577"></a><span class="in">\begin{algorithm}</span></span>
<span id="cb1-578"><a href="#cb1-578"></a><span class="in">    \caption{采样重要性重采样}\label{ITR2025-algo3}</span></span>
<span id="cb1-579"><a href="#cb1-579"></a><span class="in">    \LinesNumbered</span></span>
<span id="cb1-580"><a href="#cb1-580"></a><span class="in">    \KwIn{观测数据 $\bm{y}$. \\}</span></span>
<span id="cb1-581"><a href="#cb1-581"></a><span class="in">    \KwOut{$\alpha,\beta$ 和 $\eta$ 的点估计和 $100(1-\rho)\%$ 置信区间. }</span></span>
<span id="cb1-582"><a href="#cb1-582"></a><span class="in">    \BlankLine</span></span>
<span id="cb1-583"><a href="#cb1-583"></a><span class="in">    计算 $\delta_p$、$\omega_p$ 和 $\lambda_p$. </span></span>
<span id="cb1-584"><a href="#cb1-584"></a><span class="in">    </span></span>
<span id="cb1-585"><a href="#cb1-585"></a><span class="in">    按照上述三步确定 $a$ 和 $b$.   </span></span>
<span id="cb1-586"><a href="#cb1-586"></a><span class="in">  </span></span>
<span id="cb1-587"><a href="#cb1-587"></a><span class="in">  从 $\textrm{Ga}(a,b)$ 中生成 $M$ 个随机样本, 并构建离散分布 \eqref{dis2}.   </span></span>
<span id="cb1-588"><a href="#cb1-588"></a><span class="in">    </span></span>
<span id="cb1-589"><a href="#cb1-589"></a><span class="in">    \For{$k$ in $\{1,2,\dots,K_3\}$}{  </span></span>
<span id="cb1-590"><a href="#cb1-590"></a><span class="in">    从离散分布 \eqref{dis2} 中生成 $\alpha_k$;   </span></span>
<span id="cb1-591"><a href="#cb1-591"></a><span class="in">      </span></span>
<span id="cb1-592"><a href="#cb1-592"></a><span class="in">    从 $\textrm{Ga}(\delta_p\bar{T}_m\alpha_{k},\delta_p\lambda_p)$ 中生成 $\beta_k$;   </span></span>
<span id="cb1-593"><a href="#cb1-593"></a><span class="in">      </span></span>
<span id="cb1-594"><a href="#cb1-594"></a><span class="in">    计算 $\eta_k=p(\alpha_k,\beta_k)$.   </span></span>
<span id="cb1-595"><a href="#cb1-595"></a><span class="in">}     </span></span>
<span id="cb1-596"><a href="#cb1-596"></a><span class="in">通过后验样本 $\{(\alpha_k,\beta_k,\eta_k),k=1,\dots,K_3\}$ 计算这些参数的点估计和 $100(1-\rho)\%$ 区间估计.       </span></span>
<span id="cb1-597"><a href="#cb1-597"></a><span class="in">\end{algorithm}</span></span>
<span id="cb1-598"><a href="#cb1-598"></a><span class="in">```</span></span>
<span id="cb1-599"><a href="#cb1-599"></a><span class="fu">#### 定理 @thm-ITR2025-th3 的证明 {.unnumbered}</span></span>
<span id="cb1-600"><a href="#cb1-600"></a></span>
<span id="cb1-601"><a href="#cb1-601"></a>基于似然函数\index{似然函数} \eqref{like2} 和先验\index{先验} \eqref{con2}, $(\alpha,\beta_1,\dots,\beta_n)^{'}$ 的联合后验密度为 \begin{align}\label{post2}</span>
<span id="cb1-602"><a href="#cb1-602"></a>    \pi(\alpha,\beta_1,\dots,\beta_n \mid \bm{y})&amp;\propto    L( \bm{y} \mid \alpha,\beta_1,\dots,\beta_n)\pi(\alpha,\beta_1,\dots,\beta_n)\nonumber<span class="sc">\\</span></span>
<span id="cb1-603"><a href="#cb1-603"></a>    &amp; \propto \dfrac{\bar{\beta}_{g}^{(mn+\delta_1)l\alpha}\bar{y}_{g(m)}^{mnl\alpha}\omega^{\delta_1 l\alpha}}{\left[\Gamma(l\alpha)\right]^{mn+\delta_1}}\exp\left\{-\sum_{i=1}^{n}\left(m\bar{y}_{i(m)}+\delta_2\lambda_i\right)\beta_i\right<span class="sc">\}</span>\nonumber<span class="sc">\\</span></span>
<span id="cb1-604"><a href="#cb1-604"></a>   &amp;\propto \dfrac{\left(\bar{\beta}_{g}\omega_{p(m)}\right)^{\delta_{1p(m)}l\alpha}}{\left[\Gamma(l\alpha)\right]^{\delta_{1p(m)}}}</span>
<span id="cb1-605"><a href="#cb1-605"></a>   \exp\left<span class="sc">\{</span>-\sum_{i=1}^{n}\delta_{2p(m)}\lambda_{ip(m)}\beta_i\right<span class="sc">\}</span>,</span>
<span id="cb1-606"><a href="#cb1-606"></a>\end{align} 其中 \begin{align*}</span>
<span id="cb1-607"><a href="#cb1-607"></a>\delta_{1p(m)}&amp;=mn+\delta_1,</span>
<span id="cb1-608"><a href="#cb1-608"></a>\delta_{2p(m)}=m+\delta_2,</span>
<span id="cb1-609"><a href="#cb1-609"></a>\omega_{p(m)}=\omega^{\frac{\delta_1}{\delta_{1p(m)}}}\bar{y}_{g(m)}^{\frac{mn}{\delta_{1p(m)}}},<span class="sc">\\</span></span>
<span id="cb1-610"><a href="#cb1-610"></a>\lambda_{ip(m)}&amp;=\frac{m}{\delta_{2p(m)}}\bar{y}_{i(m)}+\frac{\delta_2}{\delta_{2p(m)}}\lambda_i,</span>
<span id="cb1-611"><a href="#cb1-611"></a>i=1,\dots,n.</span>
<span id="cb1-612"><a href="#cb1-612"></a>\end{align*} 因此, $\pi(\alpha,\beta_1,\dots,\beta_n)$ 和 $\pi(\alpha,\beta_1,\dots,\beta_n \mid \bm{y})$ 属于同一分布族.</span>
<span id="cb1-613"><a href="#cb1-613"></a></span>
<span id="cb1-614"><a href="#cb1-614"></a><span class="fu">## 重参化伽马过程的变分贝叶斯推断 {#sec-VB-Gamma}</span></span>
<span id="cb1-615"><a href="#cb1-615"></a></span>
<span id="cb1-616"><a href="#cb1-616"></a><span class="co">&lt;!-- 作者: 周世荣, 徐安察, 汤银才, 沈丽娟 --&gt;</span></span>
<span id="cb1-617"><a href="#cb1-617"></a></span>
<span id="cb1-618"><a href="#cb1-618"></a><span class="co">&lt;!-- ## 摘要{.unnumbered} --&gt;</span></span>
<span id="cb1-619"><a href="#cb1-619"></a></span>
<span id="cb1-620"><a href="#cb1-620"></a><span class="co">&lt;!-- 在可靠性\index{可靠性}工程领域, 伽马过程在建模退化过程方面起着重要作用. 然而, 从产品退化观测中提取寿命信息一直面临着无效的建模技术和低效的统计推断方法的问题. 为了解决这些挑战, 我们在本文中提出了一种带有随机效应的重参数化伽马过程. 与经典伽马过程相比, 所提出的模型具有更直观的物理解释. 此外, 该模型的统计推断可以通过变分贝叶斯\index{贝叶斯}算法方便地实现. 结合高斯-赫尔米特求积法和拉普拉斯近似, 该算法为所提出的模型提供了封闭形式的变分后验分布. 通过模拟结果, 本文展示了该方法在计算效率和估计精度方面相较于另外两种推断方法(期望最大化和蒙特卡罗马尔可夫链) 的优越性.  --&gt;</span></span>
<span id="cb1-621"><a href="#cb1-621"></a></span>
<span id="cb1-622"><a href="#cb1-622"></a><span class="co">&lt;!-- 关键词: 变分贝叶斯\index{变分贝叶斯}方法、伽马过程、退化分析、拉普拉斯近似、高斯-赫尔米特求积.  --&gt;</span></span>
<span id="cb1-623"><a href="#cb1-623"></a></span>
<span id="cb1-624"><a href="#cb1-624"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> 简介{#sec-ITR2023-s1} --&gt;</span></span>
<span id="cb1-625"><a href="#cb1-625"></a></span>
<span id="cb1-626"><a href="#cb1-626"></a><span class="co">&lt;!-- #### 背景 {#sec-ITR2023-s1-1} --&gt;</span></span>
<span id="cb1-627"><a href="#cb1-627"></a></span>
<span id="cb1-628"><a href="#cb1-628"></a>随着传感器技术的快速发展, 退化数据采集能力的提升与模型复杂度的增加对统计推断方法提出了双重挑战:\</span>
<span id="cb1-629"><a href="#cb1-629"></a>一方面需处理高维异构数据, 另一方面需满足实时性计算需求. 传统MCMC\index{MCMC}方法虽为复杂退化模型提供了严格的贝叶斯\index{贝叶斯}推断框架, 但其存在三方面本质性局限<span class="co">[</span><span class="ot">@zaidan2016gas</span><span class="co">]</span>:</span>
<span id="cb1-630"><a href="#cb1-630"></a></span>
<span id="cb1-631"><a href="#cb1-631"></a><span class="ss">-   </span>计算效率的维度诅咒: 即使采用高性能计算集群, 在处理中等规模数据集 ( 如$n&gt;50$的异质退化轨迹) 时, 马尔可夫链的混合速度随参数维度呈指数级下降. 以双随机效应\index{随机效应}伽马模型为例, 单次迭代耗时可达$O(nm^2)$量级, 导致实际工程场景中难以获得实时推断结果.</span>
<span id="cb1-632"><a href="#cb1-632"></a><span class="ss">-   </span>收敛诊断的主观依赖性: 预烧样本\index{预烧样本}长度与抽样间隔的设定高度依赖经验性准则(如Gelman-Rubin统计量或自相关分析). 在退化建模中, 由于参数空间存在强相关性(如形状参数$\alpha$与速率参数$\beta$), 往往需要超过$10^4$次迭代才能达到平稳分布, 显著增加计算资源消耗.</span>
<span id="cb1-633"><a href="#cb1-633"></a><span class="ss">-   </span>在线更新的结构性障碍: MCMC\index{MCMC}的批处理特性导致其无法利用增量数据实现递归更新. 当新增监测数据时, 需重新初始化并执行全链采样, 这种"推倒重来"的计算模式严重制约其在PHM系统中的应用.</span>
<span id="cb1-634"><a href="#cb1-634"></a></span>
<span id="cb1-635"><a href="#cb1-635"></a>变分贝叶斯\index{变分贝叶斯} (Variational Bayesian, VB) 方法通过将贝叶斯\index{贝叶斯}推断转化为优化问题, 利用易处理的代理分布近似真实的后验分布, 并以Kullback-Leibler (KL) 散度最小化为目标函数 <span class="co">[</span><span class="ot">@jaakkola2000bayesian; @blei2017variational</span><span class="co">]</span>. 相较于MCMC\index{MCMC}, VB方法在保持精度的同时显著提升计算效率(例如在双随机效应\index{随机效应}维纳模型中效率提升达87% <span class="co">[</span><span class="ot">@zhou2020variational</span><span class="co">]</span>). 尽管VB方法在复杂模型中展现优势, 但在经典随机效应\index{随机效应}伽马退化模型中仍面临双重挑战:</span>
<span id="cb1-636"><a href="#cb1-636"></a></span>
<span id="cb1-637"><a href="#cb1-637"></a><span class="ss">-   </span>参数可解释性缺失: 传统模型通过尺度参数$\beta$引入异质性\index{异质性}效应, 但$\beta$的统计意义(影响退化增量均值$E<span class="co">[</span><span class="ot">Y(t)</span><span class="co">]</span>=\alpha t/\beta$)与工程认知(如退化速率、环境应力加速效应)缺乏直接对应, 导致先验\index{先验}分布设定与后验解释存在障碍.</span>
<span id="cb1-638"><a href="#cb1-638"></a><span class="ss">-   </span>数值稳定性缺陷: 由于伽马分布\index{伽马分布}的共轭结构限制, 传统变分后验需通过数值积分处理随机效应\index{随机效应}, 这容易出现浮点溢出或精度丢失问题.</span>
<span id="cb1-639"><a href="#cb1-639"></a></span>
<span id="cb1-640"><a href="#cb1-640"></a>针对上述问题, 本节提出重参数化伽马过程 (Reparametrized gamma process, RGa) 及相应的VB算法:</span>
<span id="cb1-641"><a href="#cb1-641"></a></span>
<span id="cb1-642"><a href="#cb1-642"></a><span class="ss">-   </span>提出了一种RGa模型, 它为模型参数赋予了明确的物理意义, 使得随机效应\index{随机效应}能够直接且清晰地融入模型, 同时影响退化过程\index{退化过程}的均值和波动性.</span>
<span id="cb1-643"><a href="#cb1-643"></a><span class="ss">-   </span>结合高斯-赫尔米特 (Gauss-Hermite, GH) 求积法<span class="co">[</span><span class="ot">@liu1994note</span><span class="co">]</span>和拉普拉斯近似<span class="co">[</span><span class="ot">@azevedo1994laplace</span><span class="co">]</span>, 介绍了一种具有解析形式的VB推断方法. 同时还基于GH求积法计算的观测信息矩阵, 提出了一种构建区间估计的高效策略, 补充了VB在区间估计方面的局限性.</span>
<span id="cb1-644"><a href="#cb1-644"></a></span>
<span id="cb1-645"><a href="#cb1-645"></a>本节结构如下: 第 @sec-ITR2023-s2 节将介绍重参数化伽马过程及产品寿命\index{寿命}分布的推导. 第 @sec-ITR2023-s3 节将提出基于GH求积法和拉普拉斯近似的VB方法, 并详细介绍区间估计方法. 第 @sec-ITR2023-s4 节和第 @sec-ITR2023-s5 节将分别进行数值实验和案例研究, 以验证所提方法的有效性.</span>
<span id="cb1-646"><a href="#cb1-646"></a></span>
<span id="cb1-647"><a href="#cb1-647"></a><span class="fu">### 重参化伽马过程 {#sec-ITR2023-s2}</span></span>
<span id="cb1-648"><a href="#cb1-648"></a></span>
<span id="cb1-649"><a href="#cb1-649"></a>令 $<span class="sc">\{</span>Y(t), t \geq 0<span class="sc">\}</span>$ 表示系统性能的退化过程\index{退化过程}. 称$<span class="sc">\{</span>Y(t), t \geq 0<span class="sc">\}</span>$ 服从RGa过程, 若其满足以下性质: (i) $Y(0)=0$; (ii) 对于任意的 $0 \leq t_{i}$, $i=1,\dots,4$, $Y(t_{1}) - Y(t_{2})$ 与 $Y(t_{3}) - Y(t_{4})$ 相互独立; (iii) 每个增量 $\Delta Y(t) = Y(t)-Y(t+\Delta t)$ 服从具有形状参数 $\alpha \Delta t$ 和尺度参数 $\eta/\alpha$ 的伽马分布\index{伽马分布}, 记为 $\textrm{Ga}(\alpha \Delta t, \eta/\alpha)$, 其中 $\alpha&gt;0, \eta&gt;0$. 根据伽马分布\index{伽马分布}的可加性, 可以推导出 $Y(t)\sim \textrm{Ga}(\alpha t, \eta/\alpha)$, 其PDF为 \begin{equation}\label{gammpdfx}</span>
<span id="cb1-650"><a href="#cb1-650"></a>    p_{Y(t)}(y \mid \eta,\alpha) = \frac{1}{\Gamma(\alpha t)}\left(\frac{\eta}{\alpha}\right)^{-\alpha t} y^{\alpha t -1} e^{-\frac{\alpha y}{\eta}}.</span>
<span id="cb1-651"><a href="#cb1-651"></a>\end{equation} 可算出$Y(t)$的均值、方差以及变异系数分别为$\eta t$, $\eta^2 t/\alpha$, 和$1/\sqrt{\alpha t}$. 因此, 参数 $\eta$ 表示平均退化速率 (或斜率), 而参数 $\alpha$ 则量化总体样本退化过程\index{退化过程}的波动程度. 经典伽马过程\index{伽马过程}的一个重要特性是其对退化均值和波动性的依赖性<span class="co">[</span><span class="ot">@tsai2012optimal</span><span class="co">]</span>. 正如 @Ye2015 所讨论的, 这种依赖关系在建模时有助于提高拟合精度. 从均值和方差可知, 所提出的RGa过程保持了这一特性, 但参数的解释性更加清晰. <span class="co">&lt;!--此外, 概率密度函数\eqref{gammpdfx}与广泛用于回归分析的伽马 分布具有相似的结构. 它们的主要区别在于, 前者的形状参数会随检测时间动态变化, 而后者的形状参数是固定的.--&gt;</span></span>
<span id="cb1-652"><a href="#cb1-652"></a></span>
<span id="cb1-653"><a href="#cb1-653"></a>在退化试验中, 由于材料内在差异性和操作环境的多样性, 同批次产品的性能退化\index{性能退化}路径可能存在差异. 为体现这种差异性, RGa 模型引入随机效应\index{随机效应}, 假设退化速率参数 $\eta$ 在不同单元间服从对数正态分布\index{正态分布}, 其PDF为 \begin{equation}</span>
<span id="cb1-654"><a href="#cb1-654"></a>\begin{aligned}</span>
<span id="cb1-655"><a href="#cb1-655"></a>    p(\eta \mid \mu,\sigma^2) =&amp; \frac{1}{\eta \sigma \sqrt{2\pi}} e^{-\frac{(\ln (\eta) -\mu)^2}{2\sigma^2}},</span>
<span id="cb1-656"><a href="#cb1-656"></a>\end{aligned} \label{lognorpdfx}</span>
<span id="cb1-657"><a href="#cb1-657"></a>\end{equation} 其中位置参数为 $\mu \in (-\infty, \infty)$, 尺度参数为 $\sigma &gt; 0$. 参数 $\eta$ 的均值和方差分别为 $e^{\mu+\sigma^2/2}$ 和 $\left(e^{\sigma^2}-1\right)e^{2\mu+\sigma^2}$. 当有关于参数$\eta$的先验\index{先验}信息时, 超参数$\mu$ 和 $\sigma^2$ 可以通过以下方式确定: $\mu = \mathbb{E}_{\eta}[\ln(\eta)]$, $\sigma^2 = \mathbb{E}_{\eta}<span class="co">[</span><span class="ot">(\ln (\eta) - \mu)^2</span><span class="co">]</span>$ <span class="co">[</span><span class="ot">@krishnamoorthy2016handbook</span><span class="co">]</span>. 随机效应\index{随机效应}采用对数正态分布\index{正态分布}有如下理由:</span>
<span id="cb1-658"><a href="#cb1-658"></a></span>
<span id="cb1-659"><a href="#cb1-659"></a><span class="ss">-   </span>对数正态分布\index{正态分布}的定义域为正实数, 适用于单调递增且为正的退化量. 单调递减的退化过程\index{退化过程}可通过简单的数学变换处理为单调递增的形式.</span>
<span id="cb1-660"><a href="#cb1-660"></a><span class="ss">-   </span>对数正态分布\index{正态分布}属于一类偏态分布, 具有较高的灵活性. 在实例分析中, 该分布对两组真实数据中随机效应\index{随机效应}变量 $\eta$ 的经验估计具有良好的拟合效果.</span>
<span id="cb1-661"><a href="#cb1-661"></a><span class="ss">-   </span>在变分推断框架下, 假设 $\eta$ 服从对数正态分布\index{正态分布}时, 参数 $(\mu, \sigma^2)$ 的联合变分后验分布很容易构造. 这一特性放宽了VB推断中参数完全独立的假设, 允许考虑 $(\mu, \sigma^2)$ 之间的相关性. 若 $\eta$ 服从其他正实数域分布, 则参数 $(\mu, \sigma^2)$ 的联合后验通常难以解析, 增加了推断复杂性.</span>
<span id="cb1-662"><a href="#cb1-662"></a><span class="ss">-   </span>相比经典伽马过程\index{伽马过程}中通过尺度参数引入个体异质性\index{异质性}的方式, RGa 模型中的随机效应\index{随机效应}设置针对退化速率, 更具物理意义.</span>
<span id="cb1-663"><a href="#cb1-663"></a><span class="ss">-   </span>所提模型的退化均值仅依赖于 $\eta$, 而不受形状参数 $\alpha$ 的影响. 在VB推断中, 假设 $\alpha$ VB与 $(\mu, \sigma^2)$ 独立有一定的合理性, 间接减少了由近似带来的信息损失.</span>
<span id="cb1-664"><a href="#cb1-664"></a><span class="ss">-   </span>在固定检测频率 $\Delta t$ 下, 包含对数正态随机效应\index{随机效应}的 RGa 模型结构与伽马对数正态模型<span class="co">[</span><span class="ot">@turlapaty2020variational</span><span class="co">]</span>相似, 其在无线通信系统的建模中有广泛应用.</span>
<span id="cb1-665"><a href="#cb1-665"></a></span>
<span id="cb1-666"><a href="#cb1-666"></a>基于带随机效应\index{随机效应}的RGa模型, 可得到$Y(t)$ 的边际PDF (见定理 @thm-ITR2023-th1), 详细数学推导请参见本节附录 @sec-Append-3B.</span>
<span id="cb1-667"><a href="#cb1-667"></a></span>
<span id="cb1-668"><a href="#cb1-668"></a>::: {#thm-ITR2023-th1}</span>
<span id="cb1-669"><a href="#cb1-669"></a>$Y(t)$ 的边际PDF为 \begin{equation}\label{ungamlnorpdfx2}</span>
<span id="cb1-670"><a href="#cb1-670"></a>    p_{Y(t)}(y_{t} \mid \boldsymbol{\Theta}) =</span>
<span id="cb1-671"><a href="#cb1-671"></a>        \frac{\alpha^{\alpha t} y_{t}^{\alpha t -1}}{\Gamma(\alpha t) \sqrt{\pi}} \int_{-\infty}^{+\infty} q(z,y_{t} \mid \boldsymbol{\Theta}) \exp(-z^2) \diff z,  </span>
<span id="cb1-672"><a href="#cb1-672"></a>\end{equation} 其中 $q(z,y_{t} \mid \boldsymbol{\Theta}) = \exp\left \lbrace {-\alpha t(\mu + z\sqrt{2\sigma^2}) -\alpha y_{t} \exp{<span class="co">[</span><span class="ot">-(\mu +z\sqrt{2\sigma^2})</span><span class="co">]</span>}}\right \rbrace$.</span>
<span id="cb1-673"><a href="#cb1-673"></a>:::</span>
<span id="cb1-674"><a href="#cb1-674"></a></span>
<span id="cb1-675"><a href="#cb1-675"></a>在式 \eqref{ungamlnorpdfx2} 中, 积分项难以直接解析计算, 因此需要采用数值方法进行近似. 不同与蒙特卡洛积分通过生成大量随机点来估计积分值, GH求积方法提供了一种高效的近似手段, 其通过选择最优的节点和权重, 能够精确计算特定阶数的多项式积分. 在计算效率和精度方面, GH求积法都远高于蒙特卡洛积分<span class="co">[</span><span class="ot">@seo2017data</span><span class="co">]</span>. 利用GH求积法, 式 \eqref{ungamlnorpdfx2} 可数值近似为 \begin{equation}\label{galnorGH}</span>
<span id="cb1-676"><a href="#cb1-676"></a>    \int_{-\infty}^{+\infty} q(z,y_{t} \mid \boldsymbol{\Theta}) \exp(-z^2) \diff z \approx \sum_{l=1}^{L} w(z_{l}) q(z_{l},y_{t} \mid \boldsymbol{\Theta}), </span>
<span id="cb1-677"><a href="#cb1-677"></a>\end{equation} 其中$z_{l}, l=1,\dots, L$ 是 $L$ 阶Hermite多项式 $H_{L}(z_{l})$ 的根 <span class="co">[</span><span class="ot">@davis2007methods</span><span class="co">]</span>, 其表达式为 $$H_{L}(z_{l}) = L!\sum_{k=1}^{\lfloor\frac{L}{2}\rfloor}\frac{(-1)^{k}(2z_{l})^{L-2k}}{k!(L-2k)!},</span>
<span id="cb1-678"><a href="#cb1-678"></a>$$ 而权重函数 $w(z_{l})$ (称为 GH 因子) 定义为 $w(z_{l}) = (2^{n-1}n!\sqrt{\pi})(n^2(H_{L-1}(z_{l})))$. 图 @fig-fig:pdfyt 展示了基于 GH近似的PDF \eqref{galnorGH} 与四种不同情况下的经验PDF. 结果表明, GH 方法近似的PDF 在所有情况下均表现良好.</span>
<span id="cb1-679"><a href="#cb1-679"></a></span>
<span id="cb1-682"><a href="#cb1-682"></a><span class="in">```{r}</span></span>
<span id="cb1-683"><a href="#cb1-683"></a><span class="co">#| label: fig-fig:pdfyt</span></span>
<span id="cb1-684"><a href="#cb1-684"></a><span class="co">#| fig.align: 'center'</span></span>
<span id="cb1-685"><a href="#cb1-685"></a><span class="co">#| echo: FALSE</span></span>
<span id="cb1-686"><a href="#cb1-686"></a><span class="co">#| out.width: '95%'</span></span>
<span id="cb1-687"><a href="#cb1-687"></a><span class="co">#| fig.cap: '不同设置下的 $y_{t}$ 的PDF.'</span></span>
<span id="cb1-688"><a href="#cb1-688"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/Gamma/ITR2023/pdfyt.pdf"</span>)</span>
<span id="cb1-689"><a href="#cb1-689"></a><span class="in">```</span></span>
<span id="cb1-690"><a href="#cb1-690"></a></span>
<span id="cb1-691"><a href="#cb1-691"></a>接下来对产品寿命\index{寿命}分布进行分析. 设退化阈值\index{退化阈值}为 $\omega$, 产品寿命\index{寿命} $T$ 的CDF表示为 \begin{align}\label{cdfgamlonr}</span>
<span id="cb1-692"><a href="#cb1-692"></a>    F_{T}(t) = 1 - Pr(Y(t) \leq \omega)= \int_{\omega}^{\infty} p_{Y(t)}(y_{t} \mid \boldsymbol{\Theta}) \diff y_{t}.</span>
<span id="cb1-693"><a href="#cb1-693"></a>\end{align} 利用 $p_{Y(t)}(y_{t} \mid \boldsymbol{\Theta})$ 的精确近似, 式 \eqref{cdfgamlonr} 可通过梯形积分法计算. 在每个检测点$\tilde{t}$处, 定义 $G(y \mid \tilde{t},\boldsymbol{\Theta})=\tilde{p}_{Y(\tilde{t})}(y_{\tilde{t}} \mid \boldsymbol{\Theta})$, 其中 $\tilde{p}_{Y(\tilde{t})}(y_{\tilde{t}} \mid \boldsymbol{\Theta})$ 是 $p_{Y(t)}(y_{t} \mid \boldsymbol{\Theta})$ 的GH积分近似. 随后, 使用 R 软件 *pracma* [@pracma2021]包中的 *trapz()* 函数计算积分 $\int_{\omega}^{\infty} G(y \mid \tilde{t},\boldsymbol{\Theta}) \diff y$, 该方法与梯形规则积分一致. 为验证积分效果, 图 @fig-fig:cdft 比较了基于 GH 的积分框架与不同参数 $\boldsymbol{\Theta}$ 和退化阈值\index{退化阈值} $\omega$ 下寿命\index{寿命} $T$ 的 BS 分布近似. 结果显示, 两种方法几乎无差异.</span>
<span id="cb1-694"><a href="#cb1-694"></a></span>
<span id="cb1-697"><a href="#cb1-697"></a><span class="in">```{r}</span></span>
<span id="cb1-698"><a href="#cb1-698"></a><span class="co">#| label: fig-fig:cdft</span></span>
<span id="cb1-699"><a href="#cb1-699"></a><span class="co">#| fig.align: 'center'</span></span>
<span id="cb1-700"><a href="#cb1-700"></a><span class="co">#| echo: FALSE</span></span>
<span id="cb1-701"><a href="#cb1-701"></a><span class="co">#| out.width: '95%'</span></span>
<span id="cb1-702"><a href="#cb1-702"></a><span class="co">#| fig.cap: '不同设置下寿命 $T$ 的CDF.'</span></span>
<span id="cb1-703"><a href="#cb1-703"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/Gamma/ITR2023/cdfT.pdf"</span>)</span>
<span id="cb1-704"><a href="#cb1-704"></a><span class="in">```</span></span>
<span id="cb1-705"><a href="#cb1-705"></a></span>
<span id="cb1-706"><a href="#cb1-706"></a><span class="fu">### 变分贝叶斯推断 {#sec-ITR2023-s3}</span></span>
<span id="cb1-707"><a href="#cb1-707"></a></span>
<span id="cb1-708"><a href="#cb1-708"></a>在退化试验中, 假设产品的性能特征具有递增的退化路径. 设 $\mathbf{y}_{n}$ 为第 $n$ 个样本的观测退化数据, 该样本在检测时间点 $t_{n,m}$ 处的观测值 $y_{n,m}$, 其中 $n=1,\dots,N$, $m=1,\dots,M_{n}$, $N$ 表示样本量, $M_{n}$为第 $n$ 个样本的测量次数. 为简化表示, 定义 $\mathbf{y} = \{\mathbf{y}_{n}\}_{n=1}^{N}$, 其中 $\mathbf{y}_{n}=\{y_{n,m}\}_{m=1}^{M_{n}}$. 假设 $\mathbf{y}$ 是来自RGa 过程 $\{Y(t), t \geq 0\}$ 的一组观测值. 定义增量 $x_{n,m} = \Delta y_{n,m}=y_{n,m}-y_{n,m-1}$, 时间间隔 $h_{nm} = \Delta t_{n,m}=t_{n,m}-t{n,m-1}$, 其中$y_{n,0}=t_{n,0}=0$. 记$\mathbf{x}_{n} = \{x_{n,m}\}_{m=1}^{M_{n}}$, $\mathbf{x} = \{\mathbf{x}_{n}\}_{n=1}^{N}$. 为符号方便, 假设$M_{n} = M$, $h_{n,m}=h_{c}$, 即, 试验采用等间隔测量, 且所有样本的测量次数相同. 根据RGa过程的性质 (iii), 增量$\mathbf{x}$相互独立, 且服从伽马分布\index{伽马分布}. 在给定随机效应\index{随机效应} $\boldsymbol{\eta} = \{\eta_{n}\}_{n=1}^{N}$ 时, 增量 $x_{n,m}$ 的条件PDF为 \begin{equation}</span>
<span id="cb1-709"><a href="#cb1-709"></a>\begin{aligned}</span>
<span id="cb1-710"><a href="#cb1-710"></a>    p_{x \mid \eta_{n}}(x_{n,m} \mid \alpha h_{c}, \eta_{n}) = \frac{x_{n,m}^{\alpha h_{c}-1}}{\Gamma (\alpha h_{c})} \left(\frac{\eta_{n}}{\alpha}\right)^{-\alpha h_{c}}%<span class="sc">\\</span>\nonumber</span>
<span id="cb1-711"><a href="#cb1-711"></a>    e^{-\frac{ \alpha x_{n,m}}{\eta_{n}}}.</span>
<span id="cb1-712"><a href="#cb1-712"></a>\end{aligned}\label{gammpdf}</span>
<span id="cb1-713"><a href="#cb1-713"></a>\end{equation} 随机效应\index{随机效应} $\boldsymbol{\eta}$为独立同分布的对数正态分布\index{正态分布}, 其PDF为 \begin{equation}\label{lognorpdf}</span>
<span id="cb1-714"><a href="#cb1-714"></a>   p(\boldsymbol{\eta} \mid \mu,\sigma^2)=\prod_{n=1}^{N}  p(\eta_{n} \mid \mu,\sigma^2) = \prod_{n=1}^{N}\frac{1}{\eta_{n} \sigma \sqrt{2\pi}} e^{-\frac{(\ln(\eta_{n}) -\mu)^2}{2\sigma^2}}.</span>
<span id="cb1-715"><a href="#cb1-715"></a>\end{equation} 令 $\boldsymbol{\Theta}=(\alpha, \mu, \sigma^2)$, 则 $(\boldsymbol{\eta}, \boldsymbol{\Theta})$ 的联合后验分布为 \begin{equation} \label{gamjointpdf}</span>
<span id="cb1-716"><a href="#cb1-716"></a>  p(\boldsymbol{\eta}, \boldsymbol{\Theta} \mid \mathbf{x}) \propto \prod_{n=1}^{N}\left<span class="co">[</span><span class="ot">p(\eta_{n} \mid \mu,\sigma^2)\prod_{m=1}^{M}p_{x \mid \eta}(x_{n,m} \mid \alpha h_{c}, \eta_{n})\right</span><span class="co">]</span> p(\alpha)p(\mu,\sigma^2),</span>
<span id="cb1-717"><a href="#cb1-717"></a>\end{equation} 其中 $p(\alpha)$ 和 $p(\mu,\sigma^2)$ 分别是参数 $\alpha$ 和 $(\mu,\sigma^2)$ 的先验\index{先验}分布. 式 \eqref{gamjointpdf} 中的先验\index{先验}设置隐含了以下假设: (i) 允许参数 $\mu$ 和 $\sigma^2$ 存在一定的相关性, 可选用二元分布作为其先验\index{先验}; (ii) 假设 $\alpha$ 与 $(\mu, \sigma^2)$ 相互独立. 这一假设基于上一节中关于随机效应\index{随机效应}设置的讨论, 认为 $\alpha$ 主要描述形状参数的变化, 与刻画单元间异质性\index{异质性}的参数 $(\mu, \sigma^2)$ 无关.</span>
<span id="cb1-718"><a href="#cb1-718"></a></span>
<span id="cb1-719"><a href="#cb1-719"></a><span class="fu">#### 变分贝叶斯估计</span></span>
<span id="cb1-720"><a href="#cb1-720"></a></span>
<span id="cb1-721"><a href="#cb1-721"></a>由于式 \eqref{gamjointpdf} 中参数的后验分布非常复杂, 直接进行统计推断较为困难, VB方法通过引入一组可处理的变分后验密度 (Variational posterior density, VPD) $q(\boldsymbol{\Theta},\boldsymbol{\eta})$ 来近似真实的后验密度 $p(\boldsymbol{\eta}, \boldsymbol{\Theta} \mid \mathbf{x})$, 即 $p(\boldsymbol{\eta}, \boldsymbol{\Theta} \mid \mathbf{x}) \approx q(\boldsymbol{\eta}, \boldsymbol{\Theta})$, 该近似可通过求解以下约束优化问题确定. \begin{equation}\label{optim}</span>
<span id="cb1-722"><a href="#cb1-722"></a>    q^{*}(\boldsymbol{\Theta},\boldsymbol{\eta}) = \mathop{\textrm{arg max}}\limits_{q(\boldsymbol{\Theta},\boldsymbol{\eta}) \in \mathcal{Q}} -F(q(\boldsymbol{\Theta},\boldsymbol{\eta})), s.t. \int q(\boldsymbol{\Theta},\boldsymbol{\eta}) d\boldsymbol{\Theta} d\boldsymbol{\eta} =1,</span>
<span id="cb1-723"><a href="#cb1-723"></a>\end{equation} 其中 $F(q(\boldsymbol{\eta}, \boldsymbol{\Theta}))= E_{\boldsymbol{\Theta},\boldsymbol{\eta}}\log\left( \frac{q(\boldsymbol{\eta}, \boldsymbol{\Theta})}{p(\boldsymbol{\eta}, \boldsymbol{\Theta} \mid \mathbf{x})} \right)$, 即, $q(\boldsymbol{\eta}, \boldsymbol{\Theta})$和 $p(\boldsymbol{\eta}, \boldsymbol{\Theta} \mid \mathbf{x})$的Kullback-Liebler(KL) 散度. $\mathcal{Q}$ 表示所有潜在VPD的集合. 通常而言, 集合 $\mathcal{Q}$ 的选择直接决定了 VPD 的复杂性, 从而影响优化问题 \eqref{optim} 的求解难度, 并进一步影响 VB 推断的计算效率. 因此, 合理选择 $\mathcal{Q}$ 至关重要, 它应足够简单, 以确保优化问题 \eqref{optim} 可行, 同时又要具备足够的灵活性, 以准确逼近真实的后验分布. 一种常用的选择是均值场变分族 (Mean-field variational family, MFVF), 该方法假设模型参数之间相互独立, 或者在一定条件下表现出独立性. 在 MFVF下, 可以进一步假设:\</span>
<span id="cb1-724"><a href="#cb1-724"></a>\begin{equation}\label{gamfvf}</span>
<span id="cb1-725"><a href="#cb1-725"></a>    q(\boldsymbol{\Theta},\boldsymbol{\eta}) = \prod_{n=1}^{N} q(\eta_{n}) q(\alpha) q(\mu,\sigma^2).</span>
<span id="cb1-726"><a href="#cb1-726"></a>\end{equation} 其中 $q(\eta_{n})$、$q(\alpha)$ 和 $q(\mu,\sigma^2)$ 分别是 $\eta_{n}$、$\alpha$ 和 $(\mu,\sigma^2)$ 的VPD. 该分解形式在降低计算复杂度的同时, 仍能有效逼近真实的后验分布. 将 MFVF \eqref{gamfvf} 代入优化目标 \eqref{optim} 中, 然后使用拉格朗日乘数法求解式\eqref{optim}, 得到 \begin{equation}\label{new_lg}</span>
<span id="cb1-727"><a href="#cb1-727"></a>    F_{1}(q(\boldsymbol{\Theta},\boldsymbol{\eta}))=F(q(\boldsymbol{\Theta},\boldsymbol{\eta}))+\boldsymbol{\lambda}^{T} \left(\int (q(\boldsymbol{\Theta},\boldsymbol{\eta})-1) d\boldsymbol{\Theta} d\boldsymbol{\eta}\right),</span>
<span id="cb1-728"><a href="#cb1-728"></a>\end{equation} 其中向量 $\boldsymbol{\lambda}=(\left<span class="sc">\{</span>\lambda_{\eta_{n}}\right<span class="sc">\}</span>_{n=1}^{N},\lambda_{\alpha},\lambda_{\mu},\lambda_{\sigma^2})$ 是拉格朗日乘数, 表示 $q(\boldsymbol{\Theta},\boldsymbol{\eta})$ 对目标函数的边际效应.</span>
<span id="cb1-729"><a href="#cb1-729"></a></span>
<span id="cb1-730"><a href="#cb1-730"></a>VB算法可视为传统EM方法和贝叶斯\index{贝叶斯}推断在计算时间和计算效率上的一种折中, 通过使用易处理的代理分布来近似复杂的贝叶斯\index{贝叶斯}后验. 它利用KL散度将贝叶斯\index{贝叶斯}推断转化为数值优化问题, 从随机模拟转向确定性优化. 如 @blei2017variational 所述, VB的优化分为两个迭代步骤: 针对潜在变量的VB后验更新 (变分贝叶斯\index{变分贝叶斯}期望 (VB-E) 步骤) 和针对目标参数的VB后验更新 (变分贝叶斯\index{变分贝叶斯}最大化 (VB-M) 步骤) , 与EM算法\index{EM算法}的迭代过程相似.</span>
<span id="cb1-731"><a href="#cb1-731"></a></span>
<span id="cb1-732"><a href="#cb1-732"></a><span class="fu">##### VB-E: 最优潜变量</span></span>
<span id="cb1-733"><a href="#cb1-733"></a></span>
<span id="cb1-734"><a href="#cb1-734"></a>对式 \eqref{new_lg} 中关于 $q(\boldsymbol{\eta})$ 求导, 可以得到 $\boldsymbol{\eta}$ 的VPD的对数形式 \begin{equation*}</span>
<span id="cb1-735"><a href="#cb1-735"></a>\begin{aligned}</span>
<span id="cb1-736"><a href="#cb1-736"></a>    \ln(q(\boldsymbol{\eta})) =&amp; \sum_{n=1}^{N}\mathbb{E}_{\mu,\sigma^2}\left[\ln(p_{\eta}(\eta_{n} \mid \mu,\sigma^2))\right] + \sum_{n=1}^{N}\sum_{m=1}^{M}\mathbb{E}_{\alpha}\left[p_{x \mid \eta}(x_{n,m} \mid \alpha h_{c}, \eta_{n})\right] + C,</span>
<span id="cb1-737"><a href="#cb1-737"></a>\end{aligned}</span>
<span id="cb1-738"><a href="#cb1-738"></a>\end{equation*} 其中$C$表示常数. 为简便符号, 本节后续内容涉及到常数都用$C$来表示, 这不影响 各参数的VPD形式. 由独立性假设, $\eta_{n}$ 的VPD的对数形式为 \begin{equation*}</span>
<span id="cb1-739"><a href="#cb1-739"></a>\begin{aligned}</span>
<span id="cb1-740"><a href="#cb1-740"></a>    \ln(q(\eta_{n})) =&amp; \mathbb{E}_{\mu,\sigma^2}\left[\ln(p_{\eta}(\eta_{n} \mid \mu,\sigma^2))\right] + \sum_{m=1}^{M}\mathbb{E}_{q(\alpha)}\left[p_{x \mid \eta}(x_{n,m} \mid \alpha h_{c}, \eta_{n})\right] + C.</span>
<span id="cb1-741"><a href="#cb1-741"></a>\end{aligned}</span>
<span id="cb1-742"><a href="#cb1-742"></a>\end{equation*} 利用式 \eqref{gammpdf} 和 \eqref{lognorpdf}, 可以得到 \begin{equation}</span>
<span id="cb1-743"><a href="#cb1-743"></a>\begin{aligned}</span>
<span id="cb1-744"><a href="#cb1-744"></a>    \ln(q(\eta_{n})) = &amp;(w_{1}w_{2} - w_{0}Mh_{c}-1) \ln(\eta_{n}) - \frac{y_{n,M}w_{0}}{\eta_{n}} - w_{2}(\ln(\eta_{n}))^2/2 +C,</span>
<span id="cb1-745"><a href="#cb1-745"></a>\end{aligned}\label{vpdeta3}</span>
<span id="cb1-746"><a href="#cb1-746"></a>\end{equation} 其中$y_{n,M} = \sum_{m=1}^{M} x_{n,m}$, $w_{0} = \mathbb{E}_{\alpha}\left[\alpha\right]$, $w_{1}=\mathbb{E}_{\mu,\sigma^2}\left[\mu\right]$, 以及 $w_{2}=\mathbb{E}_{\mu,\sigma^2}\left[\sigma^{-2}\right]$. 则$\eta_{n}$ 的VPD可表示为 $q(\eta_{n}) = g_{0}(\eta_{n})/A_{\eta_{n}}$, 其中 $$</span>
<span id="cb1-747"><a href="#cb1-747"></a>g_{0}(\eta_{n}) = \eta_{n}^{w_{1}w_{2} - w_{0}Mh_{c}-1} e^{- \frac{y_{n,M}w_{0}}{\eta_{n}}- \frac{w_{2}(\ln(\eta_{n}))^2}{2}},</span>
<span id="cb1-748"><a href="#cb1-748"></a>$$ $A_{\eta_{n}} = \int_{0}^{+\infty} g_{0}(\eta_{n}) \diff\eta_{n}$为正则化常数. 令 $s = \ln(\eta_{n})\sqrt{w_{2}/2}$. 将 $s$ 代入 $g_{0}(\eta_{n})$ 得到 \begin{equation}\label{g0etan}</span>
<span id="cb1-749"><a href="#cb1-749"></a>    g_{0}(\eta_{n}) = q(s,y_{n,M} \mid w_{0},w_{1},w_{2})e^{-s^2},</span>
<span id="cb1-750"><a href="#cb1-750"></a>\end{equation} 其中 \begin{equation*}</span>
<span id="cb1-751"><a href="#cb1-751"></a>\begin{aligned}</span>
<span id="cb1-752"><a href="#cb1-752"></a>    q(s,y_{n,M}&amp; \mid w_{0},w_{1},w_{2}) =\sqrt{2/w_{2}}e^{s\sqrt{2/w_{2}}(w_{1}w_{2}-w_{0}Mh_{c}) -e^{-y_{n,M}w_{0}s\sqrt{2/w_{2}}}}.</span>
<span id="cb1-753"><a href="#cb1-753"></a>\end{aligned}</span>
<span id="cb1-754"><a href="#cb1-754"></a>\end{equation*} 注意到 $g_{0}(\eta_{n})$ 与式 \eqref{galnorGH} 中的被积函数具有相同的结构. 因此, $A_{\eta_{n}}$ 也可以通过第 @sec-ITR2023-s2 节中介绍的GH求积方法来计算. 基于式 \eqref{vpdeta3} 和 \eqref{g0etan}, 任何连续函数 $f(\eta_{n})$ 的期望可以表示为 \begin{align}</span>
<span id="cb1-755"><a href="#cb1-755"></a>    \mathbb{E}_{\eta_{n}}(f(\eta_{n})) = &amp; \int_{0}^{+\infty} f(\eta_{n}) q(\eta_{n}) \diff \eta_{n}\nonumber\\ =&amp;\frac{1}{A_{\eta_{n}}}\int_{-\infty}^{+\infty} f(\exp(s\sqrt{2/w_{2}}))e^{-s^2} q(s,y_{n,M} \mid w_{0},w_{1},w_{2})\diff s,\label{meta}</span>
<span id="cb1-756"><a href="#cb1-756"></a>\end{align} 这一积分也可通过GH求积法进行数值计算.</span>
<span id="cb1-757"><a href="#cb1-757"></a></span>
<span id="cb1-758"><a href="#cb1-758"></a><span class="fu">##### VB-M: 最优模型参数</span></span>
<span id="cb1-759"><a href="#cb1-759"></a></span>
<span id="cb1-760"><a href="#cb1-760"></a>对式 \eqref{new_lg} 中关于 $q(\boldsymbol{\Theta})$ 求导, 可以得到 $\boldsymbol{\Theta}$ 的VPD的对数形式为 \begin{equation}\label{vpdotr}</span>
<span id="cb1-761"><a href="#cb1-761"></a>    \begin{split}</span>
<span id="cb1-762"><a href="#cb1-762"></a>        \ln(q(\alpha,\mu,\sigma^2)) =&amp; \sum_{n=1}^{N}\left<span class="co">[</span><span class="ot">E_{\eta_{n}}\left[\ln(p(\eta_{n} \mid \mu,\sigma^2))\right]\right</span><span class="co">]</span> \nonumber<span class="sc">\\</span></span>
<span id="cb1-763"><a href="#cb1-763"></a>        &amp;+</span>
<span id="cb1-764"><a href="#cb1-764"></a>        \sum_{n=1}^{N}\sum_{m=1}^{M}\left<span class="co">[</span><span class="ot">E_{q(\eta_{n})}\left[\ln(p(x_{n,m} \mid \eta_{n},\alpha))\right]\right</span><span class="co">]</span> \nonumber<span class="sc">\\</span></span>
<span id="cb1-765"><a href="#cb1-765"></a>        &amp;+ \ln(p(\alpha)) + \ln(p(\mu,\sigma^2)) +C.</span>
<span id="cb1-766"><a href="#cb1-766"></a>    \end{split}</span>
<span id="cb1-767"><a href="#cb1-767"></a>\end{equation} 可发现 $\alpha$ 和 $(\mu,\sigma^2)$是相互独立的. 因此, 给定 $q(\eta_{n}), n=1,2,\dots, N$后, 可以依次推导出 $q(\alpha)$ 和 $q(\mu,\sigma^2)$ 的VPD表达式.</span>
<span id="cb1-768"><a href="#cb1-768"></a></span>
<span id="cb1-769"><a href="#cb1-769"></a>i)  $\alpha$ 的VPD: $\alpha$ 的VPD的对数形式为 \begin{equation}</span>
<span id="cb1-770"><a href="#cb1-770"></a>      \begin{aligned}</span>
<span id="cb1-771"><a href="#cb1-771"></a>      \ln(q(\alpha)) =&amp; \sum_{n=1}^{N}\sum_{m=1}^{M}\left<span class="co">[</span><span class="ot">E_{q(\eta_{n})}\left[\ln(p(x_{n,m} \mid \eta_{n},\alpha))\right]\right</span><span class="co">]</span> + \ln(p(\alpha)) + C.</span>
<span id="cb1-772"><a href="#cb1-772"></a>      \end{aligned}\label{vpdalp0}</span>
<span id="cb1-773"><a href="#cb1-773"></a>    \end{equation} 再将 \eqref{gammpdf} 和 \eqref{lognorpdf} 代入 \eqref{vpdalp0}, 得到 \begin{equation}</span>
<span id="cb1-774"><a href="#cb1-774"></a>      \begin{aligned}</span>
<span id="cb1-775"><a href="#cb1-775"></a>      \ln(q(\alpha)) = &amp;  - (h_{c}(Mw_{3}-w_{5}) + w_{4}) \alpha + \alpha h_{c} NM \ln(\alpha)\nonumber<span class="sc">\\</span></span>
<span id="cb1-776"><a href="#cb1-776"></a>        &amp;- NM \ln(\Gamma(\alpha h_{c})) + \ln(p(\alpha)) + C,</span>
<span id="cb1-777"><a href="#cb1-777"></a>      \end{aligned}\label{vpdalp1}</span>
<span id="cb1-778"><a href="#cb1-778"></a>    \end{equation} 其中 $$</span>
<span id="cb1-779"><a href="#cb1-779"></a>    w_{3}=\sum_{n=1}^{N} E_{\eta_{n}}\left<span class="co">[</span><span class="ot">\ln(\eta_{n})\right</span><span class="co">]</span>,</span>
<span id="cb1-780"><a href="#cb1-780"></a>    w_{4}= \sum_{n=1}^{N}y_{nM}E_{\eta_{n}}\left<span class="co">[</span><span class="ot">\eta_{n}^{-1}\right</span><span class="co">]</span>,</span>
<span id="cb1-781"><a href="#cb1-781"></a>    w_{5}=\sum_{n=1}^{N}\sum_{m=1}^{M}\log(x_{nm}),</span>
<span id="cb1-782"><a href="#cb1-782"></a>    $$ 并且 $E_{\eta_{n}}\left<span class="co">[</span><span class="ot">\ln(\eta_{n})\right</span><span class="co">]</span>$ 和 $E_{\eta_{n}}\left<span class="co">[</span><span class="ot">\eta_{n}^{-1}\right</span><span class="co">]</span>$ 可以通过式 \eqref{meta}更新. 对\eqref{vpdalp1} 两边取指数变换, 可得到 \begin{equation}\label{vpdalp2}</span>
<span id="cb1-783"><a href="#cb1-783"></a>    q(\alpha) \propto p(\alpha) \frac{\alpha^{a\alpha}}{\Gamma(\alpha h_{c})^b}\exp\left(-c\alpha\right),</span>
<span id="cb1-784"><a href="#cb1-784"></a>    \end{equation} 其中 $a = h_{c}NM$, $b=NM$, $c=h_{c}(Mw_{3}-w_{5})+w_{4}$. 为方便数学推导, 使用共轭先验\index{先验}可简化计算<span class="co">[</span><span class="ot">@gelman2014bayesian</span><span class="co">]</span>. 可验证: 当先验\index{先验}$p(\alpha)$取以下形式时, 其与 $q(\alpha)$属于相同的分布族:\</span>
<span id="cb1-785"><a href="#cb1-785"></a>    \begin{equation}\label{vpdalppri}</span>
<span id="cb1-786"><a href="#cb1-786"></a>      p(\alpha) \propto \frac{\alpha^{a_{0}}}{\Gamma(\alpha h_{c})^{b_{0}}}\exp(-c_{0}\alpha),</span>
<span id="cb1-787"><a href="#cb1-787"></a>    \end{equation} 其中 $a_{0}$、$b_{0}$ 和 $c_{0}$ 是先验\index{先验} $p(\alpha)$ 的超参数. 将 \eqref{vpdalppri} 代入 \eqref{vpdalp2} 并计算正则化常数, 可得 \begin{equation}\label{vpdalppos}</span>
<span id="cb1-788"><a href="#cb1-788"></a>    q(\alpha) = g_{\alpha}(\alpha)/A_{\alpha}</span>
<span id="cb1-789"><a href="#cb1-789"></a>    \end{equation} 其中 $$</span>
<span id="cb1-790"><a href="#cb1-790"></a>    g_{\alpha}(\alpha) = \frac{\alpha^{a_{1}\alpha}}{\Gamma(\alpha h_{c})^{b_{1}}}\exp(-c_{1}\alpha),~~A_{\alpha} = \int_{\Omega_{\alpha}} g_{\alpha}(\alpha) \diff \alpha,</span>
<span id="cb1-791"><a href="#cb1-791"></a>    $$ $a_{1}=a_{0}+a$, $b_{1}=b_{0}+b$, $c_{1}=c_{0}+c$. 然而, 由于 $g_{\alpha}(\alpha)$ 的积分可能在数值上不稳定, 通过 \eqref{vpdalppos} 计算 $\alpha$ 的VPD的均值和方差比较困难. 作为替代方案, 可对 \eqref{vpdalppos} 进行拉普拉斯近似. 此时, $\alpha$ 的VPD的均值和方差可近似为 \begin{equation*}</span>
<span id="cb1-792"><a href="#cb1-792"></a>      \begin{aligned}</span>
<span id="cb1-793"><a href="#cb1-793"></a>    m(\alpha) &amp;\approx \arg \min_{\alpha} \left<span class="sc">\{</span>a_{1}\log(\alpha)-b_{1} h_{c} \psi(\alpha h_{c}) + a_{1}-c_{1}\right<span class="sc">\}</span>,\nonumber<span class="sc">\\</span></span>
<span id="cb1-794"><a href="#cb1-794"></a>    v(\alpha) &amp;\approx \frac{1}{bh_{c}^{2}\psi'(m(\alpha) h_{c})- \frac{a_{1}}{m(\alpha)}}.</span>
<span id="cb1-795"><a href="#cb1-795"></a>      \end{aligned}</span>
<span id="cb1-796"><a href="#cb1-796"></a>    \end{equation*}</span>
<span id="cb1-797"><a href="#cb1-797"></a></span>
<span id="cb1-798"><a href="#cb1-798"></a>ii) 参数 $(\mu,\sigma^2)$的联合VPD: 基于 \eqref{vpdotr}, $(\mu, \sigma^2)$ 的联合VPD的对数形式为 \begin{equation}</span>
<span id="cb1-799"><a href="#cb1-799"></a>      \begin{aligned}\label{vpdmu0}</span>
<span id="cb1-800"><a href="#cb1-800"></a>    \ln(q(\mu,\sigma^2)) =&amp; \sum_{n=1}^{N}\left<span class="co">[</span><span class="ot">E_{q(\eta_{n})}\left[\ln(p(\eta_{n}|\mu,\sigma^2))\right]\right</span><span class="co">]</span> + \ln(p(\mu,\sigma^2)) +C.</span>
<span id="cb1-801"><a href="#cb1-801"></a>      \end{aligned}</span>
<span id="cb1-802"><a href="#cb1-802"></a>    \end{equation} 将 \eqref{gammpdf} 和\eqref{lognorpdf}代入 \eqref{vpdmu0} 并对结果取指数, 可得 \begin{equation}</span>
<span id="cb1-803"><a href="#cb1-803"></a>      \begin{aligned}</span>
<span id="cb1-804"><a href="#cb1-804"></a>    q(\mu,\sigma^2) \propto p(\mu,\sigma^2)(\sigma^{2})^{-N/2}%\nonumber<span class="sc">\\</span></span>
<span id="cb1-805"><a href="#cb1-805"></a>    e^{- \frac{w_{6}-w_{3}^{2}/N}{2\sigma^2} - \frac{N(\mu-w_{3}/N)^2}{2\sigma^2}},</span>
<span id="cb1-806"><a href="#cb1-806"></a>    \end{aligned}\label{vpdmu1}</span>
<span id="cb1-807"><a href="#cb1-807"></a>    \end{equation} 其中 $$w_{6} = \sum_{n=1}^{N} E_{q(\eta_{n})}\left<span class="co">[</span><span class="ot">(\ln(\eta_{n}))^2\right</span><span class="co">]</span>,</span>
<span id="cb1-808"><a href="#cb1-808"></a>    E_{\eta_{n}}\left<span class="co">[</span><span class="ot">(\ln(\eta_{n}))^2\right</span><span class="co">]</span></span>
<span id="cb1-809"><a href="#cb1-809"></a>    $$ 可以通过式 \eqref{meta} 计算. 若 $p(\mu,\sigma^2)$ 服从正态逆伽马 (Normal inverse gamma, NIGa) 分布, 式 \eqref{vpdmu1} 恰好是NIGa密度函数的核 <span class="co">[</span><span class="ot">@bolstad2016introduction</span><span class="co">]</span>. 通常, 随机变量 $(X,Y)$ 服从 $\textrm{NIGa}((x,y); \rho, \varsigma, \nu, \xi)$, 其PDF为 : \begin{equation}\label{niga}</span>
<span id="cb1-810"><a href="#cb1-810"></a>      p(x,y) = \frac{\sqrt{\varsigma}}{\sqrt{y}\sqrt{2\pi}}\frac{\xi^{\nu}}{\Gamma(\nu)}y^{-\nu-1}e^{-\frac{2\xi + \varsigma (x-\rho)^2}{2y}}, </span>
<span id="cb1-811"><a href="#cb1-811"></a>    \end{equation} 其中 $x \in (-\infty, +\infty)$, $y \in (0, +\infty)$, $\nu&gt;0$, $\xi&gt;0$, $\varsigma&gt;0$, 以及 $\rho\in(-\infty, +\infty)$ 是参数. 根据NIGa分布的定义 <span class="co">[</span><span class="ot">@denison2002bayesian</span><span class="co">]</span>, \eqref{niga} 可分解为在给定 $\sigma^2$ 条件下, $\mu$ 的均值为 $\rho$、方差为 $\sigma^2/\varsigma$ 的条件正态分布\index{正态分布}和形状参数为 $\nu$、尺度参数为 $\xi$ 的 $\sigma^2$ 的逆伽马分布. 因此, 可假设参数 $(\mu,\sigma^2)$ 的联合先验\index{先验}为 \begin{equation}\label{vpdmupri}</span>
<span id="cb1-812"><a href="#cb1-812"></a>      p(\mu,\sigma^2) = \textrm{NIGa}((\mu,\sigma^2); \rho_{0}, \varsigma_{0}, \nu_{0}, \xi_{0}).</span>
<span id="cb1-813"><a href="#cb1-813"></a>    \end{equation} 将式 \eqref{vpdmupri} 代入 \eqref{vpdmu1} 后, 可得到 $(\mu,\sigma^2)$ 的联合VPD为 \begin{equation}\label{vpdmupos}</span>
<span id="cb1-814"><a href="#cb1-814"></a>      q(\mu,\sigma^2) = \textrm{NIGa}((\mu,\sigma^2);  \rho_{1}, \varsigma_{1}, \nu_{1}, \xi_{1}),</span>
<span id="cb1-815"><a href="#cb1-815"></a>    \end{equation} 其中 $$</span>
<span id="cb1-816"><a href="#cb1-816"></a>    \begin{aligned}</span>
<span id="cb1-817"><a href="#cb1-817"></a>    \rho_{1}&amp;=\frac{1}{\varsigma_{1}}\left<span class="co">[</span><span class="ot">\varsigma_{0}\rho_{0}+w_{3}\right</span><span class="co">]</span>,</span>
<span id="cb1-818"><a href="#cb1-818"></a>    \varsigma_{1} = \varsigma_{0} + N,</span>
<span id="cb1-819"><a href="#cb1-819"></a>    \nu_{1} = \nu_{0} + \frac{N}{2},<span class="sc">\\</span></span>
<span id="cb1-820"><a href="#cb1-820"></a>    \xi_{1} &amp;= \xi_{0} + \frac{1}{2}\left<span class="co">[</span><span class="ot">\varsigma_{0}\rho_{0}^2+w_{6}-\varsigma_{1}\rho_{1}^2\right</span><span class="co">]</span>.</span>
<span id="cb1-821"><a href="#cb1-821"></a>    \end{aligned}</span>
<span id="cb1-822"><a href="#cb1-822"></a>    $$ 根据NIGa分布的性质 <span class="co">[</span><span class="ot">@bolstad2016introduction</span><span class="co">]</span>, $\mu$ 和 $\sigma^2$ 的VPD均值和方差为 \begin{equation*}</span>
<span id="cb1-823"><a href="#cb1-823"></a>      \begin{aligned}</span>
<span id="cb1-824"><a href="#cb1-824"></a>    m(\mu) =&amp;\rho_{1},~~~~v(\mu) = \frac{\xi_{1}}{\varsigma_{1}(\nu_{1}-1)},\nonumber<span class="sc">\\</span></span>
<span id="cb1-825"><a href="#cb1-825"></a>    m(\sigma^2) =&amp; \frac{\xi_{1}}{\nu_{1}-1},~~~~</span>
<span id="cb1-826"><a href="#cb1-826"></a>    v(\sigma^2) = \frac{\xi_{1}^2}{(\nu_{1}-1)^2(\nu_{1}-2)},</span>
<span id="cb1-827"><a href="#cb1-827"></a>      \end{aligned}</span>
<span id="cb1-828"><a href="#cb1-828"></a>    \end{equation*} 并且 $\sigma^{2}$ 的一阶逆矩等于 $\frac{\nu_{1}}{\xi_{1}}$.</span>
<span id="cb1-829"><a href="#cb1-829"></a></span>
<span id="cb1-830"><a href="#cb1-830"></a>通过当前模型的VB-E和VB-M步的更新方程, 可对这两步进行迭代, 直到估计方差不再显著改善, 即 \begin{equation}\label{differror}</span>
<span id="cb1-831"><a href="#cb1-831"></a>  \varepsilon(\boldsymbol{\Theta^{(s)}})= ||v(\boldsymbol{\Theta}^{(s)})-v(\boldsymbol{\Theta}^{(s-1)})||_{1}\leq \varepsilon_{0},</span>
<span id="cb1-832"><a href="#cb1-832"></a>\end{equation} 其中 $||\cdot||_{1}$ 为绝对值范数, $\varepsilon_{0}$ 是确定所需精度的预设值.</span>
<span id="cb1-833"><a href="#cb1-833"></a></span>
<span id="cb1-834"><a href="#cb1-834"></a>**注5**: VB算法是否成功与高效, 关键在于均值场变分族的假设和模型参数的共轭特性. 均值场变分族假设使得能够基于KL散度和拉格朗日优化算法求得近似贝叶斯\index{贝叶斯}后验分布. 共轭参数特性则提供了解析形式的近似贝叶斯\index{贝叶斯}后验. 对于非共轭模型参数, 也可以基于自然共轭先验\index{先验}通过拉普拉斯近似得到相应的变分后验. 这不仅减少了数值优化需求, 提高了计算效率, 而且在VB和贝叶斯\index{贝叶斯}后验中保持了结构的相似性, 从而提升了精度. 然而, 当模型参数如 $\eta$ 服从非共轭偏态分布时, 非共轭参数的增加则会降低模型的计算效率和精度.</span>
<span id="cb1-835"><a href="#cb1-835"></a></span>
<span id="cb1-836"><a href="#cb1-836"></a><span class="fu">#### 初始值确定</span></span>
<span id="cb1-837"><a href="#cb1-837"></a></span>
<span id="cb1-838"><a href="#cb1-838"></a>在VB算法中, 参数初始值的选择会影响算法的收敛时间及其局部最优解. 在本节中, 参数 $\bm{\Theta}$ 的初始值将通过以下步骤确定:</span>
<span id="cb1-839"><a href="#cb1-839"></a></span>
<span id="cb1-840"><a href="#cb1-840"></a><span class="ss">1.  </span>对于第$n$个样品, 分别计算增量 $\bm{X}_{n}$ 的均值和方差为 $\bar{x}_{n}=\frac{1}{M} \sum_{m=1}^{M} x_{n,m}$ 和 $V_{n} = \frac{1}{M-1} \sum_{m=1}^{M} (x_{n,m}-\bar{x}_{n})^2$.</span>
<span id="cb1-841"><a href="#cb1-841"></a></span>
<span id="cb1-842"><a href="#cb1-842"></a><span class="ss">2.  </span>由于增量 $\bm{X}_{n}$ 服从 $Ga(\alpha h_{c}, \eta_{n}/\alpha)$, 其均值为 $\eta_{n} h_{c}$, 方差为 $\eta_{n}^2 h_{c}/\alpha$, 因此可估计 $\eta_{n}$ 和 $\alpha$ 为 $\bar{x}_{n}/h_{c}$ 和 $\bar{x}_{n}^2/(V_{n} h_{c})$.</span>
<span id="cb1-843"><a href="#cb1-843"></a></span>
<span id="cb1-844"><a href="#cb1-844"></a><span class="ss">3.  </span>由 $<span class="sc">\{</span>\eta_{n}\}_{n=1}^{N}$, 参数 $\mu$ 和 $\sigma^2$ 的初始值可以通过以下公式确定: $\bar{\eta}_{n}=\frac{1}{N}\sum_{n=1}^{N} \ln(\eta_{n})$ 和 $V_{\ln(\eta_{n})} = \frac{1}{N-1}\sum_{n=1}^{N}(\ln(\eta_{n}) - \bar{\eta}_{n})^2$.</span>
<span id="cb1-845"><a href="#cb1-845"></a></span>
<span id="cb1-846"><a href="#cb1-846"></a><span class="fu">#### 置信区间</span></span>
<span id="cb1-847"><a href="#cb1-847"></a></span>
<span id="cb1-848"><a href="#cb1-848"></a>通过上述VB推断方法, 可得到每个 $\theta_{i}\in\boldsymbol{\Theta}$ 的VPD均值 $m(\theta_{i})$ 和方差 $v(\theta_{i})$. 然后构造 $\theta_{i}$ 的$100(1-\gamma)%$ 近似区间估计为 \begin{equation}\label{ci1}</span>
<span id="cb1-849"><a href="#cb1-849"></a>    m(\theta_{i}) \pm Z_{1-\gamma/2} \sqrt{v(\theta_{i})}, </span>
<span id="cb1-850"><a href="#cb1-850"></a>\end{equation} 其中 $Z_{\gamma}$ 为标准正态分布\index{正态分布}的$\gamma$分位数. 然而, 式 \eqref{ci1} 存在不足, 因为VB方法通常会低估后验分布的散度, 从而导致方差估计值比真实值小 <span class="co">[</span><span class="ot">@blei2017variational</span><span class="co">]</span>. 为了解决这个问题, @wang2005inadequacy 对VB推断方法下的区间估计进行改进, 其中VPD的方差可通过原始似然函数\index{似然函数}下的Fisher信息矩阵计算. 当Fisher信息矩阵计算困难时, 则可进一步用观测Fisher信息矩阵替代 <span class="co">[</span><span class="ot">@Meeker1998</span><span class="co">]</span>. 基于此思想, 当前模型的观测Fisher信息矩阵为 \begin{equation}\label{ci2}</span>
<span id="cb1-851"><a href="#cb1-851"></a>    \hat{I}_{\boldsymbol{\Theta}} = -\frac{\partial^2 \log\left(\ell(\boldsymbol{\Theta})\right)}{\partial \boldsymbol{\Theta}^{T} \partial\boldsymbol{\Theta}},</span>
<span id="cb1-852"><a href="#cb1-852"></a>\end{equation} 其中 \begin{equation*}</span>
<span id="cb1-853"><a href="#cb1-853"></a>\begin{aligned}</span>
<span id="cb1-854"><a href="#cb1-854"></a>    \ell(\boldsymbol{\Theta}) =&amp; - NM \log(\Gamma(\alpha h_{c})) -  NM \alpha h_{c} \log(\alpha) \nonumber<span class="sc">\\</span></span>
<span id="cb1-855"><a href="#cb1-855"></a>    &amp; + \sum_{n=1}^{N}\sum_{m=1}^{M} (\alpha h_{c}-1)\log(x_{n,m})-\frac{N}{2}\log(\pi)\nonumber<span class="sc">\\</span></span>
<span id="cb1-856"><a href="#cb1-856"></a>    &amp; + \sum_{n=1}^{N}\log\left<span class="co">[</span><span class="ot">\int_{-\infty}^{\infty} q(z,y_{n,M},\boldsymbol{\Theta})\exp(-z^2)\diff z\right</span><span class="co">]</span>,</span>
<span id="cb1-857"><a href="#cb1-857"></a>\end{aligned}</span>
<span id="cb1-858"><a href="#cb1-858"></a>\end{equation*} 其中 $z=\frac{\log(\eta_{n}-\mu)}{\sqrt{2\sigma^2}}$, \begin{align}\label{ci4}</span>
<span id="cb1-859"><a href="#cb1-859"></a>  q(z,y_{n,M},\boldsymbol{\Theta}) = e^{-\alpha h_{c} M\left(\sqrt{2\sigma^2}z+\mu\right) -\alpha y_{n,M} e^{-\sqrt{2\sigma^2}z-\mu}},</span>
<span id="cb1-860"><a href="#cb1-860"></a>\end{align} 详细导数可见本节附录 @sec-Append-3B. 本节附录 @sec-Append-3B 还给出其他两种基准估计方法, 分别为EM算法\index{EM算法}和贝叶斯\index{贝叶斯}方法. 后续会在数值模拟和案例研究中与所提VB推断方法进行比较.</span>
<span id="cb1-861"><a href="#cb1-861"></a></span>
<span id="cb1-862"><a href="#cb1-862"></a><span class="fu">### 模拟实验 {#sec-ITR2023-s4}</span></span>
<span id="cb1-863"><a href="#cb1-863"></a></span>
<span id="cb1-864"><a href="#cb1-864"></a>模拟实验将验证 VB 算法的计算精度, 同时比较VB、EM 和 MCMC\index{MCMC} 三种算法的计算效率. 三种方法的基本设置如下:</span>
<span id="cb1-865"><a href="#cb1-865"></a></span>
<span id="cb1-866"><a href="#cb1-866"></a><span class="ss">1.  </span>*VB 算法*: 先验\index{先验}分布 $p(\alpha)$ 和 $p(\mu, \sigma^2)$ 的超参数使用弱信息先验\index{先验}设定, 具体为 $a_0 = b_0 = c_0 = 1$, $\xi_0 = \varsigma_0 = \rho_0 = 1$, $\nu_0 = 0$, 以便与 EM 算法进行公平比较.</span>
<span id="cb1-867"><a href="#cb1-867"></a><span class="ss">2.  </span>*EM 算法*: 采用最近两次迭代估计值的绝对值范数作为收敛停止准则.</span>
<span id="cb1-868"><a href="#cb1-868"></a><span class="ss">3.  </span>MCMC\index{MCMC} 算法: 使用与 VB 相同的超参数设定, 后验采样中包含 3 条马尔科夫链, 每条链迭代 20,000 次, 前半部分作为燃烧期.</span>
<span id="cb1-869"><a href="#cb1-869"></a><span class="ss">4.  </span>*通用设置*: VB 和 EM 算法的目标精度为 $10^{-6}$. 所有算法均通过 R 软件实现, 运行于 Windows 10 桌面电脑 (3.5 GHz Intel Xeon E3-1241 v3 处理器, 16 GB 内存) .</span>
<span id="cb1-870"><a href="#cb1-870"></a></span>
<span id="cb1-871"><a href="#cb1-871"></a>样本量 $N$ 选为15、30和60, 对于每个$N$, 测量次数 $M=$ 10和20. 对于每种 $(N, M)$ 组合, 从参数 $\boldsymbol{\Theta}=(\alpha, \mu, \sigma^2)=(10, -1, 0.01)$ 的RGa过程中随机生成2,000个退化样本 $\boldsymbol{y}$. 对每个样本 $\boldsymbol{y}$, 通过VB、EM和MCMC\index{MCMC}算法获得 $\boldsymbol{\Theta}$ 的估计值. 因此, 每种算法均得到2,000个估计值. 基于这些估计值, 计算平均值和MSE. 结果列在表 \ref{tbl-tab:ns1} 中. 同时还计算了每种算法的平均CPU运行时间(秒, $\bar{t}$), 结果如图 @fig-fig:tims 所示. 此外, 还计算了95%可信区间\index{可信区间}的覆盖率和区间长度 (Interval length, IL), 见表 \ref{tbl-tab:ns2}. 从这两个表格和三种算法的平均CPU运行时间图中, 可以得出以下结果: (1) 所有情况下, 估计值的平均值接近真实值, 且样本量增加时, 平均值与真实值的差异逐渐缩小. (2) 随着样本量增加, 各模拟设置下的 MSE 总体呈下降趋势. VB 和 EM 的 MSE 小于贝叶斯\index{贝叶斯}方法, 且样本量增加时, 三者差距逐渐减小. (3) 所有算法的IL随样本量增加而缩小, 同时 基于VB 与贝叶斯\index{贝叶斯}方法的 IL 差异也逐渐减小. (4) 在覆盖率方面, VB 略优于 EM, 表现出更接近 0.95 的名义水平, 而贝叶斯\index{贝叶斯}方法在小样本 (如 $N = 15, M = 10, 20$) 时表现最佳. (5) 在计算效率上, VB 显著优于 EM 和贝叶斯\index{贝叶斯}方法, 部分情况下运行时间仅为贝叶斯\index{贝叶斯}方法的百分之一或千分之一. 总体而言, 贝叶斯\index{贝叶斯}方法提供最高的估计精度, 但计算效率低; 三种算法的估计精度随样本量增加而提高; EM 提高了效率, 但牺牲了部分精度; VB 在精度与效率之间实现了良好平衡, 是贝叶斯\index{贝叶斯}与 EM 方法的折中方案.</span>
<span id="cb1-872"><a href="#cb1-872"></a></span>
<span id="cb1-873"><a href="#cb1-873"></a><span class="in">```{=latex}</span></span>
<span id="cb1-874"><a href="#cb1-874"></a><span class="in">\begin{table}</span></span>
<span id="cb1-875"><a href="#cb1-875"></a><span class="in">    \centering</span></span>
<span id="cb1-876"><a href="#cb1-876"></a><span class="in">    \caption{不同算法和样本量下, 估计值的平均值和均方误差. }</span></span>
<span id="cb1-877"><a href="#cb1-877"></a><span class="in">    \renewcommand{\arraystretch}{1.25}</span></span>
<span id="cb1-878"><a href="#cb1-878"></a><span class="in">    \vskip 0mm \setlength{\tabcolsep}{1.6mm}</span></span>
<span id="cb1-879"><a href="#cb1-879"></a><span class="in">    \scalebox{1}{</span></span>
<span id="cb1-880"><a href="#cb1-880"></a><span class="in">    \begin{tabular}{clcccccc}</span></span>
<span id="cb1-881"><a href="#cb1-881"></a><span class="in">        \toprule</span></span>
<span id="cb1-882"><a href="#cb1-882"></a><span class="in">        \multirow{2}[4]{*}{$(N,M)$} &amp; \multicolumn{1}{c}{\multirow{2}[4]{*}{方法}} &amp; \multicolumn{2}{c}{$\alpha=10$} &amp; \multicolumn{2}{c}{$\mu=-1$} &amp; \multicolumn{2}{c}{$\sigma^2=0.01$}\\</span></span>
<span id="cb1-883"><a href="#cb1-883"></a><span class="in">        \cmidrule(lr){3-4} \cmidrule(lr){5-6} \cmidrule(lr){7-8}    &amp;    &amp; MSE &amp; 均值 &amp; MSE ({\scriptsize $\times 10^{-3}$}) &amp; 均值 &amp; MSE({\scriptsize $\times 10^{-5}$}) &amp; 均值 \\</span></span>
<span id="cb1-884"><a href="#cb1-884"></a><span class="in">        \midrule</span></span>
<span id="cb1-885"><a href="#cb1-885"></a><span class="in">        \multirow{3}[2]{*}{(15,10)} &amp; VB &amp; 3.5689  &amp; 10.2939  &amp; 2.1490  &amp; -0.9921  &amp; 12.7358  &amp; 0.0118 \\</span></span>
<span id="cb1-886"><a href="#cb1-886"></a><span class="in">        &amp; EM &amp; 3.7443  &amp; 10.4057  &amp; 2.4983  &amp; -0.9990  &amp; 13.8214  &amp; 0.0118  \\</span></span>
<span id="cb1-887"><a href="#cb1-887"></a><span class="in">        &amp; Bayes &amp; 1.2705  &amp; 10.2116  &amp; 1.2181  &amp; -1.0007  &amp; 9.3512  &amp; 0.0179 \\</span></span>
<span id="cb1-888"><a href="#cb1-888"></a><span class="in">        \midrule</span></span>
<span id="cb1-889"><a href="#cb1-889"></a><span class="in">        \multirow{3}[2]{*}{(15,20)} &amp; VB &amp; 3.0234  &amp; 10.3048  &amp; 1.3635  &amp; -0.9973  &amp; 8.9276  &amp; 0.0118 \\</span></span>
<span id="cb1-890"><a href="#cb1-890"></a><span class="in">        &amp; EM &amp; 3.4744  &amp; 10.3870  &amp; 1.3836  &amp; -1.0011  &amp; 9.3441  &amp; 0.0114  \\</span></span>
<span id="cb1-891"><a href="#cb1-891"></a><span class="in">        &amp; Bayes &amp; 0.7495  &amp; 10.1547  &amp; 1.1617  &amp; -1.0011  &amp; 5.1783  &amp; 0.0116  \\</span></span>
<span id="cb1-892"><a href="#cb1-892"></a><span class="in">        \midrule</span></span>
<span id="cb1-893"><a href="#cb1-893"></a><span class="in">        \multirow{3}[2]{*}{(30,10)} &amp; VB &amp; 2.4774  &amp; 10.2291  &amp; 1.1519  &amp; -0.9990  &amp; 4.1917  &amp; 0.0097  \\</span></span>
<span id="cb1-894"><a href="#cb1-894"></a><span class="in">        &amp; EM &amp; 3.4369  &amp; 10.3056  &amp; 1.1763  &amp; -0.9986  &amp; 3.0103  &amp; 0.0108  \\</span></span>
<span id="cb1-895"><a href="#cb1-895"></a><span class="in">        &amp; Bayes &amp; 0.6956  &amp; 10.2142  &amp; 0.8215  &amp; -1.0083  &amp; 1.8619  &amp; 0.0103    \\</span></span>
<span id="cb1-896"><a href="#cb1-896"></a><span class="in">        \midrule</span></span>
<span id="cb1-897"><a href="#cb1-897"></a><span class="in">        \multirow{3}[2]{*}{(30,20)} &amp; VB &amp; 2.2640  &amp; 10.1209  &amp; 0.8165  &amp; -0.9974  &amp; 2.4172  &amp; 0.0097   \\</span></span>
<span id="cb1-898"><a href="#cb1-898"></a><span class="in">        &amp; EM &amp; 2.6755  &amp; 10.1871  &amp; 0.8234  &amp; -0.9988  &amp; 2.6170  &amp; 0.0104   \\</span></span>
<span id="cb1-899"><a href="#cb1-899"></a><span class="in">        &amp; Bayes &amp; 0.3813  &amp; 10.0223  &amp; 0.5394  &amp; -1.0001  &amp; 1.1418  &amp; 0.0102  \\</span></span>
<span id="cb1-900"><a href="#cb1-900"></a><span class="in">        \midrule</span></span>
<span id="cb1-901"><a href="#cb1-901"></a><span class="in">        \multirow{3}[2]{*}{(30,30)} &amp; VB &amp; 2.1271  &amp; 10.0525  &amp; 0.6582  &amp; -1.0154  &amp; 1.9043  &amp; 0.0104 \\</span></span>
<span id="cb1-902"><a href="#cb1-902"></a><span class="in">        &amp; EM &amp; 2.042  &amp; 10.0147  &amp; 0.4325  &amp; -1.0137  &amp; 1.2131  &amp; 0.0107 \\</span></span>
<span id="cb1-903"><a href="#cb1-903"></a><span class="in">        &amp; Bayes &amp; 0.2032  &amp; 10.0125  &amp; 0.3142  &amp; -1.0015  &amp; 0.9324  &amp; 0.0102   \\</span></span>
<span id="cb1-904"><a href="#cb1-904"></a><span class="in">        \midrule</span></span>
<span id="cb1-905"><a href="#cb1-905"></a><span class="in">        \multirow{3}[2]{*}{(60,20)} &amp; VB &amp; 2.0017  &amp; 10.093  &amp; 0.3627  &amp; -1.0097  &amp; 1.0121  &amp; 0.0098  \\</span></span>
<span id="cb1-906"><a href="#cb1-906"></a><span class="in">        &amp; EM &amp; 2.0014  &amp; 10.0104  &amp; 0.3674  &amp; -1.0117  &amp; 1.1374  &amp; 0.0103  \\</span></span>
<span id="cb1-907"><a href="#cb1-907"></a><span class="in">        &amp; Bayes &amp; 0.1747  &amp; 10.0041  &amp; 0.2873  &amp; -1.0009  &amp; 0.7213  &amp; 0.0101  \\</span></span>
<span id="cb1-908"><a href="#cb1-908"></a><span class="in">        \bottomrule</span></span>
<span id="cb1-909"><a href="#cb1-909"></a><span class="in">    \end{tabular}}%</span></span>
<span id="cb1-910"><a href="#cb1-910"></a><span class="in">    \label{tbl-tab:ns1}%</span></span>
<span id="cb1-911"><a href="#cb1-911"></a><span class="in">\end{table}</span></span>
<span id="cb1-912"><a href="#cb1-912"></a><span class="in">```</span></span>
<span id="cb1-915"><a href="#cb1-915"></a><span class="in">```{r}</span></span>
<span id="cb1-916"><a href="#cb1-916"></a><span class="co">#| label: fig-fig:tims</span></span>
<span id="cb1-917"><a href="#cb1-917"></a><span class="co">#| fig.align: 'center'</span></span>
<span id="cb1-918"><a href="#cb1-918"></a><span class="co">#| echo: FALSE</span></span>
<span id="cb1-919"><a href="#cb1-919"></a><span class="co">#| out.width: '70%'</span></span>
<span id="cb1-920"><a href="#cb1-920"></a><span class="co">#| fig.cap: '在不同算法和样本量下的平均CPU运行时间. '</span></span>
<span id="cb1-921"><a href="#cb1-921"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/Gamma/ITR2023/tims.pdf"</span>)</span>
<span id="cb1-922"><a href="#cb1-922"></a><span class="in">```</span></span>
<span id="cb1-923"><a href="#cb1-923"></a></span>
<span id="cb1-924"><a href="#cb1-924"></a><span class="in">```{=latex}</span></span>
<span id="cb1-925"><a href="#cb1-925"></a><span class="in">\begin{table}</span></span>
<span id="cb1-926"><a href="#cb1-926"></a><span class="in">    \centering</span></span>
<span id="cb1-927"><a href="#cb1-927"></a><span class="in">    \caption{在不同算法和样本量下, 区间估计的95\%覆盖概率和区间长度. }</span></span>
<span id="cb1-928"><a href="#cb1-928"></a><span class="in">    \renewcommand{\arraystretch}{1.25}</span></span>
<span id="cb1-929"><a href="#cb1-929"></a><span class="in">    \vskip 0mm \setlength{\tabcolsep}{3mm}</span></span>
<span id="cb1-930"><a href="#cb1-930"></a><span class="in">    \scalebox{1}{</span></span>
<span id="cb1-931"><a href="#cb1-931"></a><span class="in">    \begin{tabular}{clrrrrrr}</span></span>
<span id="cb1-932"><a href="#cb1-932"></a><span class="in">        \toprule</span></span>
<span id="cb1-933"><a href="#cb1-933"></a><span class="in">        \multirow{2}[4]{*}{(N,M)} &amp; \multicolumn{1}{c}{\multirow{2}[4]{*}{方法}} &amp; \multicolumn{2}{c}{$\alpha=10$} &amp; \multicolumn{2}{c}{$\mu=-1$} &amp; \multicolumn{2}{c}{$\sigma^2=0.01$} \\</span></span>
<span id="cb1-934"><a href="#cb1-934"></a><span class="in">        \cmidrule(lr){3-4} \cmidrule(lr){5-6} \cmidrule(lr){7-8} &amp;</span></span>
<span id="cb1-935"><a href="#cb1-935"></a><span class="in">        &amp; \multicolumn{1}{c}{CP} &amp; \multicolumn{1}{c}{IL} &amp; \multicolumn{1}{c}{CP} &amp; \multicolumn{1}{c}{IL} &amp; \multicolumn{1}{c}{CP} &amp; \multicolumn{1}{c}{IL} \\</span></span>
<span id="cb1-936"><a href="#cb1-936"></a><span class="in">        \midrule</span></span>
<span id="cb1-937"><a href="#cb1-937"></a><span class="in">        \multirow{3}[2]{*}{(15,10)} &amp; VB &amp; 0.9123  &amp; 3.9051  &amp; 0.9234  &amp; 0.7675  &amp; 0.9014  &amp; 0.7234  \\</span></span>
<span id="cb1-938"><a href="#cb1-938"></a><span class="in">        &amp; EM &amp; 0.9136  &amp; 4.5865  &amp; 0.9216  &amp; 0.7921  &amp; 0.8945  &amp; 0.8653  \\</span></span>
<span id="cb1-939"><a href="#cb1-939"></a><span class="in">        &amp; Bayes &amp; 0.9208  &amp; 3.8839  &amp; 0.9307  &amp; 0.1688  &amp; 0.9134  &amp; 0.5053  \\</span></span>
<span id="cb1-940"><a href="#cb1-940"></a><span class="in">        \midrule</span></span>
<span id="cb1-941"><a href="#cb1-941"></a><span class="in">        \multirow{3}[2]{*}{(15,20)} &amp; VB &amp; 0.9293  &amp; 2.7575  &amp; 0.9356  &amp; 0.6060  &amp; 0.9345  &amp; 0.4209  \\</span></span>
<span id="cb1-942"><a href="#cb1-942"></a><span class="in">        &amp; EM &amp; 0.9294  &amp; 3.2482  &amp; 0.9341  &amp; 0.7459  &amp; 0.9301  &amp; 0.5678  \\</span></span>
<span id="cb1-943"><a href="#cb1-943"></a><span class="in">        &amp; Bayes &amp; 0.9406  &amp; 2.7325  &amp; 0.9406  &amp; 0.1471  &amp; 0.9406  &amp; 0.3847  \\</span></span>
<span id="cb1-944"><a href="#cb1-944"></a><span class="in">        \midrule</span></span>
<span id="cb1-945"><a href="#cb1-945"></a><span class="in">        \multirow{3}[2]{*}{(30,10)} &amp; VB &amp; 0.9323  &amp; 3.8864  &amp; 0.9245  &amp; 0.5655  &amp; 0.9471  &amp; 0.4515  \\</span></span>
<span id="cb1-946"><a href="#cb1-946"></a><span class="in">        &amp; EM &amp; 0.9289  &amp; 3.9691  &amp; 0.9223  &amp; 0.7319  &amp; 0.9412  &amp; 0.5317  \\</span></span>
<span id="cb1-947"><a href="#cb1-947"></a><span class="in">        &amp; Bayes &amp; 0.9501  &amp; 3.3626  &amp; 0.9307  &amp; 0.1092  &amp; 0.9505  &amp; 0.2628  \\</span></span>
<span id="cb1-948"><a href="#cb1-948"></a><span class="in">        \midrule</span></span>
<span id="cb1-949"><a href="#cb1-949"></a><span class="in">        \multirow{3}[2]{*}{(30,20)} &amp; VB &amp; 0.9457  &amp; 2.7569  &amp; 0.9451  &amp; 0.4971  &amp; 0.9487  &amp; 0.3124  \\</span></span>
<span id="cb1-950"><a href="#cb1-950"></a><span class="in">        &amp; EM &amp; 0.9470  &amp; 2.7751  &amp; 0.9412  &amp; 0.5777  &amp; 0.9465  &amp; 0.4018  \\</span></span>
<span id="cb1-951"><a href="#cb1-951"></a><span class="in">        &amp; Bayes &amp; 0.9503  &amp; 2.2675  &amp; 0.9504  &amp; 0.0947  &amp; 0.9507  &amp; 0.1987  \\</span></span>
<span id="cb1-952"><a href="#cb1-952"></a><span class="in">        \midrule</span></span>
<span id="cb1-953"><a href="#cb1-953"></a><span class="in">        \multirow{3}[2]{*}{(60,10)} &amp; VB &amp; 0.9473  &amp; 2.6321  &amp; 0.9462  &amp; 0.4737  &amp; 0.9503 &amp; 0.2132  \\</span></span>
<span id="cb1-954"><a href="#cb1-954"></a><span class="in">        &amp; EM &amp; 0.9469  &amp; 2.7747  &amp; 0.9451  &amp; 0.5153  &amp; 0.9495  &amp; 0.3314  \\</span></span>
<span id="cb1-955"><a href="#cb1-955"></a><span class="in">        &amp; Bayes &amp; 0.9505  &amp; 1.8278  &amp; 0.9507  &amp; 0.0879  &amp; 0.9510  &amp; 0.1637  \\</span></span>
<span id="cb1-956"><a href="#cb1-956"></a><span class="in">        \midrule</span></span>
<span id="cb1-957"><a href="#cb1-957"></a><span class="in">        \multirow{3}[2]{*}{(60,20)} &amp; VB &amp; 0.9489  &amp; 2.4143  &amp; 0.9475  &amp; 0.4687  &amp; 0.9504 &amp; 0.2047  \\</span></span>
<span id="cb1-958"><a href="#cb1-958"></a><span class="in">        &amp; EM &amp; 0.9475  &amp; 2.6032  &amp; 0.9457  &amp; 0.5096  &amp; 0.9502  &amp; 0.3176  \\</span></span>
<span id="cb1-959"><a href="#cb1-959"></a><span class="in">        &amp; Bayes &amp; 0.9509  &amp; 1.8021  &amp; 0.9511  &amp; 0.0813  &amp; 0.9513  &amp; 0.1521  \\</span></span>
<span id="cb1-960"><a href="#cb1-960"></a><span class="in">        \bottomrule</span></span>
<span id="cb1-961"><a href="#cb1-961"></a><span class="in">    \end{tabular}}%</span></span>
<span id="cb1-962"><a href="#cb1-962"></a><span class="in">    \label{tbl-tab:ns2}%</span></span>
<span id="cb1-963"><a href="#cb1-963"></a><span class="in">\end{table}%</span></span>
<span id="cb1-964"><a href="#cb1-964"></a><span class="in">```</span></span>
<span id="cb1-965"><a href="#cb1-965"></a><span class="fu">### 实例分析 {#sec-ITR2023-s5}</span></span>
<span id="cb1-966"><a href="#cb1-966"></a></span>
<span id="cb1-967"><a href="#cb1-967"></a><span class="fu">#### 激光退化数据 {#sec-ITR2023-s5-1}</span></span>
<span id="cb1-968"><a href="#cb1-968"></a></span>
<span id="cb1-969"><a href="#cb1-969"></a><span class="co">&lt;!-- 砷化镓(GaAs) 激光数据 [@Meeker1998] 被用来说明所提出的RGa退化模型, 并验证所开发的VB算法. 激光器的工作电流被用作退化特征, 其在激光器的寿命过程中呈现出上升趋势, 以维持恒定的光输出. 当激光器的工作电流超过某一临界水平时, 认为激光器发生了伪故障\index{故障}. 图 @fig-fig:laser1 显示了15个GaAs激光器样本的退化路径, 测量频率为每250小时一次, 直至在 $80^{\circ}$C 条件下达到4000小时.  --&gt;</span></span>
<span id="cb1-970"><a href="#cb1-970"></a></span>
<span id="cb1-971"><a href="#cb1-971"></a>以激光退化数据为例 (见图 @fig-fig:laser2 ) 进行分析. 拟合前需验证两个目标: 一是检查退化率的单元间变异性是否符合对数正态分布\index{正态分布}, 二是研究激光数据中 RGa 过程的形状参数与尺度参数的相关性. 为验证第一个目标, 计算经验估计量 $\hat{\boldsymbol{\eta}} = <span class="sc">\{</span>{\hat{\eta}_n = y_{nM} / t_{nM}}\}_{n=1}^{15}$, 并利用式 \eqref{lognorpdfx} 估计对数正态分布\index{正态分布}的参数, 得到 $\hat{\boldsymbol{\eta}} \sim LN(-0.697, 0.045)$. 图 @fig-cs1-1 展示了带 95% CI 的经验分布函数 和估计的对数正态分布\index{正态分布}, 表明退化率 $\hat{\boldsymbol{\eta}}$ 符合对数正态分布\index{正态分布}的特征. 此外, 通过Anderson-Darling 检验得到的P值为0.633, 进一步说明使用对数正态分布\index{正态分布}的合理性. 在研究RGa过程形状参数与尺度参数的相关性时, 定义经验估计量为 $$</span>
<span id="cb1-972"><a href="#cb1-972"></a>\hat{\boldsymbol{\alpha}},\hat{\boldsymbol{\beta}}=\left<span class="sc">\{</span>\hat{\alpha}_{n}=\frac{\hat{\eta}_{n}^2}{v(\boldsymbol{x}_{n}/\sqrt{h_{c}})}, \hat{\beta}_{n}=\frac{\hat{\eta}_{n}}{\hat{\alpha}_{n}} \right\}_{n=1}^{15}.</span>
<span id="cb1-973"><a href="#cb1-973"></a>$$ 图 @fig-cs1-2 展示了 $\hat{\boldsymbol{\alpha}}^{-1}$ 和 $\hat{\boldsymbol{\beta}}$ 的散点分布情况以及 回归曲线, 相关系数\index{相关系数} $\rho=0.958$ 表明两者之间存在显著正相关性.</span>
<span id="cb1-974"><a href="#cb1-974"></a></span>
<span id="cb1-975"><a href="#cb1-975"></a>::: {#fig-fig:cs1 layout-ncol="2"}</span>
<span id="cb1-976"><a href="#cb1-976"></a><span class="al">![估计CDF](figures/Gamma/ITR2023/cs1.pdf)</span>{#fig-cs1-1}</span>
<span id="cb1-977"><a href="#cb1-977"></a></span>
<span id="cb1-978"><a href="#cb1-978"></a><span class="al">![形状参数与尺度参数的关系](figures/Gamma/ITR2023/cs2.pdf)</span>{#fig-cs1-2}</span>
<span id="cb1-979"><a href="#cb1-979"></a></span>
<span id="cb1-980"><a href="#cb1-980"></a>模型验证相关结果.</span>
<span id="cb1-981"><a href="#cb1-981"></a>:::</span>
<span id="cb1-982"><a href="#cb1-982"></a></span>
<span id="cb1-983"><a href="#cb1-983"></a>接下来, 采用 VB 算法对 RGa 退化模型进行拟合, 并将其应用于激光数据集, 同时并与 EM 和贝叶斯\index{贝叶斯}方法进行比较, 以衡量计算效率和拟合精度. 表 \ref{tbl-tab:addlabel} 展示了各算法的参数估计值、95% 区间估计以及运行时间. 结果显示, 不同算法的参数估计值相近, 但 VB 算法在 CPU 运行时间上显著优于 EM 算法, 且远低于贝叶斯\index{贝叶斯}算法. 图 @fig-fig:pdf 显示了样本平均值、估计的平均退化路径 ($\hat{\eta} t$) 以及各算法的 95% 区间估计, 表明所有算法均能有效地拟合样本平均值.</span>
<span id="cb1-984"><a href="#cb1-984"></a></span>
<span id="cb1-985"><a href="#cb1-985"></a>本文提出的模型还与五个基准模型进行了比较,包括伽马过程\index{伽马过程}、逆高斯过程\index{逆高斯过程}、维纳过程\index{维纳过程}、具有随机效应\index{随机效应}的同质伽马过程和 @tsai2012optimal 所提的RGa过程. 为简化表述, 将本文提出的随机效应\index{随机效应}伽马过程模型记为 RGaLn, @tsai2012optimal 的模型记为 GaGa. 鉴于 EM 和 VB 算法在估计结果上无显著差异, 模型选择基于 EM 算法的结果. 同时 VB 算法作为一种确定性近似方法, 不适用于计算涉及有效样本数量的 BIC, 因此使用 AIC\index{AIC} 准则进行评估. 表 \ref{tbl-tab:addlabe2} 列出了各模型的 AIC\index{AIC} 值, 显示随机效应\index{随机效应}模型 (GaGa 和 RGaLn) 的 AIC\index{AIC} 值低于其他模型, 表明在激光退化数据中考虑随机效应\index{随机效应}是合理的. 然而, RGaLn 和 GaGa 的 AIC\index{AIC} 值差异不显著. 图 @fig-fig:cdfkm 展示了经验 分布函数, 以及阈值 $\omega=6$ 下 基于GaGa 和 RGaLn 模型的产品寿命\index{寿命}分布. 经验分布函数通过中位数秩估计对伪失效时间\index{失效时间}进行非参数估计<span class="co">[</span><span class="ot">@Meeker1998</span><span class="co">]</span>. 可以看出, GaGa 和 RGaLn 模型均能很好地拟合经验分布函数.</span>
<span id="cb1-986"><a href="#cb1-986"></a></span>
<span id="cb1-987"><a href="#cb1-987"></a><span class="in">```{=latex}</span></span>
<span id="cb1-988"><a href="#cb1-988"></a><span class="in">\begin{table}</span></span>
<span id="cb1-989"><a href="#cb1-989"></a><span class="in">    \centering</span></span>
<span id="cb1-990"><a href="#cb1-990"></a><span class="in">    \caption{激光数据在不同方法下的参数估计值、95\% 置信区间及计算时间. }</span></span>
<span id="cb1-991"><a href="#cb1-991"></a><span class="in">    \renewcommand{\arraystretch}{1.25}</span></span>
<span id="cb1-992"><a href="#cb1-992"></a><span class="in">    \vskip 0mm \setlength{\tabcolsep}{1.5mm}</span></span>
<span id="cb1-993"><a href="#cb1-993"></a><span class="in">    \scalebox{1}{</span></span>
<span id="cb1-994"><a href="#cb1-994"></a><span class="in">    \begin{tabular}{cccccccc}</span></span>
<span id="cb1-995"><a href="#cb1-995"></a><span class="in">        \toprule</span></span>
<span id="cb1-996"><a href="#cb1-996"></a><span class="in">        \multicolumn{1}{c}{\multirow{2}[4]{*}{方法}} &amp; \multicolumn{2}{c}{$\alpha$} &amp; \multicolumn{2}{c}{$\mu$} &amp; \multicolumn{2}{c}{$\sigma^2$} &amp; \multirow{2}[4]{*}{耗时} \\</span></span>
<span id="cb1-997"><a href="#cb1-997"></a><span class="in">        \cmidrule(lr){2-3} \cmidrule(lr){4-5} \cmidrule(lr){6-7}        &amp; 估计值 &amp; 95\% CIs &amp; 估计值 &amp; 95\%CIs &amp; 估计值 &amp; 95\%CIs&amp;  \\</span></span>
<span id="cb1-998"><a href="#cb1-998"></a><span class="in">        \midrule</span></span>
<span id="cb1-999"><a href="#cb1-999"></a><span class="in">        VB &amp; 9.682  &amp; (8.161,11.792)  &amp; -0.696  &amp;  (-0.854, -0.549)  &amp; 0.059  &amp; (0.019, 0.141)  &amp; 0.1842  \\</span></span>
<span id="cb1-1000"><a href="#cb1-1000"></a><span class="in">        EM &amp; 9.713  &amp; (8.159,11.802)  &amp; -0.696  &amp; (-0.856, -0.550)  &amp; 0.058  &amp; (0.019, 0.143)  &amp; 0.7451  \\</span></span>
<span id="cb1-1001"><a href="#cb1-1001"></a><span class="in">        Bayes &amp; 9.699  &amp; (8.478,11.702)  &amp; -0.694  &amp; (-0.820, -0.561)  &amp; 0.057  &amp; (0.021, 0.138) &amp; 12.381  \\</span></span>
<span id="cb1-1002"><a href="#cb1-1002"></a><span class="in">        \bottomrule</span></span>
<span id="cb1-1003"><a href="#cb1-1003"></a><span class="in">    \end{tabular}}%</span></span>
<span id="cb1-1004"><a href="#cb1-1004"></a><span class="in">    \label{tbl-tab:addlabel}%</span></span>
<span id="cb1-1005"><a href="#cb1-1005"></a><span class="in">\end{table}%</span></span>
<span id="cb1-1006"><a href="#cb1-1006"></a><span class="in">```</span></span>
<span id="cb1-1007"><a href="#cb1-1007"></a><span class="in">```{=latex}</span></span>
<span id="cb1-1008"><a href="#cb1-1008"></a><span class="in">\begin{table}</span></span>
<span id="cb1-1009"><a href="#cb1-1009"></a><span class="in">    \centering</span></span>
<span id="cb1-1010"><a href="#cb1-1010"></a><span class="in">    \caption{激光退化数据基于不同模型的对数似然值和AIC值. }</span></span>
<span id="cb1-1011"><a href="#cb1-1011"></a><span class="in">    \renewcommand{\arraystretch}{1.25}</span></span>
<span id="cb1-1012"><a href="#cb1-1012"></a><span class="in">    \vskip 0mm \setlength{\tabcolsep}{8mm}</span></span>
<span id="cb1-1013"><a href="#cb1-1013"></a><span class="in">    \begin{tabular}{ccc}</span></span>
<span id="cb1-1014"><a href="#cb1-1014"></a><span class="in">        \toprule</span></span>
<span id="cb1-1015"><a href="#cb1-1015"></a><span class="in">        模型 &amp; 对数似然值 &amp; AIC值 \\</span></span>
<span id="cb1-1016"><a href="#cb1-1016"></a><span class="in">        \midrule</span></span>
<span id="cb1-1017"><a href="#cb1-1017"></a><span class="in">        RGaLn &amp; 93.291 &amp; -180.581 \\</span></span>
<span id="cb1-1018"><a href="#cb1-1018"></a><span class="in">        GaGa &amp; 93.738 &amp; -181.476\\</span></span>
<span id="cb1-1019"><a href="#cb1-1019"></a><span class="in">        \midrule</span></span>
<span id="cb1-1020"><a href="#cb1-1020"></a><span class="in">        RGa &amp; 69.609 &amp; -135.219\\</span></span>
<span id="cb1-1021"><a href="#cb1-1021"></a><span class="in">        伽玛 &amp; 69.609 &amp; -135.219\\</span></span>
<span id="cb1-1022"><a href="#cb1-1022"></a><span class="in">        逆高斯 &amp; 73.031 &amp; -148.062 \\</span></span>
<span id="cb1-1023"><a href="#cb1-1023"></a><span class="in">        维纳 &amp; 45.563 &amp; -87.126 \\</span></span>
<span id="cb1-1024"><a href="#cb1-1024"></a><span class="in">        \bottomrule</span></span>
<span id="cb1-1025"><a href="#cb1-1025"></a><span class="in">    \end{tabular}%</span></span>
<span id="cb1-1026"><a href="#cb1-1026"></a><span class="in">    \label{tbl-tab:addlabe2}%</span></span>
<span id="cb1-1027"><a href="#cb1-1027"></a><span class="in">\end{table}%</span></span>
<span id="cb1-1028"><a href="#cb1-1028"></a><span class="in">```</span></span>
<span id="cb1-1029"><a href="#cb1-1029"></a>::: {#fig-fig:gamma-ft-com layout-ncol="2"}</span>
<span id="cb1-1030"><a href="#cb1-1030"></a><span class="al">![平均退化路径估计](figures/Gamma/ITR2023/path.pdf)</span>{#fig-fig:pdf}</span>
<span id="cb1-1031"><a href="#cb1-1031"></a></span>
<span id="cb1-1032"><a href="#cb1-1032"></a><span class="al">![寿命估计CDF](figures/Gamma/ITR2023/cdfkm.pdf)</span>{#fig-fig:cdfkm}</span>
<span id="cb1-1033"><a href="#cb1-1033"></a></span>
<span id="cb1-1034"><a href="#cb1-1034"></a>激光数据下寿命分布相关结果.</span>
<span id="cb1-1035"><a href="#cb1-1035"></a>:::</span>
<span id="cb1-1036"><a href="#cb1-1036"></a></span>
<span id="cb1-1037"><a href="#cb1-1037"></a><span class="fu">#### 设备-B数据 {#sec-ITR2023-s5-2}</span></span>
<span id="cb1-1038"><a href="#cb1-1038"></a></span>
<span id="cb1-1039"><a href="#cb1-1039"></a>这里以 7 个设备-B 的退化数据为例 (见图 @fig-fig:deviceB 中$150^{\circ}$C条件下的7个设备-B样本) 进行分析. 图 @fig-devicebcs1-1 显示了退化率 $\boldsymbol{\hat{\eta}}$ 的经验分布函数 及其 95% 置信区间\index{置信区间}, 以及拟合的对数正态分布\index{正态分布}. 结果表明, 对数正态分布\index{正态分布}能够很好地拟合退化率分布. 同时Anderson-Darling 检验的 $P$ 值为 0.883, 进一步验证用对数正态分布\index{正态分布}刻画样品间变异性的合理性. 图 @fig-devicebcs1-2 显示了形状参数与尺度参数倒数的回归线及其相关系数\index{相关系数} $\rho$, 结果表明两者之间存在显著的正相关关系.</span>
<span id="cb1-1040"><a href="#cb1-1040"></a></span>
<span id="cb1-1041"><a href="#cb1-1041"></a>随后采用 VB、EM 和贝叶斯\index{贝叶斯}方法对设备-B 数据进行拟合, 并使用所提 RGa 退化模型进行分析. 拟合结果汇总于表 \ref{tbl-tab:addlabe3}. 从表中可以看出, VB 方法在计算效率上显著优于其他方法, 同时在精度方面表现良好. 图 @fig-fig:devicebpdf 展示了样本平均值及每种算法的估计平均退化路径 ($\hat{\eta} t$) . 可以看出, 各算法的估计平均退化路径均能很好地拟合样本平均值.</span>
<span id="cb1-1042"><a href="#cb1-1042"></a></span>
<span id="cb1-1043"><a href="#cb1-1043"></a>::: {#fig-fig:devicebcs1 layout-ncol="2"}</span>
<span id="cb1-1044"><a href="#cb1-1044"></a><span class="al">![估计CDF](figures/Gamma/ITR2023/devicebcs1.pdf)</span>{#fig-devicebcs1-1}</span>
<span id="cb1-1045"><a href="#cb1-1045"></a></span>
<span id="cb1-1046"><a href="#cb1-1046"></a><span class="al">![形状参数与尺度参数的关系](figures/Gamma/ITR2023/devicebcs2.pdf)</span>{#fig-devicebcs1-2}</span>
<span id="cb1-1047"><a href="#cb1-1047"></a></span>
<span id="cb1-1048"><a href="#cb1-1048"></a>模型验证相关结果.</span>
<span id="cb1-1049"><a href="#cb1-1049"></a>:::</span>
<span id="cb1-1050"><a href="#cb1-1050"></a></span>
<span id="cb1-1051"><a href="#cb1-1051"></a>接下来, 将设备-B数据分别用五种基准模型拟合, 其对数似然值和 AIC\index{AIC} 值列于表 \ref{tbl-tab:addlabel4}. 结果显示, 提出的 RGaLn 模型在所有候选模型中具有最小的AIC\index{AIC}值, 可认为是最优模型. 图 @fig-fig:devicebcdfkm 中展示了经验分布函数以及退化阈值\index{退化阈值} $\omega = 0.3$ 下基于 GaGa 和 RGaLn 模型估计的寿命\index{寿命}分布. 结果表明, RGaLn 模型的拟合效果显著优于 GaGa 模型.</span>
<span id="cb1-1052"><a href="#cb1-1052"></a></span>
<span id="cb1-1053"><a href="#cb1-1053"></a>::: {#fig-fig:devicebcdf_com layout-ncol="2"}</span>
<span id="cb1-1054"><a href="#cb1-1054"></a><span class="al">![平均退化路径估计](figures/Gamma/ITR2023/devicebpath.pdf)</span>{#fig-fig:devicebpdf}</span>
<span id="cb1-1055"><a href="#cb1-1055"></a></span>
<span id="cb1-1056"><a href="#cb1-1056"></a><span class="al">![寿命估计CDF](figures/Gamma/ITR2023/devicebkm.pdf)</span>{#fig-fig:devicebcdfkm}</span>
<span id="cb1-1057"><a href="#cb1-1057"></a></span>
<span id="cb1-1058"><a href="#cb1-1058"></a>设备-B数据下寿命分布相关结果.</span>
<span id="cb1-1059"><a href="#cb1-1059"></a>:::</span>
<span id="cb1-1060"><a href="#cb1-1060"></a></span>
<span id="cb1-1061"><a href="#cb1-1061"></a><span class="in">```{=latex}</span></span>
<span id="cb1-1062"><a href="#cb1-1062"></a><span class="in">\begin{table}</span></span>
<span id="cb1-1063"><a href="#cb1-1063"></a><span class="in">    \centering</span></span>
<span id="cb1-1064"><a href="#cb1-1064"></a><span class="in">    \caption{设备-B数据下, 不同方法的模型参数估计值、95\% 置信区间和计算时间. }</span></span>
<span id="cb1-1065"><a href="#cb1-1065"></a><span class="in">    \renewcommand{\arraystretch}{1.25}</span></span>
<span id="cb1-1066"><a href="#cb1-1066"></a><span class="in">    \vskip 0mm \setlength{\tabcolsep}{1.5mm}</span></span>
<span id="cb1-1067"><a href="#cb1-1067"></a><span class="in">    \scalebox{1}{</span></span>
<span id="cb1-1068"><a href="#cb1-1068"></a><span class="in">    \begin{tabular}{cccccccc}</span></span>
<span id="cb1-1069"><a href="#cb1-1069"></a><span class="in">        \toprule</span></span>
<span id="cb1-1070"><a href="#cb1-1070"></a><span class="in">        \multicolumn{1}{c}{\multirow{2}[4]{*}{方法}} &amp; \multicolumn{2}{c}{$\alpha$} &amp; \multicolumn{2}{c}{$\mu$} &amp; \multicolumn{2}{c}{$\sigma^2$} &amp; \multirow{2}[4]{*}{耗时} \\</span></span>
<span id="cb1-1071"><a href="#cb1-1071"></a><span class="in">        \cmidrule(lr){2-3} \cmidrule(lr){4-5} \cmidrule(lr){6-7}        &amp; 估计值 &amp; 95\% CI &amp; 估计值 &amp; 95\%CI &amp; 估计值 &amp; 95\%CI&amp;  \\</span></span>
<span id="cb1-1072"><a href="#cb1-1072"></a><span class="in">        \midrule</span></span>
<span id="cb1-1073"><a href="#cb1-1073"></a><span class="in">        VB &amp; 7.681  &amp; (6.381, 9.171)   &amp; -4.384  &amp;  (-4.653, -4.119)   &amp;  0.112   &amp; (0.021, 0.195)  &amp; 0.643  \\</span></span>
<span id="cb1-1074"><a href="#cb1-1074"></a><span class="in">        EM &amp; 7.679  &amp; (6.380, 9.162)   &amp; -4.384  &amp; (-4.653, -4.117)  &amp;  0.110 &amp; (0.023, 0.97)  &amp; 1.423  \\</span></span>
<span id="cb1-1075"><a href="#cb1-1075"></a><span class="in">        Bayes &amp; 7.689  &amp; (6.376, 9.207)  &amp; -4.385  &amp; (-4.655, -4.120)  &amp; 0.116  &amp; (0.019, 0.201) &amp; 20.506  \\</span></span>
<span id="cb1-1076"><a href="#cb1-1076"></a><span class="in">        \bottomrule</span></span>
<span id="cb1-1077"><a href="#cb1-1077"></a><span class="in">    \end{tabular}}%</span></span>
<span id="cb1-1078"><a href="#cb1-1078"></a><span class="in">    \label{tbl-tab:addlabe3}%</span></span>
<span id="cb1-1079"><a href="#cb1-1079"></a><span class="in">\end{table}%</span></span>
<span id="cb1-1080"><a href="#cb1-1080"></a><span class="in">```</span></span>
<span id="cb1-1081"><a href="#cb1-1081"></a><span class="in">```{=latex}</span></span>
<span id="cb1-1082"><a href="#cb1-1082"></a><span class="in">\begin{table}</span></span>
<span id="cb1-1083"><a href="#cb1-1083"></a><span class="in">    \centering</span></span>
<span id="cb1-1084"><a href="#cb1-1084"></a><span class="in">    \caption{设备-B数据基于不同模型的对数似然值和AIC值. }</span></span>
<span id="cb1-1085"><a href="#cb1-1085"></a><span class="in">    \renewcommand{\arraystretch}{1.25}</span></span>
<span id="cb1-1086"><a href="#cb1-1086"></a><span class="in">    \vskip 0mm \setlength{\tabcolsep}{8mm}</span></span>
<span id="cb1-1087"><a href="#cb1-1087"></a><span class="in">    \begin{tabular}{ccc}</span></span>
<span id="cb1-1088"><a href="#cb1-1088"></a><span class="in">        \toprule</span></span>
<span id="cb1-1089"><a href="#cb1-1089"></a><span class="in">        模型 &amp; 对数似然值 &amp; AIC值 \\</span></span>
<span id="cb1-1090"><a href="#cb1-1090"></a><span class="in">        \midrule</span></span>
<span id="cb1-1091"><a href="#cb1-1091"></a><span class="in">        RGaLn &amp; 893.009 &amp; -1780.018 \\</span></span>
<span id="cb1-1092"><a href="#cb1-1092"></a><span class="in">        GaGa &amp; 888.156 &amp; -1770.312\\</span></span>
<span id="cb1-1093"><a href="#cb1-1093"></a><span class="in">        \midrule</span></span>
<span id="cb1-1094"><a href="#cb1-1094"></a><span class="in">        RGa &amp; 876.595 &amp; -1749.190\\</span></span>
<span id="cb1-1095"><a href="#cb1-1095"></a><span class="in">        伽马 &amp; 876.595 &amp; -1749.190\\</span></span>
<span id="cb1-1096"><a href="#cb1-1096"></a><span class="in">        逆高斯 &amp; 851.529 &amp;  -1699.058 \\</span></span>
<span id="cb1-1097"><a href="#cb1-1097"></a><span class="in">        维纳 &amp; 881.747 &amp; -1759.494 \\</span></span>
<span id="cb1-1098"><a href="#cb1-1098"></a><span class="in">        \bottomrule</span></span>
<span id="cb1-1099"><a href="#cb1-1099"></a><span class="in">    \end{tabular}%</span></span>
<span id="cb1-1100"><a href="#cb1-1100"></a><span class="in">    \label{tbl-tab:addlabel4}%</span></span>
<span id="cb1-1101"><a href="#cb1-1101"></a><span class="in">\end{table}%</span></span>
<span id="cb1-1102"><a href="#cb1-1102"></a><span class="in">```</span></span>
<span id="cb1-1103"><a href="#cb1-1103"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> 总结 {#sec-ITR2023-s6} --&gt;</span></span>
<span id="cb1-1104"><a href="#cb1-1104"></a></span>
<span id="cb1-1105"><a href="#cb1-1105"></a><span class="co">&lt;!-- 本文提出了一种重参数化的伽马退化模型, 该模型对参数具有清晰的物理解释, 并且保持了与传统伽马退化模型相同的退化均值和方差之间的依赖性, 且可以直接将随机效应引入退化率中. 但更重要的是, 随机效应部分中的形状参数和阻断参数被分离开, 这使得VB推断变得可行. 在VB算法的开发中, 利用GH求积来进行数值积分, 并采用拉普拉斯近似为形状参数难以处理的VPD提供闭式变分均值和方差. 考虑到VB方法区间估计的不足, 基于观测Fisher信息矩阵开发了一种调整后的区间估计. 数值实验展示了VB算法的计算效率和估计精度. 通过对激光退化数据和设备-B数据的分析, 结果表明所提出的伽马退化模型可以提供令人满意的拟合效果.  --&gt;</span></span>
<span id="cb1-1106"><a href="#cb1-1106"></a></span>
<span id="cb1-1107"><a href="#cb1-1107"></a><span class="co">&lt;!-- 尽管VB算法已经在多个领域得到了广泛应用, 但在实际应用中仍面临许多挑战和局限性. 对于模型参数中的非共轭部分, 我们难以在平均场VB推断下获得参数的解析解. 此外, 当模型参数具有高维性或潜在变量之间的高度相关性时, 基于平均场VB方法难以获得令人满意的估计精度. 例如, 对于带有随机效应的传统伽马过程退化模型 [@tsai2012optimal], 随机效应部分的参数无法获得解析的VB解. 尽管Stan [@carpenter2017stan] 将VB算法整合到了工程应用中, 但它直接用多元正态分布\index{正态分布}来近似目标模型参数. 当模型参数具有偏态分布时, 参数估计会存在较大的偏差. 为了解决VB算法在应用中的这些局限性, 我们提出了一种替代的VB推断策略. 在平均场变分推断中, 我们假设模型参数是阻断独立的, 尽可能保留参数之间的相关性. 然后, 我们对模型参数的共轭部分进行VB推断, 这不仅可以获得共轭部分的参数解析解, 还能降低模型参数的维度. 最后, 我们基于其他近似贝叶斯\index{贝叶斯}方法对非共轭部分进行近似推断.  --&gt;</span></span>
<span id="cb1-1108"><a href="#cb1-1108"></a></span>
<span id="cb1-1109"><a href="#cb1-1109"></a><span class="co">&lt;!-- 未来的研究中, 我们可能关注以下三个方面. 首先是考虑带有协变量的加速退化模型及其对应的VB算法. 其次, 针对具有测量误差\index{测量误差}的RGa模型进行快速贝叶斯\index{贝叶斯}推断是一个值得深入研究的挑战. 最后也是最重要的, 非线性退化路径在实际中很常见, 探索非齐次RGa模型的快速贝叶斯\index{贝叶斯}推断将是一个重要的研究方向.  --&gt;</span></span>
<span id="cb1-1110"><a href="#cb1-1110"></a></span>
<span id="cb1-1111"><a href="#cb1-1111"></a>\newpage</span>
<span id="cb1-1112"><a href="#cb1-1112"></a></span>
<span id="cb1-1113"><a href="#cb1-1113"></a><span class="fu">### 附录 {#sec-Append-3B}</span></span>
<span id="cb1-1114"><a href="#cb1-1114"></a></span>
<span id="cb1-1115"><a href="#cb1-1115"></a><span class="co">&lt;!-- {.unnumbered} --&gt;</span></span>
<span id="cb1-1116"><a href="#cb1-1116"></a></span>
<span id="cb1-1117"><a href="#cb1-1117"></a><span class="fu">#### 定理 @thm-ITR2023-th1 证明 {.unnumbered}</span></span>
<span id="cb1-1118"><a href="#cb1-1118"></a></span>
<span id="cb1-1119"><a href="#cb1-1119"></a>根据式\eqref{gammpdfx}和\eqref{lognorpdfx}, $Y(t)$ 和 $\eta$ 的联合PDF可表示为 \begin{equation} </span>
<span id="cb1-1120"><a href="#cb1-1120"></a>\begin{aligned}     </span>
<span id="cb1-1121"><a href="#cb1-1121"></a>p_{Y(t),\eta}(y_{t},\eta \mid \boldsymbol{\Theta}) = p_{Y(t)}(y_{t} \mid \eta,\alpha)p(\eta \mid \mu,\sigma^2), </span>
<span id="cb1-1122"><a href="#cb1-1122"></a>\end{aligned} </span>
<span id="cb1-1123"><a href="#cb1-1123"></a>\label{gamlnorpdfx} </span>
<span id="cb1-1124"><a href="#cb1-1124"></a>\end{equation} 其中$\boldsymbol{\Theta} = (\alpha, \mu, \sigma^2)$. 接下来, 对式 \eqref{gamlnorpdfx}关于$\eta$求积分, 可得到 $Y(t)$ 的边际PDF:\</span>
<span id="cb1-1125"><a href="#cb1-1125"></a>\begin{equation*} </span>
<span id="cb1-1126"><a href="#cb1-1126"></a>\begin{aligned}     </span>
<span id="cb1-1127"><a href="#cb1-1127"></a>p_{Y(t)}(y_{t} \mid \boldsymbol{\Theta}) =&amp; \frac{\alpha^{\alpha t y_{t}^{\alpha t -1}}}{\Gamma(\alpha t) \sqrt{2\pi}\sigma} \int_{0}^{+\infty} \eta^{-\alpha t -1} e^{-\frac{\alpha y_{t}}{\eta}-\frac{(\ln(\eta) -\mu)^2}{2\sigma^2}} \diff\eta. </span>
<span id="cb1-1128"><a href="#cb1-1128"></a>\end{aligned} </span>
<span id="cb1-1129"><a href="#cb1-1129"></a>\end{equation*}\</span>
<span id="cb1-1130"><a href="#cb1-1130"></a>由于积分函数的复杂性和积分区域的约束, 这一积分的求解可能会导致数值不稳定的结果. 可通过重参数化或变量变换 $z = (\log(\eta)-\mu)/\sqrt{2\sigma^2}$, 从而得到 \begin{equation}\label{ungamlnorpdfx1}</span>
<span id="cb1-1131"><a href="#cb1-1131"></a>    p_{Y(t)}(y_{t} \mid \boldsymbol{\Theta}) =</span>
<span id="cb1-1132"><a href="#cb1-1132"></a>        \frac{\alpha^{\alpha t} y_{t}^{\alpha t -1}}{\Gamma(\alpha t) \sqrt{\pi}} \int_{-\infty}^{+\infty} q(z,y_{t} \mid \boldsymbol{\Theta}) e^{-z^2} \diff z,  </span>
<span id="cb1-1133"><a href="#cb1-1133"></a>\end{equation} 其中 $$</span>
<span id="cb1-1134"><a href="#cb1-1134"></a>q(z,y_{t} \mid \boldsymbol{\Theta}) = \exp\left<span class="co">[</span><span class="ot">-\alpha t(\mu + z\sqrt{2\sigma^2}) -\alpha y_{t} e^{-(\mu +z\sqrt{2\sigma^2})}\right</span><span class="co">]</span>.$$</span>
<span id="cb1-1135"><a href="#cb1-1135"></a></span>
<span id="cb1-1136"><a href="#cb1-1136"></a><span class="fu">#### 观测 Fisher 信息矩阵 {.unnumbered}</span></span>
<span id="cb1-1137"><a href="#cb1-1137"></a></span>
<span id="cb1-1138"><a href="#cb1-1138"></a>基于对数似然函数\index{似然函数}, 对$\ell(\boldsymbol{\Theta})$关于 $\boldsymbol{\Theta}$ 中每个参数求一阶导数可得 \begin{align*}</span>
<span id="cb1-1139"><a href="#cb1-1139"></a>  \frac{\partial \ell(\boldsymbol{\Theta})}{\partial \alpha} =&amp; - NM h_{c}(\psi(\alpha h_{c})+\log(\alpha)+1) + \sum_{n=1}^{N}\sum_{m=1}^{M} h_{c}\log(x_{n,m}) + \sum_{n=1}^{N}A_{n}(\alpha),\nonumber<span class="sc">\\</span></span>
<span id="cb1-1140"><a href="#cb1-1140"></a>  \frac{\partial \ell(\boldsymbol{\Theta})}{\partial \theta_{d}}=&amp; \sum_{n=1}^{N}A_{n}(\theta_{d}), </span>
<span id="cb1-1141"><a href="#cb1-1141"></a>\end{align*} 其中 $$</span>
<span id="cb1-1142"><a href="#cb1-1142"></a>A_{n}(s) = \frac{\int_{-\infty}^{\infty} \frac{\partial q(z,y_{n,M},\boldsymbol{\Theta})}{\partial s}\exp(-z^2)\diff z}{\int_{-\infty}^{\infty} q(z,y_{n,M},\boldsymbol{\Theta})\exp(-z^2)\diff z},</span>
<span id="cb1-1143"><a href="#cb1-1143"></a>\theta_{d}\in<span class="sc">\{</span>\mu,\sigma^2<span class="sc">\}</span>.</span>
<span id="cb1-1144"><a href="#cb1-1144"></a>$$ $q(z,y_{n,M},\boldsymbol{\Theta})$ 中每个元素的一阶导数为 \begin{align*}</span>
<span id="cb1-1145"><a href="#cb1-1145"></a>    \frac{\partial q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \alpha} &amp;= q(z,y_{n,M},\boldsymbol{\Theta})\cdot \log\left(q(z,y_{n,M},\boldsymbol{\Theta})\right)\cdot \alpha^{-1},\nonumber<span class="sc">\\</span></span>
<span id="cb1-1146"><a href="#cb1-1146"></a>    \frac{\partial q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \mu} &amp;= q(z,y_{n,M},\boldsymbol{\Theta})\cdot\left( -\log\left(q(z,y_{n,M},\boldsymbol{\Theta})\right) -\alpha M h_{c}\left(\sqrt{2\sigma^2}z+\mu+1\right)\right) ,\nonumber<span class="sc">\\</span></span>
<span id="cb1-1147"><a href="#cb1-1147"></a>    \frac{\partial q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \sigma^2} &amp;= \frac{\partial q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \mu}\cdot \frac{z}{\sqrt{2\sigma^2}} .\nonumber<span class="sc">\\</span></span>
<span id="cb1-1148"><a href="#cb1-1148"></a>\end{align*} 接下来, 对$\ell(\boldsymbol{\Theta})$关于 $\boldsymbol{\Theta}$求二阶偏导数可得 \begin{align*}</span>
<span id="cb1-1149"><a href="#cb1-1149"></a>  \frac{\partial \ell(\boldsymbol{\Theta})}{\partial \alpha^2} &amp; = - NM h_{c}(h_{c}\psi'(\alpha h_{c})+1/\alpha)%<span class="sc">\\</span></span>
<span id="cb1-1150"><a href="#cb1-1150"></a>  +\sum_{n=1}^{N} \left<span class="co">[</span><span class="ot">B_{n}(\alpha,\alpha) + A_{n}(\alpha)^2\right</span><span class="co">]</span>, \nonumber<span class="sc">\\</span></span>
<span id="cb1-1151"><a href="#cb1-1151"></a>  \frac{\partial \ell(\boldsymbol{\Theta})}{\partial \theta_{d}\partial \theta_{s}}&amp;=\sum_{n=1}^{N} \left<span class="co">[</span><span class="ot">B_{n}(\theta_{d},\theta_{s}) - A_{n}(\theta_{d})A_{n}(\theta_{s})\right</span><span class="co">]</span>,</span>
<span id="cb1-1152"><a href="#cb1-1152"></a>\end{align*} 其中 $$B_{n}(s_{1},s_{2})=\frac{\int_{-\infty}^{\infty} \frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial s_{1} \partial s_{2}}\exp(-z^2)\diff z}{\int_{-\infty}^{\infty} q(z,y_{n,M},\boldsymbol{\Theta})\exp(-z^2)\diff z},</span>
<span id="cb1-1153"><a href="#cb1-1153"></a>\theta_{d},\theta_{s}\in\boldsymbol{\Theta},</span>
<span id="cb1-1154"><a href="#cb1-1154"></a>(\theta_{d},\theta_{s})\neq (\alpha, \alpha).</span>
<span id="cb1-1155"><a href="#cb1-1155"></a>$$ $q(z,y_{n,M},\boldsymbol{\Theta})$ 对 $\boldsymbol{\Theta}$ 中每个元素的二阶导数为 \begin{align*}</span>
<span id="cb1-1156"><a href="#cb1-1156"></a>    \frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \alpha^2} &amp;= \frac{\partial q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \alpha}\cdot \log\left(q(z,y_{n,M},\boldsymbol{\Theta})\right)\cdot \alpha^{-1},\nonumber<span class="sc">\\</span></span>
<span id="cb1-1157"><a href="#cb1-1157"></a>  \frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \alpha \partial \mu} &amp;= \frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \mu \partial \alpha} = \left(\log\left(q(z,y_{n,M},\boldsymbol{\Theta})\right)+  1  \right)\times\frac{\partial q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \mu} \cdot\alpha^{-1},\nonumber <span class="sc">\\</span></span>
<span id="cb1-1158"><a href="#cb1-1158"></a>  \frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \alpha \partial \sigma^2} &amp; = \frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \sigma^2\partial \alpha }</span>
<span id="cb1-1159"><a href="#cb1-1159"></a>  =\frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \alpha \partial \mu}\cdot \frac{z}{\sqrt{2\sigma^2}},<span class="sc">\\</span></span>
<span id="cb1-1160"><a href="#cb1-1160"></a>  \frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \mu^2} &amp;= \frac{\partial q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \mu}\left(-\log\left(q(z,y_{n,M},\boldsymbol{\Theta})\right) -\alpha M h_{c} \left(\sqrt{2\sigma^2}z+\mu+1\right)-1\right)<span class="sc">\\</span></span>
<span id="cb1-1161"><a href="#cb1-1161"></a>  &amp;-q(z,y_{n,M},\boldsymbol{\Theta})\cdot \alpha M h_{c},\nonumber<span class="sc">\\</span></span>
<span id="cb1-1162"><a href="#cb1-1162"></a>  \frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \mu \partial \sigma^2} &amp; = \frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \sigma^2 \partial \mu} %<span class="sc">\\</span></span>
<span id="cb1-1163"><a href="#cb1-1163"></a>  = \frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \mu^2} \cdot \frac{z}{\sqrt{2\sigma^2}},\nonumber<span class="sc">\\</span></span>
<span id="cb1-1164"><a href="#cb1-1164"></a>  \frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial (\sigma^2)^2}  &amp;=</span>
<span id="cb1-1165"><a href="#cb1-1165"></a>  \left(\frac{\partial^2 q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \mu \partial \sigma^2} -\frac{\partial q(z,y_{n,M},\boldsymbol{\Theta})}{\partial \mu} \cdot \frac{1}{2\sigma^2}\right)\times \frac{z}{\sqrt{2\sigma^2}}.</span>
<span id="cb1-1166"><a href="#cb1-1166"></a>\end{align*} 上述推导过程表明, 对式 \eqref{ci2} 进行数值计算并不困难. 首先, 式 \eqref{ci2} 中涉及的所有积分项都具有GH求积的结构. 其次, \eqref{ci2} 中的二阶偏导数项可以通过 \eqref{ci4} 转化为简单的算术运算, 这些也可以通过GH求积计算. 计算式 \eqref{ci2} 仅涉及一个低维的3x3矩阵的求逆运算, 这可以通过多种成熟的集成算法完成, 例如R软件中的*solve()*函数. 在实际操作中, 由于计算精度溢出可能导致矩阵求逆的误差, 这种情况可以通过将参数间的协方差设定为较小值来处理.</span>
<span id="cb1-1167"><a href="#cb1-1167"></a></span>
<span id="cb1-1168"><a href="#cb1-1168"></a><span class="fu">#### 基准估计方法 {.unnumbered}</span></span>
<span id="cb1-1169"><a href="#cb1-1169"></a></span>
<span id="cb1-1170"><a href="#cb1-1170"></a>EM算法\index{EM算法}通常用于对不可解析的似然函数\index{似然函数}求MLE, 特别是对于具有缺失数据的模型 <span class="co">[</span><span class="ot">@mclachlan2007algorithm</span><span class="co">]</span>. 对于所提伽马退化模型, 设隐变量 $\boldsymbol{\eta}$ 为缺失数据, 然后可以使用EM算法\index{EM算法}来获得 $\boldsymbol{\Theta}$ 的MLE, 其流程如下:</span>
<span id="cb1-1171"><a href="#cb1-1171"></a></span>
<span id="cb1-1172"><a href="#cb1-1172"></a><span class="ss">1.  </span>**E步**: 给定第 $s$ 次迭代后的估计值 $\boldsymbol{\Theta}^{(s)}$, 计算后续M步所需的 $\eta_{n}$ 的矩为 \begin{equation}</span>
<span id="cb1-1173"><a href="#cb1-1173"></a>      \begin{aligned}</span>
<span id="cb1-1174"><a href="#cb1-1174"></a>    E_{1n}^{(s)}&amp;=E_{q_{1}(\eta_{n})}[\ln(\eta_{n})]|_{\boldsymbol{\Theta}=\boldsymbol{\Theta^{(s)}}},\nonumber<span class="sc">\\</span></span>
<span id="cb1-1175"><a href="#cb1-1175"></a>    E_{2n}^{(s)}&amp;=E_{q_{1}(\eta_{n})}[1/(\eta_{n})]|_{\boldsymbol{\Theta}=\boldsymbol{\Theta^{(s)}}},\\ E_{3n}^{(s)}&amp;=E_{q_{1}(\eta_{n})}[(\ln(\eta_{n}))^2]|_{\boldsymbol{\Theta}=\boldsymbol{\Theta^{(s)}}},\nonumber</span>
<span id="cb1-1176"><a href="#cb1-1176"></a>      \end{aligned}\label{em1}</span>
<span id="cb1-1177"><a href="#cb1-1177"></a>    \end{equation} 其中 \begin{equation}</span>
<span id="cb1-1178"><a href="#cb1-1178"></a>      \begin{aligned}</span>
<span id="cb1-1179"><a href="#cb1-1179"></a>    q_{1}(\eta_{n}) \propto&amp; \eta_{n}^{\mu^{(s)}/(\sigma^2)^{(s)}-\alpha^{(s)}Mh_{c}-1} e^{-\frac{\alpha^{(s)}y_{n,M}}{\eta_{n}}-\frac{(\ln(\eta_{n}))^2}{2(\sigma^2)^{(s)}}}.</span>
<span id="cb1-1180"><a href="#cb1-1180"></a>      \end{aligned}\label{em2}</span>
<span id="cb1-1181"><a href="#cb1-1181"></a>    \end{equation} 注意, 式 \eqref{em2} 也可以转换为GH求积, 并用于在E步中计算 $E_{dn}^{(s)}, d=1,2,3$.</span>
<span id="cb1-1182"><a href="#cb1-1182"></a></span>
<span id="cb1-1183"><a href="#cb1-1183"></a><span class="ss">2.  </span>**M步**: 使用 $E_{dn}^{(s)}, d=1,2,3$ 更新参数 $\boldsymbol{\Theta}$ 为 \begin{equation}</span>
<span id="cb1-1184"><a href="#cb1-1184"></a>      \begin{aligned}</span>
<span id="cb1-1185"><a href="#cb1-1185"></a>    \alpha^{(s+1)} &amp;= \mathop{\textrm{arg min}}\limits_{\alpha \in \Omega_{\alpha}}\left\{\left\vert NM\left[h_{c}(\ln(\alpha)+1)-\psi(\alpha h_{c}) \right.\right.\right.\nonumber<span class="sc">\\</span></span>
<span id="cb1-1186"><a href="#cb1-1186"></a>    &amp;\ \ \ \ +\left.\left.\left.h_{c}\left(w_{5}-M\sum_{n=1}^{N}E_{1n}\right)-w_{6}\sum_{n=1}^{N}E_{2n}\right]\right\vert \right<span class="sc">\}</span>,\nonumber<span class="sc">\\</span></span>
<span id="cb1-1187"><a href="#cb1-1187"></a>    \mu^{(s+1)} &amp;= \frac{1}{N}\sum_{n=1}^{N} E_{1n}^{(s)},<span class="sc">\\</span></span>
<span id="cb1-1188"><a href="#cb1-1188"></a>    (\sigma^2)^{(s+1)}&amp;=\frac{1}{N}\sum_{n=1}^{N}\left[E_{3n}-(\mu^{(s+1)})^2\right].\nonumber</span>
<span id="cb1-1189"><a href="#cb1-1189"></a>      \end{aligned}\label{em3}</span>
<span id="cb1-1190"><a href="#cb1-1190"></a>    \end{equation} EM算法\index{EM算法}的实现从参数的初始值 $\boldsymbol{\Theta^{(0)}}$ 开始, 然后在 \eqref{em1}和\eqref{em3}之间迭代, 直到满足给定的收敛条件.</span>
<span id="cb1-1191"><a href="#cb1-1191"></a></span>
<span id="cb1-1192"><a href="#cb1-1192"></a>贝叶斯\index{贝叶斯}方法通过结合数据与先验\index{先验}信息, 推断目标参数的后验分布. 然而, 在贝叶斯\index{贝叶斯}分析中, 直接获得每个边际后验的解析形式通常较为困难. 为此, 可采用MCMC\index{MCMC}方法, 特别是Gibbs抽样\index{Gibbs抽样}算法, 从参数的满条件后验分布中生成样本, 逐步迭代直到马尔可夫链达到平稳时终止. 对于当前的RGa退化模型, 基于MCMC\index{MCMC}的框架如下:</span>
<span id="cb1-1193"><a href="#cb1-1193"></a></span>
<span id="cb1-1194"><a href="#cb1-1194"></a><span class="ss">1.  </span>在当前后验样本 $\boldsymbol{\Theta}^{(s)}$ 下, 从 $\eta_{n}$ 的满条件后验中生成 $\eta_{n}^{(s+1)}$, 即 \begin{equation}\label{gib1}</span>
<span id="cb1-1195"><a href="#cb1-1195"></a>      p_{2}(\eta_{n} \mid \boldsymbol{\Theta^{(s)}}) = \prod_{m=1}^{M} p_{x \mid \eta}(x_{n,m} \mid \alpha^{(s)}).</span>
<span id="cb1-1196"><a href="#cb1-1196"></a>    \end{equation}</span>
<span id="cb1-1197"><a href="#cb1-1197"></a></span>
<span id="cb1-1198"><a href="#cb1-1198"></a><span class="ss">2.  </span>在当前后验样本 $\boldsymbol{\eta}^{(s+1)}$ 下, 从 $\alpha$ 的满条件后验中生成 $\boldsymbol{\Theta}^{(s+1)}$, 即 \begin{equation}\label{gib2}</span>
<span id="cb1-1199"><a href="#cb1-1199"></a>      p_{2}(\alpha \mid \boldsymbol{\eta}^{(s+1)}) = \prod_{n=1}^{N}\prod_{m=1}^{M} p_{x \mid \eta}(x_{n,m} \mid \eta_{n}^{(s+1)},\alpha) p(\alpha),</span>
<span id="cb1-1200"><a href="#cb1-1200"></a>    \end{equation} 以及 从$(\mu, \sigma^2)$ 的满条件后验中采样: \begin{equation}\label{gib3}</span>
<span id="cb1-1201"><a href="#cb1-1201"></a>      p_{2}(\mu,\sigma^2 \mid \boldsymbol{\eta}^{(s+1)}) = \prod_{n=1}^{N} p_{\eta}(\eta_{n}^{(s+1)} \mid \mu,\sigma^2) p(\mu,\sigma^2),</span>
<span id="cb1-1202"><a href="#cb1-1202"></a>    \end{equation} 其中 $p(\alpha)$ 和 $p(\mu,\sigma^2)$ 是 $\alpha$ 和 $(\mu,\sigma^2)$的先验\index{先验}, 与VB算法中的设置相同. 贝叶斯\index{贝叶斯}方法的实现从设置初始值 $\boldsymbol{\Theta}^{(0)}$ 和 $\boldsymbol{\eta}^{(0)}$ 开始, 并基于式 \eqref{gib1}-\eqref{gib3} 迭代生成后验样本, 直到所有链达到稳定且充分混合.</span>
</code><button title="复制到剪贴板" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>